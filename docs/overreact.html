<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 12.3.0"/>
    <title>overreact API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>
<a href="/overreact">            <img src="https://raw.githubusercontent.com/geem-lab/overreact-guide/master/logo.png" class="logo" alt="project logo"/>
</a>

        <h2>Contents</h2>
        <ul>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#citing-overreact">Citing <strong>overreact</strong></a></li>
  <li><a href="#license">License</a></li>
  <li><a href="#funding">Funding</a></li>
</ul>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Scheme">Scheme</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Scheme.__init__">Scheme</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scheme.compounds">compounds</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scheme.reactions">reactions</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scheme.is_half_equilibrium">is_half_equilibrium</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scheme.A">A</a>
                        </li>
                        <li>
                                <a class="variable" href="#Scheme.B">B</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#change_reference_state">change_reference_state</a>
            </li>
            <li>
                    <a class="function" href="#get_bias">get_bias</a>
            </li>
            <li>
                    <a class="function" href="#get_delta">get_delta</a>
            </li>
            <li>
                    <a class="function" href="#get_dydt">get_dydt</a>
            </li>
            <li>
                    <a class="function" href="#get_enthalpies">get_enthalpies</a>
            </li>
            <li>
                    <a class="function" href="#get_entropies">get_entropies</a>
            </li>
            <li>
                    <a class="function" href="#get_fixed_scheme">get_fixed_scheme</a>
            </li>
            <li>
                    <a class="function" href="#get_freeenergies">get_freeenergies</a>
            </li>
            <li>
                    <a class="function" href="#get_internal_energies">get_internal_energies</a>
            </li>
            <li>
                    <a class="function" href="#get_k">get_k</a>
            </li>
            <li>
                    <a class="function" href="#get_kappa">get_kappa</a>
            </li>
            <li>
                    <a class="function" href="#get_reaction_entropies">get_reaction_entropies</a>
            </li>
            <li>
                    <a class="function" href="#get_transition_states">get_transition_states</a>
            </li>
            <li>
                    <a class="function" href="#get_y">get_y</a>
            </li>
            <li>
                    <a class="function" href="#is_transition_state">is_transition_state</a>
            </li>
            <li>
                    <a class="function" href="#parse_compounds">parse_compounds</a>
            </li>
            <li>
                    <a class="function" href="#parse_model">parse_model</a>
            </li>
            <li>
                    <a class="function" href="#parse_reactions">parse_reactions</a>
            </li>
            <li>
                    <a class="function" href="#unparse_reactions">unparse_reactions</a>
            </li>
    </ul>


            <footer>overreact</footer>

        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                        <a class="pdoc-button git-button" href="https://github.com/geem-lab/overreact/blob/main/overreact/__init__.py">Edit on GitHub</a>
                    <h1 class="modulename">
overreact    </h1>

                        <div class="docstring"><hr />

<div align="center">
<p>
<a href="https://pypi.org/project/overreact/" >
<img src="https://img.shields.io/pypi/v/overreact" alt="PyPI" />
</a>
<a href="https://pypi.org/project/overreact/" >
<img src="https://img.shields.io/pypi/pyversions/overreact" alt="Python Versions" />
</a>
<a href="https://github.com/geem-lab/overreact/actions/workflows/python-package.yml" />
<img src="https://github.com/geem-lab/overreact/actions/workflows/python-package.yml/badge.svg" alt="CI" />
</a>
<a href="https://codecov.io/gh/geem-lab/overreact" >
<img src="https://codecov.io/gh/geem-lab/overreact/branch/main/graph/badge.svg?token=4WAVXCRXY8" alt="Coverage" />
</a>
<a href="https://github.com/geem-lab/overreact/blob/main/LICENSE">
<img src="https://img.shields.io/github/license/geem-lab/overreact" alt="License" />
</a>
</p>
<p>
<a href="https://geem-lab.github.io/overreact-guide/">
<img src="https://img.shields.io/badge/user%20guide-available-blue" alt="User guide" />
</a>
<a href="https://github.com/geem-lab/overreact/discussions">
<img src="https://img.shields.io/github/discussions/geem-lab/overreact" alt="GitHub Discussions" />
</a>
<a href="https://github.com/geem-lab/overreact/issues">
<img src="https://img.shields.io/github/issues-raw/geem-lab/overreact" alt="GitHub issues" />
</a>
</p>
<p>
<a href="https://pepy.tech/project/overreact" >
<img src="https://pepy.tech/badge/overreact/month" alt="downloads/month" />
</a>
<a href="https://pepy.tech/project/overreact" >
<img src="https://pepy.tech/badge/overreact" alt="total downloads" />
</a>
</p>
<p>
<a href="https://doi.org/10.1002/jcc.26861" >
<img src="https://img.shields.io/badge/DOI-10.1002%2Fjcc.26861-blue" alt="DOI" />
</a>
<a href="https://doi.org/10.5281/zenodo.5730603">
<img src="https://zenodo.org/badge/DOI/10.5281/zenodo.5730603.svg" alt="DOI" />
</a>
</p>
<p>
<a href="https://github.com/geem-lab/overreact#funding" >
<img src="https://img.shields.io/badge/made%20in-Brazil-009c3b" alt="Made in Brazil üáßüá∑" />
</a>
</p>
</div>

<div align="center">
<img alt="overreact" src="https://raw.githubusercontent.com/geem-lab/overreact-guide/master/logo.png" />
</div>

<hr />

<p><strong>overreact</strong> is a <strong>library</strong> and a <strong>command-line tool</strong> for building and
analyzing homogeneous <strong>microkinetic models</strong> from <strong>first-principles
calculations</strong>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">overreact</span> <span class="kn">import</span> <span class="n">api</span>  <span class="c1"># the api</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">api</span><span class="o">.</span><span class="n">get_k</span><span class="p">(</span><span class="s2">&quot;S -&gt; E‚Ä° -&gt; S&quot;</span><span class="p">,</span>  <span class="c1"># your model</span>
   <span class="o">...</span><span class="p">:</span>           <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;data/ethane/B97-3c/staggered.out&quot;</span><span class="p">,</span>  <span class="c1"># your data</span>
   <span class="o">...</span><span class="p">:</span>            <span class="s2">&quot;E‚Ä°&quot;</span><span class="p">:</span> <span class="s2">&quot;data/ethane/B97-3c/eclipsed.out&quot;</span><span class="p">})</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mf">8.16880917e+10</span><span class="p">])</span>  <span class="c1"># your results</span>
</code></pre>
</div>

<p>The user specifies a set of
elementary reactions that are believed to be relevant for the overall chemical
phenomena. <strong>overreact</strong> offers a hopefully complete but simple environment for
hypothesis testing in first-principles chemical kinetics.</p>

<p><details>
    <summary style="cursor: pointer;">
        ü§î What is <strong>microkinetic modeling</strong>?
    </summary>
    <p>
        <strong>Microkinetic modeling</strong> is a technique used to predict the outcome
        of complex chemical reactions.
        It can be used
        to investigate the catalytic transformations
        of molecules.
        <strong>overreact</strong> makes it easy to create
        and analyze microkinetic models built
        from computational chemistry data.
    </p>
</details></p>

<p><br/></p>

<p><details>
    <summary style="cursor: pointer;">
        üßê What do you mean by <strong>first-principles calculations</strong>?
    </summary>
    <p>
        We use the term <strong>first-principles calculations</strong> to refer to
        calculations performed using quantum chemical modern methods such as
        <a href="https://en.wikipedia.org/wiki/Hartree%E2%80%93Fock_method">Wavefunction</a>
        and
        <a href="https://en.wikipedia.org/wiki/Density_functional_theory">Density Functional</a>
        theories.
        For instance, the three-line example code above calculates the rate of methyl rotation in ethane (at
        <a href="https://doi.org/10.1063/1.5012601">B97-3c</a>).
        (Rather surprisingly, the error found is less than 2%
        <a href="http://dx.doi.org/10.1126/science.1132178">when compared to available experimental results</a>.)
    </p>
</details></p>

<p><br/></p>

<p><strong>overreact</strong> uses <strong>precise thermochemical partition funtions</strong>, <strong>tunneling
corrections</strong> and data is <strong>parsed directly</strong> from computational chemistry
output files thanks to <a href="https://cclib.github.io/"><code>cclib</code></a> (see the
<a href="https://cclib.github.io/#summary">list of its supported programs</a>).</p>

<h2 id="installation">Installation</h2>

<p><strong>overreact</strong> is a Python package, so you can easily install it with
<a href="https://pypi.org/project/pip/"><code>pip</code></a>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;overreact[cli,fast]&quot;</span>
</code></pre>
</div>

<p>See the
<a href="https://geem-lab.github.io/overreact-guide/install.html">installation guide</a>
for more details.</p>

<blockquote>
  <p><strong>üöÄ</strong> <strong>Where to go from here?</strong> Take a look at the
  <a href="https://geem-lab.github.io/overreact-guide/tutorial.html">short introduction</a>.
  Or see
  <a href="https://geem-lab.github.io/overreact-guide/intro.html#where-to-go-next">below</a>
  for more guidance.</p>
</blockquote>

<h2 id="citing-overreact">Citing <strong>overreact</strong></h2>

<p>If you use <strong>overreact</strong> in your research, please cite:</p>

<blockquote>
  <p>Schneider, F. S. S.; Caramori, G. F.
  _<strong>Overreact</strong>, an in Silico Lab: Automative Quantum Chemical Microkinetic Simulations for Complex Chemical Reactions_.
  Journal of Computational Chemistry <strong>2022</strong>, 44 (3), 209‚Äì217.
  <a href="https://doi.org/10.1002/jcc.26861">doi:10.1002/jcc.26861</a>.</p>
</blockquote>

<p>Here's the reference in <a href="http://www.bibtex.org/">BibTeX</a> format:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="nc">@article</span><span class="p">{</span><span class="nl">overreact_2022</span><span class="p">,</span>
<span class="w">  </span><span class="na">title</span><span class="p">=</span><span class="s">{Overreact, an in silico lab: Automative quantum chemical microkinetic simulations for complex chemical reactions}</span><span class="p">,</span>
<span class="w">  </span><span class="na">ISSN</span><span class="p">=</span><span class="s">{1096-987X}</span><span class="p">,</span>
<span class="w">  </span><span class="na">url</span><span class="p">=</span><span class="s">{http://dx.doi.org/10.1002/jcc.26861}</span><span class="p">,</span>
<span class="w">  </span><span class="na">DOI</span><span class="p">=</span><span class="s">{10.1002/jcc.26861}</span><span class="p">,</span>
<span class="w">  </span><span class="na">journal</span><span class="p">=</span><span class="s">{Journal of Computational Chemistry}</span><span class="p">,</span>
<span class="w">  </span><span class="na">publisher</span><span class="p">=</span><span class="s">{Wiley}</span><span class="p">,</span>
<span class="w">  </span><span class="na">author</span><span class="p">=</span><span class="s">{Schneider, Felipe S. S. and Caramori, Giovanni F.}</span><span class="p">,</span>
<span class="w">  </span><span class="na">year</span><span class="p">=</span><span class="s">{2022}</span><span class="p">,</span>
<span class="w">  </span><span class="na">month</span><span class="p">=</span><span class="s">{Apr}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="license">License</h2>

<p><strong>overreact</strong> is open-source, released under the permissive <strong>MIT license</strong>. See
<a href="https://github.com/geem-lab/overreact/blob/main/LICENSE">the LICENSE agreement</a>.</p>

<h2 id="funding">Funding</h2>

<p>This project was developed at the <a href="https://geem-ufsc.org/">GEEM lab</a>
(<a href="https://en.ufsc.br/">Federal University of Santa Catarina</a>, Brazil), and was
partially funded by the
<a href="https://cnpq.br/">Brazilian National Council for Scientific and Technological Development (CNPq)</a>,
grant number 140485/2017-1.</p>
</div>

                        <input id="mod-overreact-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-overreact-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a><span class="sd">.. include:: ../README.md</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a><span class="sd">&quot;&quot;&quot;</span>  <span class="c1"># noqa: D200, D400</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a><span class="n">__docformat__</span> <span class="o">=</span> <span class="s2">&quot;restructuredtext&quot;</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a><span class="kn">import</span> <span class="nn">pkg_resources</span> <span class="k">as</span> <span class="nn">_pkg_resources</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a><span class="kn">from</span> <span class="nn">overreact.api</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="n">get_enthalpies</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="n">get_entropies</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="n">get_freeenergies</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a>    <span class="n">get_internal_energies</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">15</span></a>    <span class="n">get_k</span><span class="p">,</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">16</span></a>    <span class="n">get_kappa</span><span class="p">,</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">17</span></a><span class="p">)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">18</span></a><span class="kn">from</span> <span class="nn">overreact.core</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">19</span></a>    <span class="n">Scheme</span><span class="p">,</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">20</span></a>    <span class="n">get_transition_states</span><span class="p">,</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">21</span></a>    <span class="n">is_transition_state</span><span class="p">,</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">22</span></a>    <span class="n">parse_reactions</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">23</span></a>    <span class="n">unparse_reactions</span><span class="p">,</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">24</span></a><span class="p">)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">25</span></a><span class="kn">from</span> <span class="nn">overreact.io</span> <span class="kn">import</span> <span class="n">parse_compounds</span><span class="p">,</span> <span class="n">parse_model</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">26</span></a><span class="kn">from</span> <span class="nn">overreact.simulate</span> <span class="kn">import</span> <span class="n">get_bias</span><span class="p">,</span> <span class="n">get_dydt</span><span class="p">,</span> <span class="n">get_fixed_scheme</span><span class="p">,</span> <span class="n">get_y</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">27</span></a><span class="kn">from</span> <span class="nn">overreact.thermo</span> <span class="kn">import</span> <span class="n">change_reference_state</span><span class="p">,</span> <span class="n">get_delta</span><span class="p">,</span> <span class="n">get_reaction_entropies</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">29</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">30</span></a>    <span class="s2">&quot;Scheme&quot;</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">31</span></a>    <span class="s2">&quot;change_reference_state&quot;</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">32</span></a>    <span class="s2">&quot;get_bias&quot;</span><span class="p">,</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">33</span></a>    <span class="s2">&quot;get_delta&quot;</span><span class="p">,</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">34</span></a>    <span class="s2">&quot;get_dydt&quot;</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">35</span></a>    <span class="s2">&quot;get_enthalpies&quot;</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">36</span></a>    <span class="s2">&quot;get_entropies&quot;</span><span class="p">,</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">37</span></a>    <span class="s2">&quot;get_fixed_scheme&quot;</span><span class="p">,</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">38</span></a>    <span class="s2">&quot;get_freeenergies&quot;</span><span class="p">,</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">39</span></a>    <span class="s2">&quot;get_internal_energies&quot;</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">40</span></a>    <span class="s2">&quot;get_k&quot;</span><span class="p">,</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">41</span></a>    <span class="s2">&quot;get_kappa&quot;</span><span class="p">,</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">42</span></a>    <span class="s2">&quot;get_reaction_entropies&quot;</span><span class="p">,</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">43</span></a>    <span class="s2">&quot;get_transition_states&quot;</span><span class="p">,</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">44</span></a>    <span class="s2">&quot;get_y&quot;</span><span class="p">,</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">45</span></a>    <span class="s2">&quot;is_transition_state&quot;</span><span class="p">,</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">46</span></a>    <span class="s2">&quot;parse_compounds&quot;</span><span class="p">,</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">47</span></a>    <span class="s2">&quot;parse_model&quot;</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">48</span></a>    <span class="s2">&quot;parse_reactions&quot;</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">49</span></a>    <span class="s2">&quot;unparse_reactions&quot;</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">50</span></a><span class="p">]</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">52</span></a><span class="n">__version__</span> <span class="o">=</span> <span class="n">_pkg_resources</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span><span class="o">.</span><span class="n">version</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">53</span></a><span class="n">__license__</span> <span class="o">=</span> <span class="s2">&quot;MIT&quot;</span>  <span class="c1"># I&#39;m too lazy to get it from setup.py...</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos">55</span></a><span class="n">__headline__</span> <span class="o">=</span> <span class="s2">&quot;üìà Create and analyze chemical microkinetic models built from computational chemistry data.&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">57</span></a><span class="n">__url_repo__</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/geem-lab/overreact&quot;</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">58</span></a><span class="n">__url_issues__</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">__url_repo__</span><span class="si">}</span><span class="s2">/issues&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">59</span></a><span class="n">__url_discussions__</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">__url_repo__</span><span class="si">}</span><span class="s2">/discussions&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">60</span></a><span class="n">__url_pypi__</span> <span class="o">=</span> <span class="s2">&quot;https://pypi.org/project/overreact/&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">61</span></a><span class="n">__url_guide__</span> <span class="o">=</span> <span class="s2">&quot;https://geem-lab.github.io/overreact-guide/&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">63</span></a><span class="n">__doi__</span> <span class="o">=</span> <span class="s2">&quot;10.1002/jcc.26861&quot;</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">64</span></a><span class="n">__zenodo_doi__</span> <span class="o">=</span> <span class="s2">&quot;10.5281/zenodo.5730603&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">65</span></a><span class="n">__citations__</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">66</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">67</span></a><span class="sd">@article{overreact_paper2022,</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">68</span></a><span class="sd">  title        = {Overreact, an in silico lab: Automative quantum chemical microkinetic simulations for complex chemical reactions},</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">69</span></a><span class="sd">  url          = {http://dx.doi.org/DOI_PLACEHOLDER},</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">70</span></a><span class="sd">  author       = {Schneider, Felipe S. S. and Caramori, Giovanni F.},</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">71</span></a><span class="sd">  DOI          = {DOI_PLACEHOLDER},</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">72</span></a><span class="sd">  ISSN         = {1096-987X},</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">73</span></a><span class="sd">  journal      = {Journal of Computational Chemistry},</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">74</span></a><span class="sd">  publisher    = {Wiley},</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">75</span></a><span class="sd">  year         = {2022},</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">76</span></a><span class="sd">  month        = {Apr}</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">77</span></a><span class="sd">}</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">78</span></a><span class="sd">@software{overreact_software2021,</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">79</span></a><span class="sd">  title        = {geem-lab/overreact: vVERSION_PLACEHOLDER | Zenodo},</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">80</span></a><span class="sd">  version      = {vVERSION_PLACEHOLDER},</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">81</span></a><span class="sd">  howpublished = {\url{URL_REPO_PLACEHOLDER}},</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">82</span></a><span class="sd">  url          = {https://doi.org/ZENODO_DOI_PLACEHOLDER},</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">83</span></a><span class="sd">  author       = {Schneider, Felipe S. S. and Caramori, Giovanni F.},</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">84</span></a><span class="sd">  DOI          = {ZENODO_DOI_PLACEHOLDER},</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">85</span></a><span class="sd">  publisher    = {Zenodo},</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">86</span></a><span class="sd">  year         = {2021},</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">87</span></a><span class="sd">  month        = {Nov}</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">88</span></a><span class="sd">}</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">89</span></a><span class="sd">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>  <span class="c1"># noqa: E501</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">90</span></a>        <span class="s2">&quot;DOI_PLACEHOLDER&quot;</span><span class="p">,</span> <span class="n">__doi__</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">91</span></a>    <span class="p">)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">92</span></a>    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ZENODO_DOI_PLACEHOLDER&quot;</span><span class="p">,</span> <span class="n">__zenodo_doi__</span><span class="p">)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">93</span></a>    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;URL_REPO_PLACEHOLDER&quot;</span><span class="p">,</span> <span class="n">__url_repo__</span><span class="p">)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">94</span></a>    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;VERSION_PLACEHOLDER&quot;</span><span class="p">,</span> <span class="n">__version__</span><span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">95</span></a><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="Scheme">
                            <input id="Scheme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Scheme</span><wbr>(<span class="base">typing.NamedTuple</span>):

                <label class="view-source-button" for="Scheme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Scheme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Scheme-19"><a href="#Scheme-19"><span class="linenos">19</span></a><span class="k">class</span> <span class="nc">Scheme</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
</span><span id="Scheme-20"><a href="#Scheme-20"><span class="linenos">20</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Scheme-21"><a href="#Scheme-21"><span class="linenos">21</span></a><span class="sd">    A descriptor of a chemical reaction network.</span>
</span><span id="Scheme-22"><a href="#Scheme-22"><span class="linenos">22</span></a>
</span><span id="Scheme-23"><a href="#Scheme-23"><span class="linenos">23</span></a><span class="sd">    Mostly likely, this comes from a parsed input file.</span>
</span><span id="Scheme-24"><a href="#Scheme-24"><span class="linenos">24</span></a><span class="sd">    See `overreact.io.parse_model`.</span>
</span><span id="Scheme-25"><a href="#Scheme-25"><span class="linenos">25</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Scheme-26"><a href="#Scheme-26"><span class="linenos">26</span></a>
</span><span id="Scheme-27"><a href="#Scheme-27"><span class="linenos">27</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Scheme-28"><a href="#Scheme-28"><span class="linenos">28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A descriptor of compounds.&quot;&quot;&quot;</span>
</span><span id="Scheme-29"><a href="#Scheme-29"><span class="linenos">29</span></a>    <span class="n">reactions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
</span><span id="Scheme-30"><a href="#Scheme-30"><span class="linenos">30</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A descriptor of reactions.&quot;&quot;&quot;</span>
</span><span id="Scheme-31"><a href="#Scheme-31"><span class="linenos">31</span></a>    <span class="n">is_half_equilibrium</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>
</span><span id="Scheme-32"><a href="#Scheme-32"><span class="linenos">32</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;An indicator of whether a reaction is half-equilibrium.&quot;&quot;&quot;</span>
</span><span id="Scheme-33"><a href="#Scheme-33"><span class="linenos">33</span></a>    <span class="n">A</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="Scheme-34"><a href="#Scheme-34"><span class="linenos">34</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A matrix of stoichiometric coefficients between reactants and products.&quot;&quot;&quot;</span>
</span><span id="Scheme-35"><a href="#Scheme-35"><span class="linenos">35</span></a>    <span class="n">B</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</span><span id="Scheme-36"><a href="#Scheme-36"><span class="linenos">36</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A matrix of stoichiometric coefficients between reactants and transition states.&quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span></pre></div>


            <div class="docstring"><p>A descriptor of a chemical reaction network.</p>

<p>Mostly likely, this comes from a parsed input file.
See <code><a href="#parse_model">overreact.parse_model</a></code>.</p>
</div>


                            <div id="Scheme.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Scheme</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">compounds</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">reactions</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">is_half_equilibrium</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span>,</span><span class="param">	<span class="n">A</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span>,</span><span class="param">	<span class="n">B</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span></span>)</span>

        
    </div>
    <a class="headerlink" href="#Scheme.__init__"></a>
    
            <div class="docstring"><p>Create new instance of Scheme(compounds, reactions, is_half_equilibrium, A, B)</p>
</div>


                            </div>
                            <div id="Scheme.compounds" class="classattr">
                                <div class="attr variable">
            <span class="name">compounds</span><span class="annotation">: Sequence[str]</span>

        
    </div>
    <a class="headerlink" href="#Scheme.compounds"></a>
    
            <div class="docstring"><p>A descriptor of compounds.</p>
</div>


                            </div>
                            <div id="Scheme.reactions" class="classattr">
                                <div class="attr variable">
            <span class="name">reactions</span><span class="annotation">: Sequence[str]</span>

        
    </div>
    <a class="headerlink" href="#Scheme.reactions"></a>
    
            <div class="docstring"><p>A descriptor of reactions.</p>
</div>


                            </div>
                            <div id="Scheme.is_half_equilibrium" class="classattr">
                                <div class="attr variable">
            <span class="name">is_half_equilibrium</span><span class="annotation">: Sequence[bool]</span>

        
    </div>
    <a class="headerlink" href="#Scheme.is_half_equilibrium"></a>
    
            <div class="docstring"><p>An indicator of whether a reaction is half-equilibrium.</p>
</div>


                            </div>
                            <div id="Scheme.A" class="classattr">
                                <div class="attr variable">
            <span class="name">A</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Scheme.A"></a>
    
            <div class="docstring"><p>A matrix of stoichiometric coefficients between reactants and products.</p>
</div>


                            </div>
                            <div id="Scheme.B" class="classattr">
                                <div class="attr variable">
            <span class="name">B</span><span class="annotation">: numpy.ndarray</span>

        
    </div>
    <a class="headerlink" href="#Scheme.B"></a>
    
            <div class="docstring"><p>A matrix of stoichiometric coefficients between reactants and transition states.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.tuple</dt>
                                <dd id="Scheme.index" class="function">index</dd>
                <dd id="Scheme.count" class="function">count</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="change_reference_state">
                            <input id="change_reference_state-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_reference_state</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">new_reference</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.0</span>,</span><span class="param">	<span class="n">old_reference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">sign</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>,</span><span class="param">	<span class="n">temperature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="mf">298.15</span>,</span><span class="param">	<span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101325.0</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="change_reference_state-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#change_reference_state"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="change_reference_state-755"><a href="#change_reference_state-755"><span class="linenos">755</span></a><span class="k">def</span> <span class="nf">change_reference_state</span><span class="p">(</span>
</span><span id="change_reference_state-756"><a href="#change_reference_state-756"><span class="linenos">756</span></a>    <span class="n">new_reference</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">liter</span><span class="p">,</span>
</span><span id="change_reference_state-757"><a href="#change_reference_state-757"><span class="linenos">757</span></a>    <span class="n">old_reference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="change_reference_state-758"><a href="#change_reference_state-758"><span class="linenos">758</span></a>    <span class="n">sign</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="change_reference_state-759"><a href="#change_reference_state-759"><span class="linenos">759</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="change_reference_state-760"><a href="#change_reference_state-760"><span class="linenos">760</span></a>    <span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">atm</span><span class="p">,</span>
</span><span id="change_reference_state-761"><a href="#change_reference_state-761"><span class="linenos">761</span></a>    <span class="n">volume</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="change_reference_state-762"><a href="#change_reference_state-762"><span class="linenos">762</span></a><span class="p">):</span>
</span><span id="change_reference_state-763"><a href="#change_reference_state-763"><span class="linenos">763</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate an additive entropy correction to a change in reference states.</span>
</span><span id="change_reference_state-764"><a href="#change_reference_state-764"><span class="linenos">764</span></a>
</span><span id="change_reference_state-765"><a href="#change_reference_state-765"><span class="linenos">765</span></a><span class="sd">    .. math::</span>
</span><span id="change_reference_state-766"><a href="#change_reference_state-766"><span class="linenos">766</span></a><span class="sd">        \Delta G_\text{corr} =</span>
</span><span id="change_reference_state-767"><a href="#change_reference_state-767"><span class="linenos">767</span></a><span class="sd">            R T \ln \left( \frac{\chi_\text{new}}{\chi_\text{old}} \right)</span>
</span><span id="change_reference_state-768"><a href="#change_reference_state-768"><span class="linenos">768</span></a>
</span><span id="change_reference_state-769"><a href="#change_reference_state-769"><span class="linenos">769</span></a><span class="sd">    The value returned can be directly multiplied by temperature and summed to</span>
</span><span id="change_reference_state-770"><a href="#change_reference_state-770"><span class="linenos">770</span></a><span class="sd">    the old reference free energies to obtain free energies with respect to a</span>
</span><span id="change_reference_state-771"><a href="#change_reference_state-771"><span class="linenos">771</span></a><span class="sd">    new reference. See notes below.</span>
</span><span id="change_reference_state-772"><a href="#change_reference_state-772"><span class="linenos">772</span></a>
</span><span id="change_reference_state-773"><a href="#change_reference_state-773"><span class="linenos">773</span></a><span class="sd">    For instance, the concentration correction to Gibbs free energy for a</span>
</span><span id="change_reference_state-774"><a href="#change_reference_state-774"><span class="linenos">774</span></a><span class="sd">    gas-to-liquid standard state change is simply</span>
</span><span id="change_reference_state-775"><a href="#change_reference_state-775"><span class="linenos">775</span></a><span class="sd">    (:math:`c^\circ = \frac{\text{1 atm}}{R T}`),</span>
</span><span id="change_reference_state-776"><a href="#change_reference_state-776"><span class="linenos">776</span></a>
</span><span id="change_reference_state-777"><a href="#change_reference_state-777"><span class="linenos">777</span></a><span class="sd">    .. math::</span>
</span><span id="change_reference_state-778"><a href="#change_reference_state-778"><span class="linenos">778</span></a><span class="sd">        \Delta G_\text{conc} =</span>
</span><span id="change_reference_state-779"><a href="#change_reference_state-779"><span class="linenos">779</span></a><span class="sd">            R T \ln \left( \frac{\text{1 M}}{c^\circ} \right)</span>
</span><span id="change_reference_state-780"><a href="#change_reference_state-780"><span class="linenos">780</span></a>
</span><span id="change_reference_state-781"><a href="#change_reference_state-781"><span class="linenos">781</span></a><span class="sd">    Parameters</span>
</span><span id="change_reference_state-782"><a href="#change_reference_state-782"><span class="linenos">782</span></a><span class="sd">    ----------</span>
</span><span id="change_reference_state-783"><a href="#change_reference_state-783"><span class="linenos">783</span></a><span class="sd">    new_reference : array-like, optional</span>
</span><span id="change_reference_state-784"><a href="#change_reference_state-784"><span class="linenos">784</span></a><span class="sd">        New reference state. Default value corresponds to 1 mol/liter.</span>
</span><span id="change_reference_state-785"><a href="#change_reference_state-785"><span class="linenos">785</span></a><span class="sd">    old_reference : array-like, optional</span>
</span><span id="change_reference_state-786"><a href="#change_reference_state-786"><span class="linenos">786</span></a><span class="sd">        Old reference state. Default value corresponds to the concentration of</span>
</span><span id="change_reference_state-787"><a href="#change_reference_state-787"><span class="linenos">787</span></a><span class="sd">        an ideal gas at the given temperature and 1 atm.</span>
</span><span id="change_reference_state-788"><a href="#change_reference_state-788"><span class="linenos">788</span></a><span class="sd">    sign : float, optional</span>
</span><span id="change_reference_state-789"><a href="#change_reference_state-789"><span class="linenos">789</span></a><span class="sd">        Sign of the change in reference state. Default value is 1. This only</span>
</span><span id="change_reference_state-790"><a href="#change_reference_state-790"><span class="linenos">790</span></a><span class="sd">        multiplies the final result.</span>
</span><span id="change_reference_state-791"><a href="#change_reference_state-791"><span class="linenos">791</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="change_reference_state-792"><a href="#change_reference_state-792"><span class="linenos">792</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="change_reference_state-793"><a href="#change_reference_state-793"><span class="linenos">793</span></a><span class="sd">    pressure : array-like, optional</span>
</span><span id="change_reference_state-794"><a href="#change_reference_state-794"><span class="linenos">794</span></a><span class="sd">        Reference gas pressure.</span>
</span><span id="change_reference_state-795"><a href="#change_reference_state-795"><span class="linenos">795</span></a><span class="sd">    volume : float, optional</span>
</span><span id="change_reference_state-796"><a href="#change_reference_state-796"><span class="linenos">796</span></a><span class="sd">        Molar volume.</span>
</span><span id="change_reference_state-797"><a href="#change_reference_state-797"><span class="linenos">797</span></a>
</span><span id="change_reference_state-798"><a href="#change_reference_state-798"><span class="linenos">798</span></a><span class="sd">    Returns</span>
</span><span id="change_reference_state-799"><a href="#change_reference_state-799"><span class="linenos">799</span></a><span class="sd">    -------</span>
</span><span id="change_reference_state-800"><a href="#change_reference_state-800"><span class="linenos">800</span></a><span class="sd">    correction : array-like</span>
</span><span id="change_reference_state-801"><a href="#change_reference_state-801"><span class="linenos">801</span></a><span class="sd">        Entropy correction in J/mol¬∑K.</span>
</span><span id="change_reference_state-802"><a href="#change_reference_state-802"><span class="linenos">802</span></a>
</span><span id="change_reference_state-803"><a href="#change_reference_state-803"><span class="linenos">803</span></a><span class="sd">    Notes</span>
</span><span id="change_reference_state-804"><a href="#change_reference_state-804"><span class="linenos">804</span></a><span class="sd">    -----</span>
</span><span id="change_reference_state-805"><a href="#change_reference_state-805"><span class="linenos">805</span></a><span class="sd">    This function can be used to add any entropy correction in the form above.</span>
</span><span id="change_reference_state-806"><a href="#change_reference_state-806"><span class="linenos">806</span></a><span class="sd">    The only drawback is that, sometimes, those corrections are written with a</span>
</span><span id="change_reference_state-807"><a href="#change_reference_state-807"><span class="linenos">807</span></a><span class="sd">    minus sign in front of them (this implies switching the roles of</span>
</span><span id="change_reference_state-808"><a href="#change_reference_state-808"><span class="linenos">808</span></a><span class="sd">    `old_reference` and `new_reference`). The easiest way to accomplish this is</span>
</span><span id="change_reference_state-809"><a href="#change_reference_state-809"><span class="linenos">809</span></a><span class="sd">    by using ``sign=-1`` or multiplying the result by ``-1``.</span>
</span><span id="change_reference_state-810"><a href="#change_reference_state-810"><span class="linenos">810</span></a>
</span><span id="change_reference_state-811"><a href="#change_reference_state-811"><span class="linenos">811</span></a><span class="sd">    Examples</span>
</span><span id="change_reference_state-812"><a href="#change_reference_state-812"><span class="linenos">812</span></a><span class="sd">    --------</span>
</span><span id="change_reference_state-813"><a href="#change_reference_state-813"><span class="linenos">813</span></a><span class="sd">    By default, the correction returns a change in concentration from the gas</span>
</span><span id="change_reference_state-814"><a href="#change_reference_state-814"><span class="linenos">814</span></a><span class="sd">    phase standard concentration to the solvated-state standard concentration:</span>
</span><span id="change_reference_state-815"><a href="#change_reference_state-815"><span class="linenos">815</span></a>
</span><span id="change_reference_state-816"><a href="#change_reference_state-816"><span class="linenos">816</span></a><span class="sd">    &gt;&gt;&gt; -rx.change_reference_state() / constants.calorie</span>
</span><span id="change_reference_state-817"><a href="#change_reference_state-817"><span class="linenos">817</span></a><span class="sd">    -6.4</span>
</span><span id="change_reference_state-818"><a href="#change_reference_state-818"><span class="linenos">818</span></a><span class="sd">    &gt;&gt;&gt; 298.15 * rx.change_reference_state() / constants.kcal</span>
</span><span id="change_reference_state-819"><a href="#change_reference_state-819"><span class="linenos">819</span></a><span class="sd">    1.89</span>
</span><span id="change_reference_state-820"><a href="#change_reference_state-820"><span class="linenos">820</span></a><span class="sd">    &gt;&gt;&gt; 273.15 * rx.change_reference_state(temperature=273.15) / constants.kcal</span>
</span><span id="change_reference_state-821"><a href="#change_reference_state-821"><span class="linenos">821</span></a><span class="sd">    1.69</span>
</span><span id="change_reference_state-822"><a href="#change_reference_state-822"><span class="linenos">822</span></a>
</span><span id="change_reference_state-823"><a href="#change_reference_state-823"><span class="linenos">823</span></a><span class="sd">    But this function can also be used to adjust symmetry effects from C1</span>
</span><span id="change_reference_state-824"><a href="#change_reference_state-824"><span class="linenos">824</span></a><span class="sd">    calculations (symmetry number equals to one). For D7h, for instance, the</span>
</span><span id="change_reference_state-825"><a href="#change_reference_state-825"><span class="linenos">825</span></a><span class="sd">    symmetry number is 14:</span>
</span><span id="change_reference_state-826"><a href="#change_reference_state-826"><span class="linenos">826</span></a>
</span><span id="change_reference_state-827"><a href="#change_reference_state-827"><span class="linenos">827</span></a><span class="sd">    &gt;&gt;&gt; -298.15 * rx.change_reference_state(14, 1) / constants.kcal</span>
</span><span id="change_reference_state-828"><a href="#change_reference_state-828"><span class="linenos">828</span></a><span class="sd">    -1.56</span>
</span><span id="change_reference_state-829"><a href="#change_reference_state-829"><span class="linenos">829</span></a>
</span><span id="change_reference_state-830"><a href="#change_reference_state-830"><span class="linenos">830</span></a><span class="sd">    &gt;&gt;&gt; rx.change_reference_state(sign=-1) == -rx.change_reference_state()</span>
</span><span id="change_reference_state-831"><a href="#change_reference_state-831"><span class="linenos">831</span></a><span class="sd">    True</span>
</span><span id="change_reference_state-832"><a href="#change_reference_state-832"><span class="linenos">832</span></a>
</span><span id="change_reference_state-833"><a href="#change_reference_state-833"><span class="linenos">833</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="change_reference_state-834"><a href="#change_reference_state-834"><span class="linenos">834</span></a>    <span class="n">temperature</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
</span><span id="change_reference_state-835"><a href="#change_reference_state-835"><span class="linenos">835</span></a>
</span><span id="change_reference_state-836"><a href="#change_reference_state-836"><span class="linenos">836</span></a>    <span class="k">if</span> <span class="n">old_reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="change_reference_state-837"><a href="#change_reference_state-837"><span class="linenos">837</span></a>        <span class="k">if</span> <span class="n">volume</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="change_reference_state-838"><a href="#change_reference_state-838"><span class="linenos">838</span></a>            <span class="n">volume</span> <span class="o">=</span> <span class="n">molar_volume</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">)</span>
</span><span id="change_reference_state-839"><a href="#change_reference_state-839"><span class="linenos">839</span></a>        <span class="n">old_reference</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">volume</span>
</span><span id="change_reference_state-840"><a href="#change_reference_state-840"><span class="linenos">840</span></a>
</span><span id="change_reference_state-841"><a href="#change_reference_state-841"><span class="linenos">841</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">sign</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">new_reference</span> <span class="o">/</span> <span class="n">old_reference</span><span class="p">)</span>
</span><span id="change_reference_state-842"><a href="#change_reference_state-842"><span class="linenos">842</span></a>    <span class="k">return</span> <span class="n">res</span>  <span class="c1"># noqa: RET504</span>
</span></pre></div>


            <div class="docstring"><p>Calculate an additive entropy correction to a change in reference states.</p>

<p>$$\Delta G_\text{corr} =
    R T \ln \left( \frac{\chi_\text{new}}{\chi_\text{old}} \right)$$</p>

<p>The value returned can be directly multiplied by temperature and summed to
the old reference free energies to obtain free energies with respect to a
new reference. See notes below.</p>

<p>For instance, the concentration correction to Gibbs free energy for a
gas-to-liquid standard state change is simply
(\( c^\circ = \frac{\text{1 atm}}{R T} \)),</p>

<p>$$\Delta G_\text{conc} =
    R T \ln \left( \frac{\text{1 M}}{c^\circ} \right)$$</p>

<h2 id="parameters">Parameters</h2>

<p>new_reference : array-like, optional
    New reference state. Default value corresponds to 1 mol/liter.
old_reference : array-like, optional
    Old reference state. Default value corresponds to the concentration of
    an ideal gas at the given temperature and 1 atm.
sign : float, optional
    Sign of the change in reference state. Default value is 1. This only
    multiplies the final result.
temperature : array-like, optional
    Absolute temperature in Kelvin.
pressure : array-like, optional
    Reference gas pressure.
volume : float, optional
    Molar volume.</p>

<h2 id="returns">Returns</h2>

<p>correction : array-like
    Entropy correction in J/mol¬∑K.</p>

<h2 id="notes">Notes</h2>

<p>This function can be used to add any entropy correction in the form above.
The only drawback is that, sometimes, those corrections are written with a
minus sign in front of them (this implies switching the roles of
<code>old_reference</code> and <code>new_reference</code>). The easiest way to accomplish this is
by using <code>sign=-1</code> or multiplying the result by <code>-1</code>.</p>

<h2 id="examples">Examples</h2>

<p>By default, the correction returns a change in concentration from the gas
phase standard concentration to the solvated-state standard concentration:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">()</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">calorie</span>
<span class="go">-6.4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">298.15</span> <span class="o">*</span> <span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">()</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">1.89</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">273.15</span> <span class="o">*</span> <span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mf">273.15</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">1.69</span>
</code></pre>
</div>

<p>But this function can also be used to adjust symmetry effects from C1
calculations (symmetry number equals to one). For D7h, for instance, the
symmetry number is 14:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="o">-</span><span class="mf">298.15</span> <span class="o">*</span> <span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">-1.56</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">(</span><span class="n">sign</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">()</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_bias">
                            <input id="get_bias-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_bias</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">scheme</span>,</span><span class="param">	<span class="n">compounds</span>,</span><span class="param">	<span class="n">data</span>,</span><span class="param">	<span class="n">y0</span>,</span><span class="param">	<span class="n">tunneling</span><span class="o">=</span><span class="s1">&#39;eckart&#39;</span>,</span><span class="param">	<span class="n">qrrho</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">temperature</span><span class="o">=</span><span class="mf">298.15</span>,</span><span class="param">	<span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span>,</span><span class="param">	<span class="n">method</span><span class="o">=</span><span class="s1">&#39;LSODA&#39;</span>,</span><span class="param">	<span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span>,</span><span class="param">	<span class="n">atol</span><span class="o">=</span><span class="mf">1e-06</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_bias-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_bias"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_bias-587"><a href="#get_bias-587"><span class="linenos">587</span></a><span class="k">def</span> <span class="nf">get_bias</span><span class="p">(</span>
</span><span id="get_bias-588"><a href="#get_bias-588"><span class="linenos">588</span></a>    <span class="n">scheme</span><span class="p">,</span>
</span><span id="get_bias-589"><a href="#get_bias-589"><span class="linenos">589</span></a>    <span class="n">compounds</span><span class="p">,</span>
</span><span id="get_bias-590"><a href="#get_bias-590"><span class="linenos">590</span></a>    <span class="n">data</span><span class="p">,</span>
</span><span id="get_bias-591"><a href="#get_bias-591"><span class="linenos">591</span></a>    <span class="n">y0</span><span class="p">,</span>
</span><span id="get_bias-592"><a href="#get_bias-592"><span class="linenos">592</span></a>    <span class="n">tunneling</span><span class="o">=</span><span class="s2">&quot;eckart&quot;</span><span class="p">,</span>
</span><span id="get_bias-593"><a href="#get_bias-593"><span class="linenos">593</span></a>    <span class="n">qrrho</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT002</span>
</span><span id="get_bias-594"><a href="#get_bias-594"><span class="linenos">594</span></a>    <span class="n">temperature</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span>
</span><span id="get_bias-595"><a href="#get_bias-595"><span class="linenos">595</span></a>    <span class="n">pressure</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">atm</span><span class="p">,</span>
</span><span id="get_bias-596"><a href="#get_bias-596"><span class="linenos">596</span></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;LSODA&quot;</span><span class="p">,</span>
</span><span id="get_bias-597"><a href="#get_bias-597"><span class="linenos">597</span></a>    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
</span><span id="get_bias-598"><a href="#get_bias-598"><span class="linenos">598</span></a>    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
</span><span id="get_bias-599"><a href="#get_bias-599"><span class="linenos">599</span></a><span class="p">):</span>
</span><span id="get_bias-600"><a href="#get_bias-600"><span class="linenos">600</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Estimate a energy bias for a given set of reference data points.</span>
</span><span id="get_bias-601"><a href="#get_bias-601"><span class="linenos">601</span></a>
</span><span id="get_bias-602"><a href="#get_bias-602"><span class="linenos">602</span></a><span class="sd">    Parameters</span>
</span><span id="get_bias-603"><a href="#get_bias-603"><span class="linenos">603</span></a><span class="sd">    ----------</span>
</span><span id="get_bias-604"><a href="#get_bias-604"><span class="linenos">604</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="get_bias-605"><a href="#get_bias-605"><span class="linenos">605</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="get_bias-606"><a href="#get_bias-606"><span class="linenos">606</span></a><span class="sd">        Mostly likely, this comes from a parsed model input file.</span>
</span><span id="get_bias-607"><a href="#get_bias-607"><span class="linenos">607</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_bias-608"><a href="#get_bias-608"><span class="linenos">608</span></a><span class="sd">    compounds : dict-like</span>
</span><span id="get_bias-609"><a href="#get_bias-609"><span class="linenos">609</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_bias-610"><a href="#get_bias-610"><span class="linenos">610</span></a><span class="sd">        Mostly likely, this comes from a parsed model input file.</span>
</span><span id="get_bias-611"><a href="#get_bias-611"><span class="linenos">611</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_bias-612"><a href="#get_bias-612"><span class="linenos">612</span></a><span class="sd">    data : dict-like of array-like</span>
</span><span id="get_bias-613"><a href="#get_bias-613"><span class="linenos">613</span></a><span class="sd">    y0: array-like</span>
</span><span id="get_bias-614"><a href="#get_bias-614"><span class="linenos">614</span></a><span class="sd">    tunneling : str or None, optional</span>
</span><span id="get_bias-615"><a href="#get_bias-615"><span class="linenos">615</span></a><span class="sd">        Choose between &quot;eckart&quot;, &quot;wigner&quot; or None (or &quot;none&quot;).</span>
</span><span id="get_bias-616"><a href="#get_bias-616"><span class="linenos">616</span></a><span class="sd">    qrrho : bool or tuple-like, optional</span>
</span><span id="get_bias-617"><a href="#get_bias-617"><span class="linenos">617</span></a><span class="sd">        Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)</span>
</span><span id="get_bias-618"><a href="#get_bias-618"><span class="linenos">618</span></a><span class="sd">        approximations of M. Head-Gordon and others (enthalpy correction, see</span>
</span><span id="get_bias-619"><a href="#get_bias-619"><span class="linenos">619</span></a><span class="sd">        [*J. Phys. Chem. C* **2015**, 119, 4, 1840-1850](http://dx.doi.org/10.1021/jp509921r)) and S. Grimme (entropy correction, see</span>
</span><span id="get_bias-620"><a href="#get_bias-620"><span class="linenos">620</span></a><span class="sd">        [*Theory. Chem. Eur. J.*, **2012**, 18: 9955-9964](https://doi.org/10.1002/chem.201200497)) on top of the classical RRHO.</span>
</span><span id="get_bias-621"><a href="#get_bias-621"><span class="linenos">621</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_bias-622"><a href="#get_bias-622"><span class="linenos">622</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_bias-623"><a href="#get_bias-623"><span class="linenos">623</span></a><span class="sd">    pressure : array-like, optional</span>
</span><span id="get_bias-624"><a href="#get_bias-624"><span class="linenos">624</span></a><span class="sd">        Reference gas pressure.</span>
</span><span id="get_bias-625"><a href="#get_bias-625"><span class="linenos">625</span></a><span class="sd">    delta_freeenergies : array-like, optional</span>
</span><span id="get_bias-626"><a href="#get_bias-626"><span class="linenos">626</span></a><span class="sd">        Use this instead of obtaining delta free energies from the compounds.</span>
</span><span id="get_bias-627"><a href="#get_bias-627"><span class="linenos">627</span></a><span class="sd">    molecularity : array-like, optional</span>
</span><span id="get_bias-628"><a href="#get_bias-628"><span class="linenos">628</span></a><span class="sd">        Reaction order, i.e., number of molecules that come together to react.</span>
</span><span id="get_bias-629"><a href="#get_bias-629"><span class="linenos">629</span></a><span class="sd">        If set, this is used to calculate `delta_moles` for</span>
</span><span id="get_bias-630"><a href="#get_bias-630"><span class="linenos">630</span></a><span class="sd">        `equilibrium_constant`, which effectively calculates a solution</span>
</span><span id="get_bias-631"><a href="#get_bias-631"><span class="linenos">631</span></a><span class="sd">        equilibrium constant between reactants and the transition state for</span>
</span><span id="get_bias-632"><a href="#get_bias-632"><span class="linenos">632</span></a><span class="sd">        gas phase data. You should set this to `None` if your free energies</span>
</span><span id="get_bias-633"><a href="#get_bias-633"><span class="linenos">633</span></a><span class="sd">        were already adjusted for solution Gibbs free energies.</span>
</span><span id="get_bias-634"><a href="#get_bias-634"><span class="linenos">634</span></a><span class="sd">    volume : float, optional</span>
</span><span id="get_bias-635"><a href="#get_bias-635"><span class="linenos">635</span></a><span class="sd">        Molar volume.</span>
</span><span id="get_bias-636"><a href="#get_bias-636"><span class="linenos">636</span></a>
</span><span id="get_bias-637"><a href="#get_bias-637"><span class="linenos">637</span></a><span class="sd">    Returns</span>
</span><span id="get_bias-638"><a href="#get_bias-638"><span class="linenos">638</span></a><span class="sd">    -------</span>
</span><span id="get_bias-639"><a href="#get_bias-639"><span class="linenos">639</span></a><span class="sd">    array-like</span>
</span><span id="get_bias-640"><a href="#get_bias-640"><span class="linenos">640</span></a>
</span><span id="get_bias-641"><a href="#get_bias-641"><span class="linenos">641</span></a><span class="sd">    Examples</span>
</span><span id="get_bias-642"><a href="#get_bias-642"><span class="linenos">642</span></a><span class="sd">    --------</span>
</span><span id="get_bias-643"><a href="#get_bias-643"><span class="linenos">643</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/tanaka1996/UMP2/cc-pVTZ/model.jk&quot;)</span>
</span><span id="get_bias-644"><a href="#get_bias-644"><span class="linenos">644</span></a>
</span><span id="get_bias-645"><a href="#get_bias-645"><span class="linenos">645</span></a><span class="sd">    The following are some estimates on actual atmospheric concentrations:</span>
</span><span id="get_bias-646"><a href="#get_bias-646"><span class="linenos">646</span></a>
</span><span id="get_bias-647"><a href="#get_bias-647"><span class="linenos">647</span></a><span class="sd">    &gt;&gt;&gt; y0 = [4.8120675684099e-5,</span>
</span><span id="get_bias-648"><a href="#get_bias-648"><span class="linenos">648</span></a><span class="sd">    ...       2.8206357713029e-5,</span>
</span><span id="get_bias-649"><a href="#get_bias-649"><span class="linenos">649</span></a><span class="sd">    ...       0.0,</span>
</span><span id="get_bias-650"><a href="#get_bias-650"><span class="linenos">650</span></a><span class="sd">    ...       0.0,</span>
</span><span id="get_bias-651"><a href="#get_bias-651"><span class="linenos">651</span></a><span class="sd">    ...       2.7426565371219e-5]</span>
</span><span id="get_bias-652"><a href="#get_bias-652"><span class="linenos">652</span></a><span class="sd">    &gt;&gt;&gt; data = {&quot;t&quot;: [1.276472128376942246e-6,</span>
</span><span id="get_bias-653"><a href="#get_bias-653"><span class="linenos">653</span></a><span class="sd">    ...               1.446535794555581743e-4,</span>
</span><span id="get_bias-654"><a href="#get_bias-654"><span class="linenos">654</span></a><span class="sd">    ...               1.717069678525567564e-2],</span>
</span><span id="get_bias-655"><a href="#get_bias-655"><span class="linenos">655</span></a><span class="sd">    ...         &quot;CH3¬∑&quot;: [9.694916853338366211e-9,</span>
</span><span id="get_bias-656"><a href="#get_bias-656"><span class="linenos">656</span></a><span class="sd">    ...                  1.066033349343709026e-6,</span>
</span><span id="get_bias-657"><a href="#get_bias-657"><span class="linenos">657</span></a><span class="sd">    ...                  2.632179124780495175e-5]}</span>
</span><span id="get_bias-658"><a href="#get_bias-658"><span class="linenos">658</span></a><span class="sd">    &gt;&gt;&gt; get_bias(model.scheme, model.compounds, data, y0) / constants.kcal  # doctest: +SKIP</span>
</span><span id="get_bias-659"><a href="#get_bias-659"><span class="linenos">659</span></a><span class="sd">    -1.36</span>
</span><span id="get_bias-660"><a href="#get_bias-660"><span class="linenos">660</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_bias-661"><a href="#get_bias-661"><span class="linenos">661</span></a>    <span class="n">max_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
</span><span id="get_bias-662"><a href="#get_bias-662"><span class="linenos">662</span></a>
</span><span id="get_bias-663"><a href="#get_bias-663"><span class="linenos">663</span></a>    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">bias</span><span class="p">):</span>
</span><span id="get_bias-664"><a href="#get_bias-664"><span class="linenos">664</span></a>        <span class="n">k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_k</span><span class="p">(</span>
</span><span id="get_bias-665"><a href="#get_bias-665"><span class="linenos">665</span></a>            <span class="n">scheme</span><span class="p">,</span>
</span><span id="get_bias-666"><a href="#get_bias-666"><span class="linenos">666</span></a>            <span class="n">compounds</span><span class="p">,</span>
</span><span id="get_bias-667"><a href="#get_bias-667"><span class="linenos">667</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="get_bias-668"><a href="#get_bias-668"><span class="linenos">668</span></a>            <span class="n">tunneling</span><span class="o">=</span><span class="n">tunneling</span><span class="p">,</span>
</span><span id="get_bias-669"><a href="#get_bias-669"><span class="linenos">669</span></a>            <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho</span><span class="p">,</span>
</span><span id="get_bias-670"><a href="#get_bias-670"><span class="linenos">670</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_bias-671"><a href="#get_bias-671"><span class="linenos">671</span></a>            <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_bias-672"><a href="#get_bias-672"><span class="linenos">672</span></a>        <span class="p">)</span>
</span><span id="get_bias-673"><a href="#get_bias-673"><span class="linenos">673</span></a>
</span><span id="get_bias-674"><a href="#get_bias-674"><span class="linenos">674</span></a>        <span class="c1"># TODO(schneiderfelipe): support schemes with fixed concentrations</span>
</span><span id="get_bias-675"><a href="#get_bias-675"><span class="linenos">675</span></a>        <span class="n">dydt</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_dydt</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span><span id="get_bias-676"><a href="#get_bias-676"><span class="linenos">676</span></a>        <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_y</span><span class="p">(</span>
</span><span id="get_bias-677"><a href="#get_bias-677"><span class="linenos">677</span></a>            <span class="n">dydt</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">y0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="n">max_time</span>
</span><span id="get_bias-678"><a href="#get_bias-678"><span class="linenos">678</span></a>        <span class="p">)</span>
</span><span id="get_bias-679"><a href="#get_bias-679"><span class="linenos">679</span></a>
</span><span id="get_bias-680"><a href="#get_bias-680"><span class="linenos">680</span></a>        <span class="n">yhat</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
</span><span id="get_bias-681"><a href="#get_bias-681"><span class="linenos">681</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="get_bias-682"><a href="#get_bias-682"><span class="linenos">682</span></a>            <span class="p">[</span>
</span><span id="get_bias-683"><a href="#get_bias-683"><span class="linenos">683</span></a>                <span class="p">(</span><span class="n">yhat</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
</span><span id="get_bias-684"><a href="#get_bias-684"><span class="linenos">684</span></a>                <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="get_bias-685"><a href="#get_bias-685"><span class="linenos">685</span></a>                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">data</span>
</span><span id="get_bias-686"><a href="#get_bias-686"><span class="linenos">686</span></a>            <span class="p">]</span>
</span><span id="get_bias-687"><a href="#get_bias-687"><span class="linenos">687</span></a>        <span class="p">)</span>
</span><span id="get_bias-688"><a href="#get_bias-688"><span class="linenos">688</span></a>
</span><span id="get_bias-689"><a href="#get_bias-689"><span class="linenos">689</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">minimize_scalar</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="get_bias-690"><a href="#get_bias-690"><span class="linenos">690</span></a>    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">x</span>
</span></pre></div>


            <div class="docstring"><p>Estimate a energy bias for a given set of reference data points.</p>

<h2 id="parameters">Parameters</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.
    Mostly likely, this comes from a parsed model input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
compounds : dict-like
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed model input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
data : dict-like of array-like
y0: array-like
tunneling : str or None, optional
    Choose between "eckart", "wigner" or None (or "none").
qrrho : bool or tuple-like, optional
    Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)
    approximations of M. Head-Gordon and others (enthalpy correction, see
    <a href="http://dx.doi.org/10.1021/jp509921r"><em>J. Phys. Chem. C</em> <strong>2015</strong>, 119, 4, 1840-1850</a>) and S. Grimme (entropy correction, see
    <a href="https://doi.org/10.1002/chem.201200497"><em>Theory. Chem. Eur. J.</em>, <strong>2012</strong>, 18: 9955-9964</a>) on top of the classical RRHO.
temperature : array-like, optional
    Absolute temperature in Kelvin.
pressure : array-like, optional
    Reference gas pressure.
delta_freeenergies : array-like, optional
    Use this instead of obtaining delta free energies from the compounds.
molecularity : array-like, optional
    Reaction order, i.e., number of molecules that come together to react.
    If set, this is used to calculate <code>delta_moles</code> for
    <code>equilibrium_constant</code>, which effectively calculates a solution
    equilibrium constant between reactants and the transition state for
    gas phase data. You should set this to <code>None</code> if your free energies
    were already adjusted for solution Gibbs free energies.
volume : float, optional
    Molar volume.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/tanaka1996/UMP2/cc-pVTZ/model.jk&quot;</span><span class="p">)</span>
</code></pre>
</div>

<p>The following are some estimates on actual atmospheric concentrations:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.8120675684099e-5</span><span class="p">,</span>
<span class="gp">... </span>      <span class="mf">2.8206357713029e-5</span><span class="p">,</span>
<span class="gp">... </span>      <span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>      <span class="mf">0.0</span><span class="p">,</span>
<span class="gp">... </span>      <span class="mf">2.7426565371219e-5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;t&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.276472128376942246e-6</span><span class="p">,</span>
<span class="gp">... </span>              <span class="mf">1.446535794555581743e-4</span><span class="p">,</span>
<span class="gp">... </span>              <span class="mf">1.717069678525567564e-2</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s2">&quot;CH3¬∑&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">9.694916853338366211e-9</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="mf">1.066033349343709026e-6</span><span class="p">,</span>
<span class="gp">... </span>                 <span class="mf">2.632179124780495175e-5</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_bias</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">-1.36</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_delta">
                            <input id="get_delta-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_delta</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">transform</span>, </span><span class="param"><span class="nb">property</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_delta-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_delta"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_delta-568"><a href="#get_delta-568"><span class="linenos">568</span></a><span class="k">def</span> <span class="nf">get_delta</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="nb">property</span><span class="p">):</span>  <span class="c1"># noqa: A002</span>
</span><span id="get_delta-569"><a href="#get_delta-569"><span class="linenos">569</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate deltas according to reactions.</span>
</span><span id="get_delta-570"><a href="#get_delta-570"><span class="linenos">570</span></a>
</span><span id="get_delta-571"><a href="#get_delta-571"><span class="linenos">571</span></a><span class="sd">    Delta properties are differences in a property between the final and</span>
</span><span id="get_delta-572"><a href="#get_delta-572"><span class="linenos">572</span></a><span class="sd">    initial state of a chemical transformation. They are calculated from</span>
</span><span id="get_delta-573"><a href="#get_delta-573"><span class="linenos">573</span></a><span class="sd">    matrices representing the transformation and the absolute properties.</span>
</span><span id="get_delta-574"><a href="#get_delta-574"><span class="linenos">574</span></a><span class="sd">    Transformation matrices are expected to have column-wise transformation</span>
</span><span id="get_delta-575"><a href="#get_delta-575"><span class="linenos">575</span></a><span class="sd">    defined.</span>
</span><span id="get_delta-576"><a href="#get_delta-576"><span class="linenos">576</span></a>
</span><span id="get_delta-577"><a href="#get_delta-577"><span class="linenos">577</span></a><span class="sd">    Very useful for the calculation of reaction and activation free energies</span>
</span><span id="get_delta-578"><a href="#get_delta-578"><span class="linenos">578</span></a><span class="sd">    from absolute free energies of compounds. Matrices ``A`` and ``B`` of a</span>
</span><span id="get_delta-579"><a href="#get_delta-579"><span class="linenos">579</span></a><span class="sd">    `Scheme` represent the transformations associated with reaction and</span>
</span><span id="get_delta-580"><a href="#get_delta-580"><span class="linenos">580</span></a><span class="sd">    activation free energies, respectively.</span>
</span><span id="get_delta-581"><a href="#get_delta-581"><span class="linenos">581</span></a>
</span><span id="get_delta-582"><a href="#get_delta-582"><span class="linenos">582</span></a><span class="sd">    Parameters</span>
</span><span id="get_delta-583"><a href="#get_delta-583"><span class="linenos">583</span></a><span class="sd">    ----------</span>
</span><span id="get_delta-584"><a href="#get_delta-584"><span class="linenos">584</span></a><span class="sd">    transform : array-like</span>
</span><span id="get_delta-585"><a href="#get_delta-585"><span class="linenos">585</span></a><span class="sd">    property : array-like</span>
</span><span id="get_delta-586"><a href="#get_delta-586"><span class="linenos">586</span></a>
</span><span id="get_delta-587"><a href="#get_delta-587"><span class="linenos">587</span></a><span class="sd">    Returns</span>
</span><span id="get_delta-588"><a href="#get_delta-588"><span class="linenos">588</span></a><span class="sd">    -------</span>
</span><span id="get_delta-589"><a href="#get_delta-589"><span class="linenos">589</span></a><span class="sd">    delta_property : array-like</span>
</span><span id="get_delta-590"><a href="#get_delta-590"><span class="linenos">590</span></a>
</span><span id="get_delta-591"><a href="#get_delta-591"><span class="linenos">591</span></a><span class="sd">    Examples</span>
</span><span id="get_delta-592"><a href="#get_delta-592"><span class="linenos">592</span></a><span class="sd">    --------</span>
</span><span id="get_delta-593"><a href="#get_delta-593"><span class="linenos">593</span></a><span class="sd">    &gt;&gt;&gt; get_delta([-1, 1], [-10, 10])</span>
</span><span id="get_delta-594"><a href="#get_delta-594"><span class="linenos">594</span></a><span class="sd">    20</span>
</span><span id="get_delta-595"><a href="#get_delta-595"><span class="linenos">595</span></a>
</span><span id="get_delta-596"><a href="#get_delta-596"><span class="linenos">596</span></a><span class="sd">    You must ensure the transformation is properly defined, as no test is made</span>
</span><span id="get_delta-597"><a href="#get_delta-597"><span class="linenos">597</span></a><span class="sd">    to ensure, e.g., conservation of matter:</span>
</span><span id="get_delta-598"><a href="#get_delta-598"><span class="linenos">598</span></a>
</span><span id="get_delta-599"><a href="#get_delta-599"><span class="linenos">599</span></a><span class="sd">    &gt;&gt;&gt; get_delta([-1, 0], [-10, 20])</span>
</span><span id="get_delta-600"><a href="#get_delta-600"><span class="linenos">600</span></a><span class="sd">    10</span>
</span><span id="get_delta-601"><a href="#get_delta-601"><span class="linenos">601</span></a>
</span><span id="get_delta-602"><a href="#get_delta-602"><span class="linenos">602</span></a><span class="sd">    Normally, transformations are given as columns in a matrix:</span>
</span><span id="get_delta-603"><a href="#get_delta-603"><span class="linenos">603</span></a>
</span><span id="get_delta-604"><a href="#get_delta-604"><span class="linenos">604</span></a><span class="sd">    &gt;&gt;&gt; get_delta([[-1, -2],</span>
</span><span id="get_delta-605"><a href="#get_delta-605"><span class="linenos">605</span></a><span class="sd">    ...            [ 1,  3]], [-5, 12])</span>
</span><span id="get_delta-606"><a href="#get_delta-606"><span class="linenos">606</span></a><span class="sd">    array([17, 46])</span>
</span><span id="get_delta-607"><a href="#get_delta-607"><span class="linenos">607</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_delta-608"><a href="#get_delta-608"><span class="linenos">608</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">property</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate deltas according to reactions.</p>

<p>Delta properties are differences in a property between the final and
initial state of a chemical transformation. They are calculated from
matrices representing the transformation and the absolute properties.
Transformation matrices are expected to have column-wise transformation
defined.</p>

<p>Very useful for the calculation of reaction and activation free energies
from absolute free energies of compounds. Matrices <code>A</code> and <code>B</code> of a
<code><a href="#Scheme">Scheme</a></code> represent the transformations associated with reaction and
activation free energies, respectively.</p>

<h2 id="parameters">Parameters</h2>

<p>transform : array-like
property : array-like</p>

<h2 id="returns">Returns</h2>

<p>delta_property : array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_delta</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="go">20</span>
</code></pre>
</div>

<p>You must ensure the transformation is properly defined, as no test is made
to ensure, e.g., conservation of matter:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_delta</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="go">10</span>
</code></pre>
</div>

<p>Normally, transformations are given as columns in a matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_delta</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]],</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="go">array([17, 46])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_dydt">
                            <input id="get_dydt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dydt</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">scheme</span>, </span><span class="param"><span class="n">k</span>, </span><span class="param"><span class="n">ef</span><span class="o">=</span><span class="mf">8.246247365264608</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_dydt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_dydt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_dydt-215"><a href="#get_dydt-215"><span class="linenos">215</span></a><span class="k">def</span> <span class="nf">get_dydt</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ef</span><span class="o">=</span><span class="n">EF</span><span class="p">):</span>
</span><span id="get_dydt-216"><a href="#get_dydt-216"><span class="linenos">216</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate a rate function that models a reaction scheme.</span>
</span><span id="get_dydt-217"><a href="#get_dydt-217"><span class="linenos">217</span></a>
</span><span id="get_dydt-218"><a href="#get_dydt-218"><span class="linenos">218</span></a><span class="sd">    Parameters</span>
</span><span id="get_dydt-219"><a href="#get_dydt-219"><span class="linenos">219</span></a><span class="sd">    ----------</span>
</span><span id="get_dydt-220"><a href="#get_dydt-220"><span class="linenos">220</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="get_dydt-221"><a href="#get_dydt-221"><span class="linenos">221</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="get_dydt-222"><a href="#get_dydt-222"><span class="linenos">222</span></a><span class="sd">        Mostly likely, this comes from a parsed model input file.</span>
</span><span id="get_dydt-223"><a href="#get_dydt-223"><span class="linenos">223</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_dydt-224"><a href="#get_dydt-224"><span class="linenos">224</span></a><span class="sd">    k : array-like</span>
</span><span id="get_dydt-225"><a href="#get_dydt-225"><span class="linenos">225</span></a><span class="sd">        Reaction rate constant(s). Units match the concentration units given to</span>
</span><span id="get_dydt-226"><a href="#get_dydt-226"><span class="linenos">226</span></a><span class="sd">        the returned function ``dydt``.</span>
</span><span id="get_dydt-227"><a href="#get_dydt-227"><span class="linenos">227</span></a><span class="sd">    ef : float, optional</span>
</span><span id="get_dydt-228"><a href="#get_dydt-228"><span class="linenos">228</span></a><span class="sd">        Equilibrium factor. This is a parameter that can be used to scale the</span>
</span><span id="get_dydt-229"><a href="#get_dydt-229"><span class="linenos">229</span></a><span class="sd">        reaction rates associated to half-equilibrium reactions such that they</span>
</span><span id="get_dydt-230"><a href="#get_dydt-230"><span class="linenos">230</span></a><span class="sd">        are faster than the other reactions.</span>
</span><span id="get_dydt-231"><a href="#get_dydt-231"><span class="linenos">231</span></a>
</span><span id="get_dydt-232"><a href="#get_dydt-232"><span class="linenos">232</span></a><span class="sd">    Returns</span>
</span><span id="get_dydt-233"><a href="#get_dydt-233"><span class="linenos">233</span></a><span class="sd">    -------</span>
</span><span id="get_dydt-234"><a href="#get_dydt-234"><span class="linenos">234</span></a><span class="sd">    dydt : callable</span>
</span><span id="get_dydt-235"><a href="#get_dydt-235"><span class="linenos">235</span></a><span class="sd">        Reaction rate function. The actual reaction rate constants employed</span>
</span><span id="get_dydt-236"><a href="#get_dydt-236"><span class="linenos">236</span></a><span class="sd">        are stored in the attribute `k` of the returned function. If JAX is</span>
</span><span id="get_dydt-237"><a href="#get_dydt-237"><span class="linenos">237</span></a><span class="sd">        available, the attribute `jac` will hold the Jacobian function of</span>
</span><span id="get_dydt-238"><a href="#get_dydt-238"><span class="linenos">238</span></a><span class="sd">        `dydt`.</span>
</span><span id="get_dydt-239"><a href="#get_dydt-239"><span class="linenos">239</span></a>
</span><span id="get_dydt-240"><a href="#get_dydt-240"><span class="linenos">240</span></a><span class="sd">    Notes</span>
</span><span id="get_dydt-241"><a href="#get_dydt-241"><span class="linenos">241</span></a><span class="sd">    -----</span>
</span><span id="get_dydt-242"><a href="#get_dydt-242"><span class="linenos">242</span></a><span class="sd">    The returned function is suited to be used by ODE solvers such as</span>
</span><span id="get_dydt-243"><a href="#get_dydt-243"><span class="linenos">243</span></a><span class="sd">    `scipy.integrate.solve_ivp` or the older `scipy.integrate.ode` (see</span>
</span><span id="get_dydt-244"><a href="#get_dydt-244"><span class="linenos">244</span></a><span class="sd">    examples below). This is actually what the function `get_y` from the</span>
</span><span id="get_dydt-245"><a href="#get_dydt-245"><span class="linenos">245</span></a><span class="sd">    current module does.</span>
</span><span id="get_dydt-246"><a href="#get_dydt-246"><span class="linenos">246</span></a>
</span><span id="get_dydt-247"><a href="#get_dydt-247"><span class="linenos">247</span></a><span class="sd">    Examples</span>
</span><span id="get_dydt-248"><a href="#get_dydt-248"><span class="linenos">248</span></a><span class="sd">    --------</span>
</span><span id="get_dydt-249"><a href="#get_dydt-249"><span class="linenos">249</span></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
</span><span id="get_dydt-250"><a href="#get_dydt-250"><span class="linenos">250</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_dydt-251"><a href="#get_dydt-251"><span class="linenos">251</span></a>
</span><span id="get_dydt-252"><a href="#get_dydt-252"><span class="linenos">252</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A &lt;=&gt; B&quot;)</span>
</span><span id="get_dydt-253"><a href="#get_dydt-253"><span class="linenos">253</span></a><span class="sd">    &gt;&gt;&gt; dydt = get_dydt(scheme, np.array([1, 1]))</span>
</span><span id="get_dydt-254"><a href="#get_dydt-254"><span class="linenos">254</span></a><span class="sd">    &gt;&gt;&gt; dydt(0.0, np.array([1., 1.]))  # doctest: +SKIP</span>
</span><span id="get_dydt-255"><a href="#get_dydt-255"><span class="linenos">255</span></a><span class="sd">    array([0., 0.])</span>
</span><span id="get_dydt-256"><a href="#get_dydt-256"><span class="linenos">256</span></a>
</span><span id="get_dydt-257"><a href="#get_dydt-257"><span class="linenos">257</span></a><span class="sd">    If available, JAX is used for JIT compilation. This will make `dydt`</span>
</span><span id="get_dydt-258"><a href="#get_dydt-258"><span class="linenos">258</span></a><span class="sd">    complain if given lists instead of numpy arrays. So stick to the safer,</span>
</span><span id="get_dydt-259"><a href="#get_dydt-259"><span class="linenos">259</span></a><span class="sd">    faster side as above.</span>
</span><span id="get_dydt-260"><a href="#get_dydt-260"><span class="linenos">260</span></a>
</span><span id="get_dydt-261"><a href="#get_dydt-261"><span class="linenos">261</span></a><span class="sd">    The actually used reaction rate constants can be inspected with the `k`</span>
</span><span id="get_dydt-262"><a href="#get_dydt-262"><span class="linenos">262</span></a><span class="sd">    attribute of `dydt`:</span>
</span><span id="get_dydt-263"><a href="#get_dydt-263"><span class="linenos">263</span></a>
</span><span id="get_dydt-264"><a href="#get_dydt-264"><span class="linenos">264</span></a><span class="sd">    &gt;&gt;&gt; dydt.k  # doctest: +SKIP</span>
</span><span id="get_dydt-265"><a href="#get_dydt-265"><span class="linenos">265</span></a><span class="sd">    array([1., 1.])</span>
</span><span id="get_dydt-266"><a href="#get_dydt-266"><span class="linenos">266</span></a>
</span><span id="get_dydt-267"><a href="#get_dydt-267"><span class="linenos">267</span></a><span class="sd">    If JAX is available, the Jacobian function will be available as</span>
</span><span id="get_dydt-268"><a href="#get_dydt-268"><span class="linenos">268</span></a><span class="sd">    `dydt.jac`:</span>
</span><span id="get_dydt-269"><a href="#get_dydt-269"><span class="linenos">269</span></a>
</span><span id="get_dydt-270"><a href="#get_dydt-270"><span class="linenos">270</span></a><span class="sd">    &gt;&gt;&gt; dydt.jac(0.0, np.array([1., 1.]))  # doctest: +SKIP</span>
</span><span id="get_dydt-271"><a href="#get_dydt-271"><span class="linenos">271</span></a><span class="sd">    DeviceArray([[-1.,  1.],</span>
</span><span id="get_dydt-272"><a href="#get_dydt-272"><span class="linenos">272</span></a><span class="sd">                 [ 1., -1.]], dtype=float64)</span>
</span><span id="get_dydt-273"><a href="#get_dydt-273"><span class="linenos">273</span></a>
</span><span id="get_dydt-274"><a href="#get_dydt-274"><span class="linenos">274</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_dydt-275"><a href="#get_dydt-275"><span class="linenos">275</span></a>    <span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_check_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
</span><span id="get_dydt-276"><a href="#get_dydt-276"><span class="linenos">276</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_dydt-277"><a href="#get_dydt-277"><span class="linenos">277</span></a>    <span class="n">M</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">A</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_dydt-278"><a href="#get_dydt-278"><span class="linenos">278</span></a>    <span class="n">k_adj</span> <span class="o">=</span> <span class="n">_adjust_k</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ef</span><span class="o">=</span><span class="n">ef</span><span class="p">)</span>
</span><span id="get_dydt-279"><a href="#get_dydt-279"><span class="linenos">279</span></a>
</span><span id="get_dydt-280"><a href="#get_dydt-280"><span class="linenos">280</span></a>    <span class="k">def</span> <span class="nf">_dydt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>  <span class="c1"># noqa: ARG001</span>
</span><span id="get_dydt-281"><a href="#get_dydt-281"><span class="linenos">281</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="n">k_adj</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="get_dydt-282"><a href="#get_dydt-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
</span><span id="get_dydt-283"><a href="#get_dydt-283"><span class="linenos">283</span></a>
</span><span id="get_dydt-284"><a href="#get_dydt-284"><span class="linenos">284</span></a>    <span class="k">if</span> <span class="n">_found_jax</span><span class="p">:</span>
</span><span id="get_dydt-285"><a href="#get_dydt-285"><span class="linenos">285</span></a>        <span class="c1"># Using JAX for JIT compilation is much faster.</span>
</span><span id="get_dydt-286"><a href="#get_dydt-286"><span class="linenos">286</span></a>        <span class="n">_dydt</span> <span class="o">=</span> <span class="n">jit</span><span class="p">(</span><span class="n">_dydt</span><span class="p">)</span>
</span><span id="get_dydt-287"><a href="#get_dydt-287"><span class="linenos">287</span></a>
</span><span id="get_dydt-288"><a href="#get_dydt-288"><span class="linenos">288</span></a>        <span class="c1"># NOTE(schneiderfelipe): the following function is defined</span>
</span><span id="get_dydt-289"><a href="#get_dydt-289"><span class="linenos">289</span></a>        <span class="c1"># such that _jac(t, y)[i, j] == d f_i / d y_j,</span>
</span><span id="get_dydt-290"><a href="#get_dydt-290"><span class="linenos">290</span></a>        <span class="c1"># with shape of (n_compounds, n_compounds).</span>
</span><span id="get_dydt-291"><a href="#get_dydt-291"><span class="linenos">291</span></a>        <span class="k">def</span> <span class="nf">_jac</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
</span><span id="get_dydt-292"><a href="#get_dydt-292"><span class="linenos">292</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[A@t = </span><span class="se">\x1b</span><span class="s2">[94m</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s2">10.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\x1b</span><span class="s2">[ms</span><span class="se">\x1b</span><span class="s2">[K&quot;</span><span class="p">)</span>
</span><span id="get_dydt-293"><a href="#get_dydt-293"><span class="linenos">293</span></a>            <span class="k">return</span> <span class="n">jacfwd</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_y</span><span class="p">:</span> <span class="n">_dydt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">_y</span><span class="p">))(</span><span class="n">y</span><span class="p">)</span>
</span><span id="get_dydt-294"><a href="#get_dydt-294"><span class="linenos">294</span></a>
</span><span id="get_dydt-295"><a href="#get_dydt-295"><span class="linenos">295</span></a>        <span class="n">_dydt</span><span class="o">.</span><span class="n">jac</span> <span class="o">=</span> <span class="n">_jac</span>
</span><span id="get_dydt-296"><a href="#get_dydt-296"><span class="linenos">296</span></a>
</span><span id="get_dydt-297"><a href="#get_dydt-297"><span class="linenos">297</span></a>    <span class="n">_dydt</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="n">k_adj</span>
</span><span id="get_dydt-298"><a href="#get_dydt-298"><span class="linenos">298</span></a>    <span class="k">return</span> <span class="n">_dydt</span>
</span></pre></div>


            <div class="docstring"><p>Generate a rate function that models a reaction scheme.</p>

<h2 id="parameters">Parameters</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.
    Mostly likely, this comes from a parsed model input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
k : array-like
    Reaction rate constant(s). Units match the concentration units given to
    the returned function <code>dydt</code>.
ef : float, optional
    Equilibrium factor. This is a parameter that can be used to scale the
    reaction rates associated to half-equilibrium reactions such that they
    are faster than the other reactions.</p>

<h2 id="returns">Returns</h2>

<p>dydt : callable
    Reaction rate function. The actual reaction rate constants employed
    are stored in the attribute <code>k</code> of the returned function. If JAX is
    available, the attribute <code>jac</code> will hold the Jacobian function of
    <code>dydt</code>.</p>

<h2 id="notes">Notes</h2>

<p>The returned function is suited to be used by ODE solvers such as
<code>scipy.integrate.solve_ivp</code> or the older <code>scipy.integrate.ode</code> (see
examples below). This is actually what the function <code><a href="#get_y">get_y</a></code> from the
current module does.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A &lt;=&gt; B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span> <span class="o">=</span> <span class="n">get_dydt</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([0., 0.])</span>
</code></pre>
</div>

<p>If available, JAX is used for JIT compilation. This will make <code>dydt</code>
complain if given lists instead of numpy arrays. So stick to the safer,
faster side as above.</p>

<p>The actually used reaction rate constants can be inspected with the <code>k</code>
attribute of <code>dydt</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span><span class="o">.</span><span class="n">k</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([1., 1.])</span>
</code></pre>
</div>

<p>If JAX is available, the Jacobian function will be available as
<code>dydt.jac</code>:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">dydt</span><span class="o">.</span><span class="n">jac</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">DeviceArray([[-1.,  1.],</span>
<span class="go">             [ 1., -1.]], dtype=float64)</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_enthalpies">
                            <input id="get_enthalpies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_enthalpies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span>, </span><span class="param"><span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>, </span><span class="param"><span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_enthalpies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_enthalpies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_enthalpies-96"><a href="#get_enthalpies-96"><span class="linenos"> 96</span></a><span class="k">def</span> <span class="nf">get_enthalpies</span><span class="p">(</span>
</span><span id="get_enthalpies-97"><a href="#get_enthalpies-97"><span class="linenos"> 97</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="get_enthalpies-98"><a href="#get_enthalpies-98"><span class="linenos"> 98</span></a>    <span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT001, FBT002</span>
</span><span id="get_enthalpies-99"><a href="#get_enthalpies-99"><span class="linenos"> 99</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>  <span class="c1"># noqa: RUF100</span>
</span><span id="get_enthalpies-100"><a href="#get_enthalpies-100"><span class="linenos">100</span></a><span class="p">):</span>  <span class="c1"># noqa: RUF100</span>
</span><span id="get_enthalpies-101"><a href="#get_enthalpies-101"><span class="linenos">101</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain enthalpies for compounds at a given temperature.</span>
</span><span id="get_enthalpies-102"><a href="#get_enthalpies-102"><span class="linenos">102</span></a>
</span><span id="get_enthalpies-103"><a href="#get_enthalpies-103"><span class="linenos">103</span></a><span class="sd">    Parameters</span>
</span><span id="get_enthalpies-104"><a href="#get_enthalpies-104"><span class="linenos">104</span></a><span class="sd">    ----------</span>
</span><span id="get_enthalpies-105"><a href="#get_enthalpies-105"><span class="linenos">105</span></a><span class="sd">    compounds : dict-like</span>
</span><span id="get_enthalpies-106"><a href="#get_enthalpies-106"><span class="linenos">106</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_enthalpies-107"><a href="#get_enthalpies-107"><span class="linenos">107</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_enthalpies-108"><a href="#get_enthalpies-108"><span class="linenos">108</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_enthalpies-109"><a href="#get_enthalpies-109"><span class="linenos">109</span></a><span class="sd">    qrrho : bool, optional</span>
</span><span id="get_enthalpies-110"><a href="#get_enthalpies-110"><span class="linenos">110</span></a><span class="sd">        Apply the quasi-rigid rotor harmonic oscillator (QRRHO) approximation of</span>
</span><span id="get_enthalpies-111"><a href="#get_enthalpies-111"><span class="linenos">111</span></a><span class="sd">        M. Head-Gordon and others (see</span>
</span><span id="get_enthalpies-112"><a href="#get_enthalpies-112"><span class="linenos">112</span></a><span class="sd">        [*J. Phys. Chem. C* **2015**, 119, 4, 1840-1850](http://dx.doi.org/10.1021/jp509921r))</span>
</span><span id="get_enthalpies-113"><a href="#get_enthalpies-113"><span class="linenos">113</span></a><span class="sd">        on top of the classical RRHO.</span>
</span><span id="get_enthalpies-114"><a href="#get_enthalpies-114"><span class="linenos">114</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_enthalpies-115"><a href="#get_enthalpies-115"><span class="linenos">115</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_enthalpies-116"><a href="#get_enthalpies-116"><span class="linenos">116</span></a>
</span><span id="get_enthalpies-117"><a href="#get_enthalpies-117"><span class="linenos">117</span></a><span class="sd">    Returns</span>
</span><span id="get_enthalpies-118"><a href="#get_enthalpies-118"><span class="linenos">118</span></a><span class="sd">    -------</span>
</span><span id="get_enthalpies-119"><a href="#get_enthalpies-119"><span class="linenos">119</span></a><span class="sd">    array-like</span>
</span><span id="get_enthalpies-120"><a href="#get_enthalpies-120"><span class="linenos">120</span></a>
</span><span id="get_enthalpies-121"><a href="#get_enthalpies-121"><span class="linenos">121</span></a><span class="sd">    Examples</span>
</span><span id="get_enthalpies-122"><a href="#get_enthalpies-122"><span class="linenos">122</span></a><span class="sd">    --------</span>
</span><span id="get_enthalpies-123"><a href="#get_enthalpies-123"><span class="linenos">123</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_enthalpies-124"><a href="#get_enthalpies-124"><span class="linenos">124</span></a><span class="sd">    &gt;&gt;&gt; from overreact import _constants as constants</span>
</span><span id="get_enthalpies-125"><a href="#get_enthalpies-125"><span class="linenos">125</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/ethane/B97-3c/model.k&quot;)</span>
</span><span id="get_enthalpies-126"><a href="#get_enthalpies-126"><span class="linenos">126</span></a><span class="sd">    &gt;&gt;&gt; enthalpies = get_enthalpies(model.compounds)</span>
</span><span id="get_enthalpies-127"><a href="#get_enthalpies-127"><span class="linenos">127</span></a><span class="sd">    &gt;&gt;&gt; (enthalpies - enthalpies.min()) / constants.kcal</span>
</span><span id="get_enthalpies-128"><a href="#get_enthalpies-128"><span class="linenos">128</span></a><span class="sd">    array([0. , 2.20053981])</span>
</span><span id="get_enthalpies-129"><a href="#get_enthalpies-129"><span class="linenos">129</span></a>
</span><span id="get_enthalpies-130"><a href="#get_enthalpies-130"><span class="linenos">130</span></a><span class="sd">    The enthalpies at absolute zero can easily be obtained (this is used,</span>
</span><span id="get_enthalpies-131"><a href="#get_enthalpies-131"><span class="linenos">131</span></a><span class="sd">    e.g., in the calculation of the Eckart tunneling coefficient, see</span>
</span><span id="get_enthalpies-132"><a href="#get_enthalpies-132"><span class="linenos">132</span></a><span class="sd">    `overreact.tunnel.eckart`). We can use this to calculate, for instance,</span>
</span><span id="get_enthalpies-133"><a href="#get_enthalpies-133"><span class="linenos">133</span></a><span class="sd">    the thermal contributions to the enthalpy:</span>
</span><span id="get_enthalpies-134"><a href="#get_enthalpies-134"><span class="linenos">134</span></a>
</span><span id="get_enthalpies-135"><a href="#get_enthalpies-135"><span class="linenos">135</span></a><span class="sd">    &gt;&gt;&gt; zero_enthalpies = get_enthalpies(model.compounds, temperature=0)</span>
</span><span id="get_enthalpies-136"><a href="#get_enthalpies-136"><span class="linenos">136</span></a><span class="sd">    &gt;&gt;&gt; (enthalpies - zero_enthalpies) / constants.kcal</span>
</span><span id="get_enthalpies-137"><a href="#get_enthalpies-137"><span class="linenos">137</span></a><span class="sd">    array([2.78, 2.50])</span>
</span><span id="get_enthalpies-138"><a href="#get_enthalpies-138"><span class="linenos">138</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_enthalpies-139"><a href="#get_enthalpies-139"><span class="linenos">139</span></a>    <span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">_check_compounds</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="get_enthalpies-140"><a href="#get_enthalpies-140"><span class="linenos">140</span></a>    <span class="n">enthalpies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_enthalpies-141"><a href="#get_enthalpies-141"><span class="linenos">141</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">:</span>
</span><span id="get_enthalpies-142"><a href="#get_enthalpies-142"><span class="linenos">142</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;calculate enthalpy: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_enthalpies-143"><a href="#get_enthalpies-143"><span class="linenos">143</span></a>
</span><span id="get_enthalpies-144"><a href="#get_enthalpies-144"><span class="linenos">144</span></a>        <span class="c1"># TODO(schneiderfelipe): inertia might benefit from caching</span>
</span><span id="get_enthalpies-145"><a href="#get_enthalpies-145"><span class="linenos">145</span></a>        <span class="n">moments</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">inertia</span><span class="p">(</span>
</span><span id="get_enthalpies-146"><a href="#get_enthalpies-146"><span class="linenos">146</span></a>            <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atommasses</span><span class="p">,</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atomcoords</span>
</span><span id="get_enthalpies-147"><a href="#get_enthalpies-147"><span class="linenos">147</span></a>        <span class="p">)</span>
</span><span id="get_enthalpies-148"><a href="#get_enthalpies-148"><span class="linenos">148</span></a>
</span><span id="get_enthalpies-149"><a href="#get_enthalpies-149"><span class="linenos">149</span></a>        <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">thermo</span><span class="o">.</span><span class="n">calc_enthalpy</span><span class="p">(</span>
</span><span id="get_enthalpies-150"><a href="#get_enthalpies-150"><span class="linenos">150</span></a>            <span class="n">energy</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="get_enthalpies-151"><a href="#get_enthalpies-151"><span class="linenos">151</span></a>            <span class="n">degeneracy</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">mult</span><span class="p">,</span>
</span><span id="get_enthalpies-152"><a href="#get_enthalpies-152"><span class="linenos">152</span></a>            <span class="n">moments</span><span class="o">=</span><span class="n">moments</span><span class="p">,</span>
</span><span id="get_enthalpies-153"><a href="#get_enthalpies-153"><span class="linenos">153</span></a>            <span class="n">vibfreqs</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">vibfreqs</span><span class="p">,</span>
</span><span id="get_enthalpies-154"><a href="#get_enthalpies-154"><span class="linenos">154</span></a>            <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho</span><span class="p">,</span>
</span><span id="get_enthalpies-155"><a href="#get_enthalpies-155"><span class="linenos">155</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_enthalpies-156"><a href="#get_enthalpies-156"><span class="linenos">156</span></a>        <span class="p">)</span>
</span><span id="get_enthalpies-157"><a href="#get_enthalpies-157"><span class="linenos">157</span></a>        <span class="n">enthalpies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">enthalpy</span><span class="p">)</span>
</span><span id="get_enthalpies-158"><a href="#get_enthalpies-158"><span class="linenos">158</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">enthalpies</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Obtain enthalpies for compounds at a given temperature.</p>

<h2 id="parameters">Parameters</h2>

<p>compounds : dict-like
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
qrrho : bool, optional
    Apply the quasi-rigid rotor harmonic oscillator (QRRHO) approximation of
    M. Head-Gordon and others (see
    <a href="http://dx.doi.org/10.1021/jp509921r"><em>J. Phys. Chem. C</em> <strong>2015</strong>, 119, 4, 1840-1850</a>)
    on top of the classical RRHO.
temperature : array-like, optional
    Absolute temperature in Kelvin.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overreact</span> <span class="kn">import</span> <span class="n">_constants</span> <span class="k">as</span> <span class="n">constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enthalpies</span> <span class="o">=</span> <span class="n">get_enthalpies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">enthalpies</span> <span class="o">-</span> <span class="n">enthalpies</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">array([0. , 2.20053981])</span>
</code></pre>
</div>

<p>The enthalpies at absolute zero can easily be obtained (this is used,
e.g., in the calculation of the Eckart tunneling coefficient, see
<code>overreact.tunnel.eckart</code>). We can use this to calculate, for instance,
the thermal contributions to the enthalpy:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">zero_enthalpies</span> <span class="o">=</span> <span class="n">get_enthalpies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">enthalpies</span> <span class="o">-</span> <span class="n">zero_enthalpies</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">array([2.78, 2.50])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_entropies">
                            <input id="get_entropies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_entropies</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span>,</span><span class="param">	<span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;standard&#39;</span>,</span><span class="param">	<span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span>,</span><span class="param">	<span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_entropies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_entropies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_entropies-161"><a href="#get_entropies-161"><span class="linenos">161</span></a><span class="k">def</span> <span class="nf">get_entropies</span><span class="p">(</span>
</span><span id="get_entropies-162"><a href="#get_entropies-162"><span class="linenos">162</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="get_entropies-163"><a href="#get_entropies-163"><span class="linenos">163</span></a>    <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="get_entropies-164"><a href="#get_entropies-164"><span class="linenos">164</span></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
</span><span id="get_entropies-165"><a href="#get_entropies-165"><span class="linenos">165</span></a>    <span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT001, FBT002</span>
</span><span id="get_entropies-166"><a href="#get_entropies-166"><span class="linenos">166</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>
</span><span id="get_entropies-167"><a href="#get_entropies-167"><span class="linenos">167</span></a>    <span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">atm</span><span class="p">,</span>
</span><span id="get_entropies-168"><a href="#get_entropies-168"><span class="linenos">168</span></a><span class="p">):</span>
</span><span id="get_entropies-169"><a href="#get_entropies-169"><span class="linenos">169</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain entropies for compounds at a given temperature and pressure.</span>
</span><span id="get_entropies-170"><a href="#get_entropies-170"><span class="linenos">170</span></a>
</span><span id="get_entropies-171"><a href="#get_entropies-171"><span class="linenos">171</span></a><span class="sd">    Parameters</span>
</span><span id="get_entropies-172"><a href="#get_entropies-172"><span class="linenos">172</span></a><span class="sd">    ----------</span>
</span><span id="get_entropies-173"><a href="#get_entropies-173"><span class="linenos">173</span></a><span class="sd">    compounds : dict-like</span>
</span><span id="get_entropies-174"><a href="#get_entropies-174"><span class="linenos">174</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_entropies-175"><a href="#get_entropies-175"><span class="linenos">175</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_entropies-176"><a href="#get_entropies-176"><span class="linenos">176</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_entropies-177"><a href="#get_entropies-177"><span class="linenos">177</span></a><span class="sd">    environment : str or None, optional</span>
</span><span id="get_entropies-178"><a href="#get_entropies-178"><span class="linenos">178</span></a><span class="sd">        Choose between &quot;gas&quot; and a solvent. This is chosen for you by default,</span>
</span><span id="get_entropies-179"><a href="#get_entropies-179"><span class="linenos">179</span></a><span class="sd">        based on the names of each compound (e.g. `A(g)` or `A` is gas,</span>
</span><span id="get_entropies-180"><a href="#get_entropies-180"><span class="linenos">180</span></a><span class="sd">        `A(w)` or `A(...)` is solvated). In case this is given, all compounds</span>
</span><span id="get_entropies-181"><a href="#get_entropies-181"><span class="linenos">181</span></a><span class="sd">        will have the same behavior.</span>
</span><span id="get_entropies-182"><a href="#get_entropies-182"><span class="linenos">182</span></a><span class="sd">    method : str, optional</span>
</span><span id="get_entropies-183"><a href="#get_entropies-183"><span class="linenos">183</span></a><span class="sd">        This is a placeholder for future functionality.</span>
</span><span id="get_entropies-184"><a href="#get_entropies-184"><span class="linenos">184</span></a><span class="sd">        There are plans to implement more sophisticated methods for calculating</span>
</span><span id="get_entropies-185"><a href="#get_entropies-185"><span class="linenos">185</span></a><span class="sd">        entropies such as in</span>
</span><span id="get_entropies-186"><a href="#get_entropies-186"><span class="linenos">186</span></a><span class="sd">        [*Phys. Chem. Chem. Phys.*, **2019**, 21, 18920-18929](https://doi.org/10.1039/C9CP03226F)</span>
</span><span id="get_entropies-187"><a href="#get_entropies-187"><span class="linenos">187</span></a><span class="sd">        and</span>
</span><span id="get_entropies-188"><a href="#get_entropies-188"><span class="linenos">188</span></a><span class="sd">        [*J. Chem. Theory Comput.* **2019**, 15, 5, 3204-3214](https://doi.org/10.1021/acs.jctc.9b00214).</span>
</span><span id="get_entropies-189"><a href="#get_entropies-189"><span class="linenos">189</span></a><span class="sd">        Head over to the</span>
</span><span id="get_entropies-190"><a href="#get_entropies-190"><span class="linenos">190</span></a><span class="sd">        [discussions](https://github.com/geem-lab/overreact/discussions) if</span>
</span><span id="get_entropies-191"><a href="#get_entropies-191"><span class="linenos">191</span></a><span class="sd">        you&#39;re interested and would like to contribute.</span>
</span><span id="get_entropies-192"><a href="#get_entropies-192"><span class="linenos">192</span></a><span class="sd">        Leave this as &quot;standard&quot; for now.</span>
</span><span id="get_entropies-193"><a href="#get_entropies-193"><span class="linenos">193</span></a><span class="sd">    qrrho : bool, optional</span>
</span><span id="get_entropies-194"><a href="#get_entropies-194"><span class="linenos">194</span></a><span class="sd">        Apply the quasi-rigid rotor harmonic oscillator (QRRHO) approximation of</span>
</span><span id="get_entropies-195"><a href="#get_entropies-195"><span class="linenos">195</span></a><span class="sd">        S. Grimme (see</span>
</span><span id="get_entropies-196"><a href="#get_entropies-196"><span class="linenos">196</span></a><span class="sd">        [*Theory. Chem. Eur. J.*, **2012**, 18: 9955-9964](https://doi.org/10.1002/chem.201200497))</span>
</span><span id="get_entropies-197"><a href="#get_entropies-197"><span class="linenos">197</span></a><span class="sd">        on top of the classical RRHO.</span>
</span><span id="get_entropies-198"><a href="#get_entropies-198"><span class="linenos">198</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_entropies-199"><a href="#get_entropies-199"><span class="linenos">199</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_entropies-200"><a href="#get_entropies-200"><span class="linenos">200</span></a><span class="sd">    pressure : array-like, optional</span>
</span><span id="get_entropies-201"><a href="#get_entropies-201"><span class="linenos">201</span></a><span class="sd">        Reference gas pressure.</span>
</span><span id="get_entropies-202"><a href="#get_entropies-202"><span class="linenos">202</span></a>
</span><span id="get_entropies-203"><a href="#get_entropies-203"><span class="linenos">203</span></a><span class="sd">    Returns</span>
</span><span id="get_entropies-204"><a href="#get_entropies-204"><span class="linenos">204</span></a><span class="sd">    -------</span>
</span><span id="get_entropies-205"><a href="#get_entropies-205"><span class="linenos">205</span></a><span class="sd">    array-like</span>
</span><span id="get_entropies-206"><a href="#get_entropies-206"><span class="linenos">206</span></a>
</span><span id="get_entropies-207"><a href="#get_entropies-207"><span class="linenos">207</span></a><span class="sd">    Examples</span>
</span><span id="get_entropies-208"><a href="#get_entropies-208"><span class="linenos">208</span></a><span class="sd">    --------</span>
</span><span id="get_entropies-209"><a href="#get_entropies-209"><span class="linenos">209</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_entropies-210"><a href="#get_entropies-210"><span class="linenos">210</span></a><span class="sd">    &gt;&gt;&gt; from overreact import _constants as constants</span>
</span><span id="get_entropies-211"><a href="#get_entropies-211"><span class="linenos">211</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/ethane/B97-3c/model.k&quot;)</span>
</span><span id="get_entropies-212"><a href="#get_entropies-212"><span class="linenos">212</span></a><span class="sd">    &gt;&gt;&gt; entropies = get_entropies(model.compounds)</span>
</span><span id="get_entropies-213"><a href="#get_entropies-213"><span class="linenos">213</span></a><span class="sd">    &gt;&gt;&gt; (entropies - entropies.min()) / constants.calorie</span>
</span><span id="get_entropies-214"><a href="#get_entropies-214"><span class="linenos">214</span></a><span class="sd">    array([1.4, 0. ])</span>
</span><span id="get_entropies-215"><a href="#get_entropies-215"><span class="linenos">215</span></a>
</span><span id="get_entropies-216"><a href="#get_entropies-216"><span class="linenos">216</span></a><span class="sd">    You can consider all compounds as solvated if you want:</span>
</span><span id="get_entropies-217"><a href="#get_entropies-217"><span class="linenos">217</span></a>
</span><span id="get_entropies-218"><a href="#get_entropies-218"><span class="linenos">218</span></a><span class="sd">    &gt;&gt;&gt; sol_entropies = get_entropies(model.compounds, environment=&quot;solvent&quot;)</span>
</span><span id="get_entropies-219"><a href="#get_entropies-219"><span class="linenos">219</span></a><span class="sd">    &gt;&gt;&gt; (sol_entropies - entropies) / constants.calorie</span>
</span><span id="get_entropies-220"><a href="#get_entropies-220"><span class="linenos">220</span></a><span class="sd">    array([-6.35360874, -6.35360874])</span>
</span><span id="get_entropies-221"><a href="#get_entropies-221"><span class="linenos">221</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_entropies-222"><a href="#get_entropies-222"><span class="linenos">222</span></a>    <span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">_check_compounds</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="get_entropies-223"><a href="#get_entropies-223"><span class="linenos">223</span></a>    <span class="n">entropies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_entropies-224"><a href="#get_entropies-224"><span class="linenos">224</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">:</span>
</span><span id="get_entropies-225"><a href="#get_entropies-225"><span class="linenos">225</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;calculate entropy: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_entropies-226"><a href="#get_entropies-226"><span class="linenos">226</span></a>
</span><span id="get_entropies-227"><a href="#get_entropies-227"><span class="linenos">227</span></a>        <span class="k">if</span> <span class="s2">&quot;point_group&quot;</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
</span><span id="get_entropies-228"><a href="#get_entropies-228"><span class="linenos">228</span></a>            <span class="n">point_group</span> <span class="o">=</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">point_group</span>
</span><span id="get_entropies-229"><a href="#get_entropies-229"><span class="linenos">229</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="get_entropies-230"><a href="#get_entropies-230"><span class="linenos">230</span></a>            <span class="n">point_group</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">find_point_group</span><span class="p">(</span>
</span><span id="get_entropies-231"><a href="#get_entropies-231"><span class="linenos">231</span></a>                <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atommasses</span><span class="p">,</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atomcoords</span>
</span><span id="get_entropies-232"><a href="#get_entropies-232"><span class="linenos">232</span></a>            <span class="p">)</span>
</span><span id="get_entropies-233"><a href="#get_entropies-233"><span class="linenos">233</span></a>        <span class="n">symmetry_number</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">symmetry_number</span><span class="p">(</span><span class="n">point_group</span><span class="p">)</span>
</span><span id="get_entropies-234"><a href="#get_entropies-234"><span class="linenos">234</span></a>
</span><span id="get_entropies-235"><a href="#get_entropies-235"><span class="linenos">235</span></a>        <span class="c1"># TODO(schneiderfelipe): inertia might benefit from caching</span>
</span><span id="get_entropies-236"><a href="#get_entropies-236"><span class="linenos">236</span></a>        <span class="n">moments</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">inertia</span><span class="p">(</span>
</span><span id="get_entropies-237"><a href="#get_entropies-237"><span class="linenos">237</span></a>            <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atommasses</span><span class="p">,</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atomcoords</span>
</span><span id="get_entropies-238"><a href="#get_entropies-238"><span class="linenos">238</span></a>        <span class="p">)</span>
</span><span id="get_entropies-239"><a href="#get_entropies-239"><span class="linenos">239</span></a>
</span><span id="get_entropies-240"><a href="#get_entropies-240"><span class="linenos">240</span></a>        <span class="k">if</span> <span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_entropies-241"><a href="#get_entropies-241"><span class="linenos">241</span></a>            <span class="n">environment</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_get_environment</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</span><span id="get_entropies-242"><a href="#get_entropies-242"><span class="linenos">242</span></a>        <span class="n">entropy</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">thermo</span><span class="o">.</span><span class="n">calc_entropy</span><span class="p">(</span>
</span><span id="get_entropies-243"><a href="#get_entropies-243"><span class="linenos">243</span></a>            <span class="n">atommasses</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atommasses</span><span class="p">,</span>
</span><span id="get_entropies-244"><a href="#get_entropies-244"><span class="linenos">244</span></a>            <span class="n">atomcoords</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atomcoords</span><span class="p">,</span>
</span><span id="get_entropies-245"><a href="#get_entropies-245"><span class="linenos">245</span></a>            <span class="n">energy</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="get_entropies-246"><a href="#get_entropies-246"><span class="linenos">246</span></a>            <span class="n">degeneracy</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">mult</span><span class="p">,</span>
</span><span id="get_entropies-247"><a href="#get_entropies-247"><span class="linenos">247</span></a>            <span class="n">moments</span><span class="o">=</span><span class="n">moments</span><span class="p">,</span>
</span><span id="get_entropies-248"><a href="#get_entropies-248"><span class="linenos">248</span></a>            <span class="n">symmetry_number</span><span class="o">=</span><span class="n">symmetry_number</span><span class="p">,</span>
</span><span id="get_entropies-249"><a href="#get_entropies-249"><span class="linenos">249</span></a>            <span class="n">vibfreqs</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">vibfreqs</span><span class="p">,</span>
</span><span id="get_entropies-250"><a href="#get_entropies-250"><span class="linenos">250</span></a>            <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
</span><span id="get_entropies-251"><a href="#get_entropies-251"><span class="linenos">251</span></a>            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="get_entropies-252"><a href="#get_entropies-252"><span class="linenos">252</span></a>            <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho</span><span class="p">,</span>
</span><span id="get_entropies-253"><a href="#get_entropies-253"><span class="linenos">253</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_entropies-254"><a href="#get_entropies-254"><span class="linenos">254</span></a>            <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_entropies-255"><a href="#get_entropies-255"><span class="linenos">255</span></a>        <span class="p">)</span>
</span><span id="get_entropies-256"><a href="#get_entropies-256"><span class="linenos">256</span></a>
</span><span id="get_entropies-257"><a href="#get_entropies-257"><span class="linenos">257</span></a>        <span class="k">if</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">symmetry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_entropies-258"><a href="#get_entropies-258"><span class="linenos">258</span></a>            <span class="c1"># The negative sign here seems correct. See equations (9) and (10)</span>
</span><span id="get_entropies-259"><a href="#get_entropies-259"><span class="linenos">259</span></a>            <span class="c1"># of doi:10.1002/qua.25686.</span>
</span><span id="get_entropies-260"><a href="#get_entropies-260"><span class="linenos">260</span></a>            <span class="n">entropy</span> <span class="o">-=</span> <span class="n">rx</span><span class="o">.</span><span class="n">change_reference_state</span><span class="p">(</span>
</span><span id="get_entropies-261"><a href="#get_entropies-261"><span class="linenos">261</span></a>                <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">symmetry</span><span class="p">,</span>
</span><span id="get_entropies-262"><a href="#get_entropies-262"><span class="linenos">262</span></a>                <span class="mi">1</span><span class="p">,</span>
</span><span id="get_entropies-263"><a href="#get_entropies-263"><span class="linenos">263</span></a>                <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_entropies-264"><a href="#get_entropies-264"><span class="linenos">264</span></a>                <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_entropies-265"><a href="#get_entropies-265"><span class="linenos">265</span></a>            <span class="p">)</span>
</span><span id="get_entropies-266"><a href="#get_entropies-266"><span class="linenos">266</span></a>
</span><span id="get_entropies-267"><a href="#get_entropies-267"><span class="linenos">267</span></a>        <span class="n">entropies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entropy</span><span class="p">)</span>
</span><span id="get_entropies-268"><a href="#get_entropies-268"><span class="linenos">268</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">entropies</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Obtain entropies for compounds at a given temperature and pressure.</p>

<h2 id="parameters">Parameters</h2>

<p>compounds : dict-like
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
environment : str or None, optional
    Choose between "gas" and a solvent. This is chosen for you by default,
    based on the names of each compound (e.g. <code>A(g)</code> or <code>A</code> is gas,
    <code>A(w)</code> or <code>A(...)</code> is solvated). In case this is given, all compounds
    will have the same behavior.
method : str, optional
    This is a placeholder for future functionality.
    There are plans to implement more sophisticated methods for calculating
    entropies such as in
    <a href="https://doi.org/10.1039/C9CP03226F"><em>Phys. Chem. Chem. Phys.</em>, <strong>2019</strong>, 21, 18920-18929</a>
    and
    <a href="https://doi.org/10.1021/acs.jctc.9b00214"><em>J. Chem. Theory Comput.</em> <strong>2019</strong>, 15, 5, 3204-3214</a>.
    Head over to the
    <a href="https://github.com/geem-lab/overreact/discussions">discussions</a> if
    you're interested and would like to contribute.
    Leave this as "standard" for now.
qrrho : bool, optional
    Apply the quasi-rigid rotor harmonic oscillator (QRRHO) approximation of
    S. Grimme (see
    <a href="https://doi.org/10.1002/chem.201200497"><em>Theory. Chem. Eur. J.</em>, <strong>2012</strong>, 18: 9955-9964</a>)
    on top of the classical RRHO.
temperature : array-like, optional
    Absolute temperature in Kelvin.
pressure : array-like, optional
    Reference gas pressure.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overreact</span> <span class="kn">import</span> <span class="n">_constants</span> <span class="k">as</span> <span class="n">constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">entropies</span> <span class="o">=</span> <span class="n">get_entropies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">entropies</span> <span class="o">-</span> <span class="n">entropies</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">calorie</span>
<span class="go">array([1.4, 0. ])</span>
</code></pre>
</div>

<p>You can consider all compounds as solvated if you want:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sol_entropies</span> <span class="o">=</span> <span class="n">get_entropies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s2">&quot;solvent&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sol_entropies</span> <span class="o">-</span> <span class="n">entropies</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">calorie</span>
<span class="go">array([-6.35360874, -6.35360874])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_fixed_scheme">
                            <input id="get_fixed_scheme-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_fixed_scheme</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">scheme</span>, </span><span class="param"><span class="n">k</span>, </span><span class="param"><span class="n">fixed_y0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_fixed_scheme-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_fixed_scheme"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_fixed_scheme-378"><a href="#get_fixed_scheme-378"><span class="linenos">378</span></a><span class="k">def</span> <span class="nf">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">fixed_y0</span><span class="p">):</span>
</span><span id="get_fixed_scheme-379"><a href="#get_fixed_scheme-379"><span class="linenos">379</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an alternative scheme with some concentrations fixed.</span>
</span><span id="get_fixed_scheme-380"><a href="#get_fixed_scheme-380"><span class="linenos">380</span></a>
</span><span id="get_fixed_scheme-381"><a href="#get_fixed_scheme-381"><span class="linenos">381</span></a><span class="sd">    This function returns data that allow the microkinetic simulation of a</span>
</span><span id="get_fixed_scheme-382"><a href="#get_fixed_scheme-382"><span class="linenos">382</span></a><span class="sd">    reaction network under constraints, namely when some compounds have fixed</span>
</span><span id="get_fixed_scheme-383"><a href="#get_fixed_scheme-383"><span class="linenos">383</span></a><span class="sd">    concentrations. This works by 1. removing all references to the fixed</span>
</span><span id="get_fixed_scheme-384"><a href="#get_fixed_scheme-384"><span class="linenos">384</span></a><span class="sd">    compounds and by 2. properly multiplying the reaction rate constants by</span>
</span><span id="get_fixed_scheme-385"><a href="#get_fixed_scheme-385"><span class="linenos">385</span></a><span class="sd">    the respective concentrations.</span>
</span><span id="get_fixed_scheme-386"><a href="#get_fixed_scheme-386"><span class="linenos">386</span></a>
</span><span id="get_fixed_scheme-387"><a href="#get_fixed_scheme-387"><span class="linenos">387</span></a><span class="sd">    Parameters</span>
</span><span id="get_fixed_scheme-388"><a href="#get_fixed_scheme-388"><span class="linenos">388</span></a><span class="sd">    ----------</span>
</span><span id="get_fixed_scheme-389"><a href="#get_fixed_scheme-389"><span class="linenos">389</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="get_fixed_scheme-390"><a href="#get_fixed_scheme-390"><span class="linenos">390</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="get_fixed_scheme-391"><a href="#get_fixed_scheme-391"><span class="linenos">391</span></a><span class="sd">        Mostly likely, this comes from a parsed model input file.</span>
</span><span id="get_fixed_scheme-392"><a href="#get_fixed_scheme-392"><span class="linenos">392</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_fixed_scheme-393"><a href="#get_fixed_scheme-393"><span class="linenos">393</span></a><span class="sd">    k : array-like</span>
</span><span id="get_fixed_scheme-394"><a href="#get_fixed_scheme-394"><span class="linenos">394</span></a><span class="sd">        Reaction rate constant(s). Units match the concentration units given to</span>
</span><span id="get_fixed_scheme-395"><a href="#get_fixed_scheme-395"><span class="linenos">395</span></a><span class="sd">        the returned function ``dydt``.</span>
</span><span id="get_fixed_scheme-396"><a href="#get_fixed_scheme-396"><span class="linenos">396</span></a><span class="sd">    fixed_y0 : dict-like</span>
</span><span id="get_fixed_scheme-397"><a href="#get_fixed_scheme-397"><span class="linenos">397</span></a><span class="sd">        Fixed initial state. Units match the concentration units given to</span>
</span><span id="get_fixed_scheme-398"><a href="#get_fixed_scheme-398"><span class="linenos">398</span></a><span class="sd">        the returned function ``dydt``.</span>
</span><span id="get_fixed_scheme-399"><a href="#get_fixed_scheme-399"><span class="linenos">399</span></a>
</span><span id="get_fixed_scheme-400"><a href="#get_fixed_scheme-400"><span class="linenos">400</span></a><span class="sd">    Returns</span>
</span><span id="get_fixed_scheme-401"><a href="#get_fixed_scheme-401"><span class="linenos">401</span></a><span class="sd">    -------</span>
</span><span id="get_fixed_scheme-402"><a href="#get_fixed_scheme-402"><span class="linenos">402</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="get_fixed_scheme-403"><a href="#get_fixed_scheme-403"><span class="linenos">403</span></a><span class="sd">        Associated reaction scheme with all references to fixed compounds</span>
</span><span id="get_fixed_scheme-404"><a href="#get_fixed_scheme-404"><span class="linenos">404</span></a><span class="sd">        removed.</span>
</span><span id="get_fixed_scheme-405"><a href="#get_fixed_scheme-405"><span class="linenos">405</span></a><span class="sd">    k : array-like</span>
</span><span id="get_fixed_scheme-406"><a href="#get_fixed_scheme-406"><span class="linenos">406</span></a><span class="sd">        Associated (effective) reaction rate constants that model the fixed</span>
</span><span id="get_fixed_scheme-407"><a href="#get_fixed_scheme-407"><span class="linenos">407</span></a><span class="sd">        concentrations.</span>
</span><span id="get_fixed_scheme-408"><a href="#get_fixed_scheme-408"><span class="linenos">408</span></a>
</span><span id="get_fixed_scheme-409"><a href="#get_fixed_scheme-409"><span class="linenos">409</span></a><span class="sd">    Notes</span>
</span><span id="get_fixed_scheme-410"><a href="#get_fixed_scheme-410"><span class="linenos">410</span></a><span class="sd">    -----</span>
</span><span id="get_fixed_scheme-411"><a href="#get_fixed_scheme-411"><span class="linenos">411</span></a><span class="sd">    Keep in mind that when a compound get its concentration fixed, the</span>
</span><span id="get_fixed_scheme-412"><a href="#get_fixed_scheme-412"><span class="linenos">412</span></a><span class="sd">    reaction scheme no longer conserves matter. You can think of it as</span>
</span><span id="get_fixed_scheme-413"><a href="#get_fixed_scheme-413"><span class="linenos">413</span></a><span class="sd">    reacting close to an infinite source of the compound, but it accumulates</span>
</span><span id="get_fixed_scheme-414"><a href="#get_fixed_scheme-414"><span class="linenos">414</span></a><span class="sd">    in the milleu at the given concentration.</span>
</span><span id="get_fixed_scheme-415"><a href="#get_fixed_scheme-415"><span class="linenos">415</span></a>
</span><span id="get_fixed_scheme-416"><a href="#get_fixed_scheme-416"><span class="linenos">416</span></a><span class="sd">    Examples</span>
</span><span id="get_fixed_scheme-417"><a href="#get_fixed_scheme-417"><span class="linenos">417</span></a><span class="sd">    --------</span>
</span><span id="get_fixed_scheme-418"><a href="#get_fixed_scheme-418"><span class="linenos">418</span></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
</span><span id="get_fixed_scheme-419"><a href="#get_fixed_scheme-419"><span class="linenos">419</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_fixed_scheme-420"><a href="#get_fixed_scheme-420"><span class="linenos">420</span></a>
</span><span id="get_fixed_scheme-421"><a href="#get_fixed_scheme-421"><span class="linenos">421</span></a><span class="sd">    Equilibria under a specific pH can be easily modeled:</span>
</span><span id="get_fixed_scheme-422"><a href="#get_fixed_scheme-422"><span class="linenos">422</span></a>
</span><span id="get_fixed_scheme-423"><a href="#get_fixed_scheme-423"><span class="linenos">423</span></a><span class="sd">    &gt;&gt;&gt; pH = 7</span>
</span><span id="get_fixed_scheme-424"><a href="#get_fixed_scheme-424"><span class="linenos">424</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;AH &lt;=&gt; A- + H+&quot;)</span>
</span><span id="get_fixed_scheme-425"><a href="#get_fixed_scheme-425"><span class="linenos">425</span></a><span class="sd">    &gt;&gt;&gt; k = np.array([1, 1])</span>
</span><span id="get_fixed_scheme-426"><a href="#get_fixed_scheme-426"><span class="linenos">426</span></a><span class="sd">    &gt;&gt;&gt; scheme, k = rx.get_fixed_scheme(scheme, k, {&quot;H+&quot;: 10**-pH})</span>
</span><span id="get_fixed_scheme-427"><a href="#get_fixed_scheme-427"><span class="linenos">427</span></a><span class="sd">    &gt;&gt;&gt; scheme</span>
</span><span id="get_fixed_scheme-428"><a href="#get_fixed_scheme-428"><span class="linenos">428</span></a><span class="sd">    Scheme(compounds=(&#39;AH&#39;, &#39;A-&#39;),</span>
</span><span id="get_fixed_scheme-429"><a href="#get_fixed_scheme-429"><span class="linenos">429</span></a><span class="sd">           reactions=(&#39;AH -&gt; A-&#39;,</span>
</span><span id="get_fixed_scheme-430"><a href="#get_fixed_scheme-430"><span class="linenos">430</span></a><span class="sd">                      &#39;A- -&gt; AH&#39;),</span>
</span><span id="get_fixed_scheme-431"><a href="#get_fixed_scheme-431"><span class="linenos">431</span></a><span class="sd">           is_half_equilibrium=(True, True),</span>
</span><span id="get_fixed_scheme-432"><a href="#get_fixed_scheme-432"><span class="linenos">432</span></a><span class="sd">           A=((-1.0, 1.0),</span>
</span><span id="get_fixed_scheme-433"><a href="#get_fixed_scheme-433"><span class="linenos">433</span></a><span class="sd">              (1.0, -1.0)),</span>
</span><span id="get_fixed_scheme-434"><a href="#get_fixed_scheme-434"><span class="linenos">434</span></a><span class="sd">           B=((-1.0, 0.0),</span>
</span><span id="get_fixed_scheme-435"><a href="#get_fixed_scheme-435"><span class="linenos">435</span></a><span class="sd">              (1.0, 0.0)))</span>
</span><span id="get_fixed_scheme-436"><a href="#get_fixed_scheme-436"><span class="linenos">436</span></a><span class="sd">    &gt;&gt;&gt; k</span>
</span><span id="get_fixed_scheme-437"><a href="#get_fixed_scheme-437"><span class="linenos">437</span></a><span class="sd">    array([1.e+00, 1.e-07])</span>
</span><span id="get_fixed_scheme-438"><a href="#get_fixed_scheme-438"><span class="linenos">438</span></a>
</span><span id="get_fixed_scheme-439"><a href="#get_fixed_scheme-439"><span class="linenos">439</span></a><span class="sd">    It is also possible to model the fixed activity of a solvent, for</span>
</span><span id="get_fixed_scheme-440"><a href="#get_fixed_scheme-440"><span class="linenos">440</span></a><span class="sd">    instance:</span>
</span><span id="get_fixed_scheme-441"><a href="#get_fixed_scheme-441"><span class="linenos">441</span></a>
</span><span id="get_fixed_scheme-442"><a href="#get_fixed_scheme-442"><span class="linenos">442</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A + 2H2O -&gt; B&quot;)</span>
</span><span id="get_fixed_scheme-443"><a href="#get_fixed_scheme-443"><span class="linenos">443</span></a><span class="sd">    &gt;&gt;&gt; k = np.array([1.0])</span>
</span><span id="get_fixed_scheme-444"><a href="#get_fixed_scheme-444"><span class="linenos">444</span></a><span class="sd">    &gt;&gt;&gt; scheme, k = rx.get_fixed_scheme(scheme, k, {&quot;H2O&quot;: 55.6})</span>
</span><span id="get_fixed_scheme-445"><a href="#get_fixed_scheme-445"><span class="linenos">445</span></a><span class="sd">    &gt;&gt;&gt; scheme</span>
</span><span id="get_fixed_scheme-446"><a href="#get_fixed_scheme-446"><span class="linenos">446</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
</span><span id="get_fixed_scheme-447"><a href="#get_fixed_scheme-447"><span class="linenos">447</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="get_fixed_scheme-448"><a href="#get_fixed_scheme-448"><span class="linenos">448</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="get_fixed_scheme-449"><a href="#get_fixed_scheme-449"><span class="linenos">449</span></a><span class="sd">           A=((-1.0,),</span>
</span><span id="get_fixed_scheme-450"><a href="#get_fixed_scheme-450"><span class="linenos">450</span></a><span class="sd">              (1.0,)),</span>
</span><span id="get_fixed_scheme-451"><a href="#get_fixed_scheme-451"><span class="linenos">451</span></a><span class="sd">           B=((-1.0,),</span>
</span><span id="get_fixed_scheme-452"><a href="#get_fixed_scheme-452"><span class="linenos">452</span></a><span class="sd">              (1.0,)))</span>
</span><span id="get_fixed_scheme-453"><a href="#get_fixed_scheme-453"><span class="linenos">453</span></a><span class="sd">    &gt;&gt;&gt; k</span>
</span><span id="get_fixed_scheme-454"><a href="#get_fixed_scheme-454"><span class="linenos">454</span></a><span class="sd">    array([3091.36])</span>
</span><span id="get_fixed_scheme-455"><a href="#get_fixed_scheme-455"><span class="linenos">455</span></a>
</span><span id="get_fixed_scheme-456"><a href="#get_fixed_scheme-456"><span class="linenos">456</span></a><span class="sd">    Multiple reactions work fine, see both examples below:</span>
</span><span id="get_fixed_scheme-457"><a href="#get_fixed_scheme-457"><span class="linenos">457</span></a>
</span><span id="get_fixed_scheme-458"><a href="#get_fixed_scheme-458"><span class="linenos">458</span></a><span class="sd">    &gt;&gt;&gt; pH = 12</span>
</span><span id="get_fixed_scheme-459"><a href="#get_fixed_scheme-459"><span class="linenos">459</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;B &lt;- AH &lt;=&gt; A- + H+&quot;)</span>
</span><span id="get_fixed_scheme-460"><a href="#get_fixed_scheme-460"><span class="linenos">460</span></a><span class="sd">    &gt;&gt;&gt; k = np.array([10.0, 1, 1])</span>
</span><span id="get_fixed_scheme-461"><a href="#get_fixed_scheme-461"><span class="linenos">461</span></a><span class="sd">    &gt;&gt;&gt; scheme, k = rx.get_fixed_scheme(scheme, k, {&quot;H+&quot;: 10**-pH})</span>
</span><span id="get_fixed_scheme-462"><a href="#get_fixed_scheme-462"><span class="linenos">462</span></a><span class="sd">    &gt;&gt;&gt; scheme</span>
</span><span id="get_fixed_scheme-463"><a href="#get_fixed_scheme-463"><span class="linenos">463</span></a><span class="sd">    Scheme(compounds=(&#39;AH&#39;, &#39;B&#39;, &#39;A-&#39;),</span>
</span><span id="get_fixed_scheme-464"><a href="#get_fixed_scheme-464"><span class="linenos">464</span></a><span class="sd">           reactions=(&#39;AH -&gt; B&#39;,</span>
</span><span id="get_fixed_scheme-465"><a href="#get_fixed_scheme-465"><span class="linenos">465</span></a><span class="sd">                      &#39;AH -&gt; A-&#39;,</span>
</span><span id="get_fixed_scheme-466"><a href="#get_fixed_scheme-466"><span class="linenos">466</span></a><span class="sd">                      &#39;A- -&gt; AH&#39;),</span>
</span><span id="get_fixed_scheme-467"><a href="#get_fixed_scheme-467"><span class="linenos">467</span></a><span class="sd">           is_half_equilibrium=(False, True, True),</span>
</span><span id="get_fixed_scheme-468"><a href="#get_fixed_scheme-468"><span class="linenos">468</span></a><span class="sd">           A=((-1.0, -1.0, 1.0),</span>
</span><span id="get_fixed_scheme-469"><a href="#get_fixed_scheme-469"><span class="linenos">469</span></a><span class="sd">              (1.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-470"><a href="#get_fixed_scheme-470"><span class="linenos">470</span></a><span class="sd">              (0.0, 1.0, -1.0)),</span>
</span><span id="get_fixed_scheme-471"><a href="#get_fixed_scheme-471"><span class="linenos">471</span></a><span class="sd">           B=((-1.0, -1.0, 0.0),</span>
</span><span id="get_fixed_scheme-472"><a href="#get_fixed_scheme-472"><span class="linenos">472</span></a><span class="sd">              (1.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-473"><a href="#get_fixed_scheme-473"><span class="linenos">473</span></a><span class="sd">              (0.0, 1.0, 0.0)))</span>
</span><span id="get_fixed_scheme-474"><a href="#get_fixed_scheme-474"><span class="linenos">474</span></a><span class="sd">    &gt;&gt;&gt; k</span>
</span><span id="get_fixed_scheme-475"><a href="#get_fixed_scheme-475"><span class="linenos">475</span></a><span class="sd">    array([1.e+01, 1.e+00, 1.e-12])</span>
</span><span id="get_fixed_scheme-476"><a href="#get_fixed_scheme-476"><span class="linenos">476</span></a>
</span><span id="get_fixed_scheme-477"><a href="#get_fixed_scheme-477"><span class="linenos">477</span></a><span class="sd">    &gt;&gt;&gt; pH = 2</span>
</span><span id="get_fixed_scheme-478"><a href="#get_fixed_scheme-478"><span class="linenos">478</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions([&quot;AH &lt;=&gt; A- + H+&quot;, &quot;B- + H+ &lt;=&gt; BH&quot;])</span>
</span><span id="get_fixed_scheme-479"><a href="#get_fixed_scheme-479"><span class="linenos">479</span></a><span class="sd">    &gt;&gt;&gt; k = np.array([1, 1, 2, 2])</span>
</span><span id="get_fixed_scheme-480"><a href="#get_fixed_scheme-480"><span class="linenos">480</span></a><span class="sd">    &gt;&gt;&gt; scheme, k = rx.get_fixed_scheme(scheme, k, {&quot;H+&quot;: 10**-pH})</span>
</span><span id="get_fixed_scheme-481"><a href="#get_fixed_scheme-481"><span class="linenos">481</span></a><span class="sd">    &gt;&gt;&gt; scheme</span>
</span><span id="get_fixed_scheme-482"><a href="#get_fixed_scheme-482"><span class="linenos">482</span></a><span class="sd">    Scheme(compounds=(&#39;AH&#39;, &#39;A-&#39;, &#39;B-&#39;, &#39;BH&#39;),</span>
</span><span id="get_fixed_scheme-483"><a href="#get_fixed_scheme-483"><span class="linenos">483</span></a><span class="sd">           reactions=(&#39;AH -&gt; A-&#39;,</span>
</span><span id="get_fixed_scheme-484"><a href="#get_fixed_scheme-484"><span class="linenos">484</span></a><span class="sd">                      &#39;A- -&gt; AH&#39;,</span>
</span><span id="get_fixed_scheme-485"><a href="#get_fixed_scheme-485"><span class="linenos">485</span></a><span class="sd">                      &#39;B- -&gt; BH&#39;,</span>
</span><span id="get_fixed_scheme-486"><a href="#get_fixed_scheme-486"><span class="linenos">486</span></a><span class="sd">                      &#39;BH -&gt; B-&#39;),</span>
</span><span id="get_fixed_scheme-487"><a href="#get_fixed_scheme-487"><span class="linenos">487</span></a><span class="sd">           is_half_equilibrium=(True, True, True, True),</span>
</span><span id="get_fixed_scheme-488"><a href="#get_fixed_scheme-488"><span class="linenos">488</span></a><span class="sd">           A=((-1.0, 1.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-489"><a href="#get_fixed_scheme-489"><span class="linenos">489</span></a><span class="sd">              (1.0, -1.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-490"><a href="#get_fixed_scheme-490"><span class="linenos">490</span></a><span class="sd">              (0.0, 0.0, -1.0, 1.0),</span>
</span><span id="get_fixed_scheme-491"><a href="#get_fixed_scheme-491"><span class="linenos">491</span></a><span class="sd">              (0.0, 0.0, 1.0, -1.0)),</span>
</span><span id="get_fixed_scheme-492"><a href="#get_fixed_scheme-492"><span class="linenos">492</span></a><span class="sd">           B=((-1.0, 0.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-493"><a href="#get_fixed_scheme-493"><span class="linenos">493</span></a><span class="sd">              (1.0, 0.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-494"><a href="#get_fixed_scheme-494"><span class="linenos">494</span></a><span class="sd">              (0.0, 0.0, -1.0, 0.0),</span>
</span><span id="get_fixed_scheme-495"><a href="#get_fixed_scheme-495"><span class="linenos">495</span></a><span class="sd">              (0.0, 0.0, 1.0, 0.0)))</span>
</span><span id="get_fixed_scheme-496"><a href="#get_fixed_scheme-496"><span class="linenos">496</span></a><span class="sd">    &gt;&gt;&gt; k</span>
</span><span id="get_fixed_scheme-497"><a href="#get_fixed_scheme-497"><span class="linenos">497</span></a><span class="sd">    array([1. , 0.01, 0.02, 2. ])</span>
</span><span id="get_fixed_scheme-498"><a href="#get_fixed_scheme-498"><span class="linenos">498</span></a>
</span><span id="get_fixed_scheme-499"><a href="#get_fixed_scheme-499"><span class="linenos">499</span></a><span class="sd">    Multiple fixed compounds also work fine:</span>
</span><span id="get_fixed_scheme-500"><a href="#get_fixed_scheme-500"><span class="linenos">500</span></a>
</span><span id="get_fixed_scheme-501"><a href="#get_fixed_scheme-501"><span class="linenos">501</span></a><span class="sd">    &gt;&gt;&gt; pH = 6</span>
</span><span id="get_fixed_scheme-502"><a href="#get_fixed_scheme-502"><span class="linenos">502</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A + H2O -&gt; B &lt;=&gt; B- + H+&quot;)</span>
</span><span id="get_fixed_scheme-503"><a href="#get_fixed_scheme-503"><span class="linenos">503</span></a><span class="sd">    &gt;&gt;&gt; k = np.array([1.0, 100.0, 2.0])</span>
</span><span id="get_fixed_scheme-504"><a href="#get_fixed_scheme-504"><span class="linenos">504</span></a><span class="sd">    &gt;&gt;&gt; scheme, k = rx.get_fixed_scheme(scheme, k, {&quot;H+&quot;: 10**-pH, &quot;H2O&quot;: 55.6})</span>
</span><span id="get_fixed_scheme-505"><a href="#get_fixed_scheme-505"><span class="linenos">505</span></a><span class="sd">    &gt;&gt;&gt; scheme</span>
</span><span id="get_fixed_scheme-506"><a href="#get_fixed_scheme-506"><span class="linenos">506</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;B&#39;, &#39;B-&#39;),</span>
</span><span id="get_fixed_scheme-507"><a href="#get_fixed_scheme-507"><span class="linenos">507</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;,</span>
</span><span id="get_fixed_scheme-508"><a href="#get_fixed_scheme-508"><span class="linenos">508</span></a><span class="sd">                      &#39;B -&gt; B-&#39;,</span>
</span><span id="get_fixed_scheme-509"><a href="#get_fixed_scheme-509"><span class="linenos">509</span></a><span class="sd">                      &#39;B- -&gt; B&#39;),</span>
</span><span id="get_fixed_scheme-510"><a href="#get_fixed_scheme-510"><span class="linenos">510</span></a><span class="sd">           is_half_equilibrium=(False, True, True),</span>
</span><span id="get_fixed_scheme-511"><a href="#get_fixed_scheme-511"><span class="linenos">511</span></a><span class="sd">           A=((-1.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-512"><a href="#get_fixed_scheme-512"><span class="linenos">512</span></a><span class="sd">              (1.0, -1.0, 1.0),</span>
</span><span id="get_fixed_scheme-513"><a href="#get_fixed_scheme-513"><span class="linenos">513</span></a><span class="sd">              (0.0, 1.0, -1.0)),</span>
</span><span id="get_fixed_scheme-514"><a href="#get_fixed_scheme-514"><span class="linenos">514</span></a><span class="sd">           B=((-1.0, 0.0, 0.0),</span>
</span><span id="get_fixed_scheme-515"><a href="#get_fixed_scheme-515"><span class="linenos">515</span></a><span class="sd">              (1.0, -1.0, 0.0),</span>
</span><span id="get_fixed_scheme-516"><a href="#get_fixed_scheme-516"><span class="linenos">516</span></a><span class="sd">              (0.0, 1.0, 0.0)))</span>
</span><span id="get_fixed_scheme-517"><a href="#get_fixed_scheme-517"><span class="linenos">517</span></a><span class="sd">    &gt;&gt;&gt; k</span>
</span><span id="get_fixed_scheme-518"><a href="#get_fixed_scheme-518"><span class="linenos">518</span></a><span class="sd">    array([5.56e+01, 1.00e+02, 2.00e-06])</span>
</span><span id="get_fixed_scheme-519"><a href="#get_fixed_scheme-519"><span class="linenos">519</span></a>
</span><span id="get_fixed_scheme-520"><a href="#get_fixed_scheme-520"><span class="linenos">520</span></a><span class="sd">    This function is a no-op if `fixed_y0` is empty, which is very important</span>
</span><span id="get_fixed_scheme-521"><a href="#get_fixed_scheme-521"><span class="linenos">521</span></a><span class="sd">    for overall code consistency:</span>
</span><span id="get_fixed_scheme-522"><a href="#get_fixed_scheme-522"><span class="linenos">522</span></a>
</span><span id="get_fixed_scheme-523"><a href="#get_fixed_scheme-523"><span class="linenos">523</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions([&quot;AH &lt;=&gt; A- + H+&quot;, &quot;B- + H+ &lt;=&gt; BH&quot;])</span>
</span><span id="get_fixed_scheme-524"><a href="#get_fixed_scheme-524"><span class="linenos">524</span></a><span class="sd">    &gt;&gt;&gt; k = np.array([1, 1, 2, 2])</span>
</span><span id="get_fixed_scheme-525"><a href="#get_fixed_scheme-525"><span class="linenos">525</span></a><span class="sd">    &gt;&gt;&gt; new_scheme, new_k = rx.get_fixed_scheme(scheme, k, {})</span>
</span><span id="get_fixed_scheme-526"><a href="#get_fixed_scheme-526"><span class="linenos">526</span></a><span class="sd">    &gt;&gt;&gt; new_scheme == scheme</span>
</span><span id="get_fixed_scheme-527"><a href="#get_fixed_scheme-527"><span class="linenos">527</span></a><span class="sd">    True</span>
</span><span id="get_fixed_scheme-528"><a href="#get_fixed_scheme-528"><span class="linenos">528</span></a><span class="sd">    &gt;&gt;&gt; np.allclose(new_k, k)</span>
</span><span id="get_fixed_scheme-529"><a href="#get_fixed_scheme-529"><span class="linenos">529</span></a><span class="sd">    True</span>
</span><span id="get_fixed_scheme-530"><a href="#get_fixed_scheme-530"><span class="linenos">530</span></a>
</span><span id="get_fixed_scheme-531"><a href="#get_fixed_scheme-531"><span class="linenos">531</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_fixed_scheme-532"><a href="#get_fixed_scheme-532"><span class="linenos">532</span></a>    <span class="n">new_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="get_fixed_scheme-533"><a href="#get_fixed_scheme-533"><span class="linenos">533</span></a>    <span class="n">new_reactions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_fixed_scheme-534"><a href="#get_fixed_scheme-534"><span class="linenos">534</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
</span><span id="get_fixed_scheme-535"><a href="#get_fixed_scheme-535"><span class="linenos">535</span></a>        <span class="nb">zip</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">reactions</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">)</span>
</span><span id="get_fixed_scheme-536"><a href="#get_fixed_scheme-536"><span class="linenos">536</span></a>    <span class="p">):</span>
</span><span id="get_fixed_scheme-537"><a href="#get_fixed_scheme-537"><span class="linenos">537</span></a>        <span class="k">for</span> <span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_parse_reactions</span><span class="p">(</span><span class="n">reaction</span><span class="p">):</span>
</span><span id="get_fixed_scheme-538"><a href="#get_fixed_scheme-538"><span class="linenos">538</span></a>            <span class="n">new_reactants</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="get_fixed_scheme-539"><a href="#get_fixed_scheme-539"><span class="linenos">539</span></a>                <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">compound</span><span class="p">)</span>
</span><span id="get_fixed_scheme-540"><a href="#get_fixed_scheme-540"><span class="linenos">540</span></a>                <span class="k">for</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">compound</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reactants</span>
</span><span id="get_fixed_scheme-541"><a href="#get_fixed_scheme-541"><span class="linenos">541</span></a>                <span class="k">if</span> <span class="n">compound</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fixed_y0</span>
</span><span id="get_fixed_scheme-542"><a href="#get_fixed_scheme-542"><span class="linenos">542</span></a>            <span class="p">)</span>
</span><span id="get_fixed_scheme-543"><a href="#get_fixed_scheme-543"><span class="linenos">543</span></a>            <span class="n">new_products</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="get_fixed_scheme-544"><a href="#get_fixed_scheme-544"><span class="linenos">544</span></a>                <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">compound</span><span class="p">)</span>
</span><span id="get_fixed_scheme-545"><a href="#get_fixed_scheme-545"><span class="linenos">545</span></a>                <span class="k">for</span> <span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">compound</span><span class="p">)</span> <span class="ow">in</span> <span class="n">products</span>
</span><span id="get_fixed_scheme-546"><a href="#get_fixed_scheme-546"><span class="linenos">546</span></a>                <span class="k">if</span> <span class="n">compound</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fixed_y0</span>
</span><span id="get_fixed_scheme-547"><a href="#get_fixed_scheme-547"><span class="linenos">547</span></a>            <span class="p">)</span>
</span><span id="get_fixed_scheme-548"><a href="#get_fixed_scheme-548"><span class="linenos">548</span></a>
</span><span id="get_fixed_scheme-549"><a href="#get_fixed_scheme-549"><span class="linenos">549</span></a>            <span class="k">for</span> <span class="n">fixed_compound</span> <span class="ow">in</span> <span class="n">fixed_y0</span><span class="p">:</span>
</span><span id="get_fixed_scheme-550"><a href="#get_fixed_scheme-550"><span class="linenos">550</span></a>                <span class="k">for</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">compound</span> <span class="ow">in</span> <span class="n">reactants</span><span class="p">:</span>
</span><span id="get_fixed_scheme-551"><a href="#get_fixed_scheme-551"><span class="linenos">551</span></a>                    <span class="k">if</span> <span class="n">fixed_compound</span> <span class="o">==</span> <span class="n">compound</span><span class="p">:</span>
</span><span id="get_fixed_scheme-552"><a href="#get_fixed_scheme-552"><span class="linenos">552</span></a>                        <span class="n">new_k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">fixed_y0</span><span class="p">[</span><span class="n">fixed_compound</span><span class="p">]</span> <span class="o">**</span> <span class="n">coeff</span>
</span><span id="get_fixed_scheme-553"><a href="#get_fixed_scheme-553"><span class="linenos">553</span></a>
</span><span id="get_fixed_scheme-554"><a href="#get_fixed_scheme-554"><span class="linenos">554</span></a>            <span class="n">new_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">new_reactants</span><span class="p">,</span> <span class="n">new_products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">))</span>
</span><span id="get_fixed_scheme-555"><a href="#get_fixed_scheme-555"><span class="linenos">555</span></a>
</span><span id="get_fixed_scheme-556"><a href="#get_fixed_scheme-556"><span class="linenos">556</span></a>    <span class="n">new_reactions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_unparse_reactions</span><span class="p">(</span><span class="n">new_reactions</span><span class="p">))</span>
</span><span id="get_fixed_scheme-557"><a href="#get_fixed_scheme-557"><span class="linenos">557</span></a>    <span class="n">new_is_half_equilibrium</span> <span class="o">=</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span>
</span><span id="get_fixed_scheme-558"><a href="#get_fixed_scheme-558"><span class="linenos">558</span></a>
</span><span id="get_fixed_scheme-559"><a href="#get_fixed_scheme-559"><span class="linenos">559</span></a>    <span class="n">new_A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_fixed_scheme-560"><a href="#get_fixed_scheme-560"><span class="linenos">560</span></a>    <span class="n">new_B</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_fixed_scheme-561"><a href="#get_fixed_scheme-561"><span class="linenos">561</span></a>    <span class="n">new_compounds</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_fixed_scheme-562"><a href="#get_fixed_scheme-562"><span class="linenos">562</span></a>    <span class="k">for</span> <span class="n">compound</span><span class="p">,</span> <span class="n">row_A</span><span class="p">,</span> <span class="n">row_B</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_fixed_scheme-563"><a href="#get_fixed_scheme-563"><span class="linenos">563</span></a>        <span class="n">scheme</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">B</span>
</span><span id="get_fixed_scheme-564"><a href="#get_fixed_scheme-564"><span class="linenos">564</span></a>    <span class="p">):</span>  <span class="c1"># noqa: RUF100</span>
</span><span id="get_fixed_scheme-565"><a href="#get_fixed_scheme-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">compound</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fixed_y0</span><span class="p">:</span>
</span><span id="get_fixed_scheme-566"><a href="#get_fixed_scheme-566"><span class="linenos">566</span></a>            <span class="n">new_compounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compound</span><span class="p">)</span>
</span><span id="get_fixed_scheme-567"><a href="#get_fixed_scheme-567"><span class="linenos">567</span></a>            <span class="n">new_A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_A</span><span class="p">)</span>
</span><span id="get_fixed_scheme-568"><a href="#get_fixed_scheme-568"><span class="linenos">568</span></a>            <span class="n">new_B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_B</span><span class="p">)</span>
</span><span id="get_fixed_scheme-569"><a href="#get_fixed_scheme-569"><span class="linenos">569</span></a>
</span><span id="get_fixed_scheme-570"><a href="#get_fixed_scheme-570"><span class="linenos">570</span></a>    <span class="n">new_compounds</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_compounds</span><span class="p">)</span>
</span><span id="get_fixed_scheme-571"><a href="#get_fixed_scheme-571"><span class="linenos">571</span></a>    <span class="n">new_A</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_A</span><span class="p">)</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_fixed_scheme-572"><a href="#get_fixed_scheme-572"><span class="linenos">572</span></a>    <span class="n">new_B</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_B</span><span class="p">)</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_fixed_scheme-573"><a href="#get_fixed_scheme-573"><span class="linenos">573</span></a>
</span><span id="get_fixed_scheme-574"><a href="#get_fixed_scheme-574"><span class="linenos">574</span></a>    <span class="k">return</span> <span class="p">(</span>
</span><span id="get_fixed_scheme-575"><a href="#get_fixed_scheme-575"><span class="linenos">575</span></a>        <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Scheme</span><span class="p">(</span>
</span><span id="get_fixed_scheme-576"><a href="#get_fixed_scheme-576"><span class="linenos">576</span></a>            <span class="n">compounds</span><span class="o">=</span><span class="n">new_compounds</span><span class="p">,</span>
</span><span id="get_fixed_scheme-577"><a href="#get_fixed_scheme-577"><span class="linenos">577</span></a>            <span class="n">reactions</span><span class="o">=</span><span class="n">new_reactions</span><span class="p">,</span>
</span><span id="get_fixed_scheme-578"><a href="#get_fixed_scheme-578"><span class="linenos">578</span></a>            <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="n">new_is_half_equilibrium</span><span class="p">,</span>
</span><span id="get_fixed_scheme-579"><a href="#get_fixed_scheme-579"><span class="linenos">579</span></a>            <span class="n">A</span><span class="o">=</span><span class="n">new_A</span><span class="p">,</span>
</span><span id="get_fixed_scheme-580"><a href="#get_fixed_scheme-580"><span class="linenos">580</span></a>            <span class="n">B</span><span class="o">=</span><span class="n">new_B</span><span class="p">,</span>
</span><span id="get_fixed_scheme-581"><a href="#get_fixed_scheme-581"><span class="linenos">581</span></a>        <span class="p">),</span>
</span><span id="get_fixed_scheme-582"><a href="#get_fixed_scheme-582"><span class="linenos">582</span></a>        <span class="n">new_k</span><span class="p">,</span>
</span><span id="get_fixed_scheme-583"><a href="#get_fixed_scheme-583"><span class="linenos">583</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate an alternative scheme with some concentrations fixed.</p>

<p>This function returns data that allow the microkinetic simulation of a
reaction network under constraints, namely when some compounds have fixed
concentrations. This works by 1. removing all references to the fixed
compounds and by 2. properly multiplying the reaction rate constants by
the respective concentrations.</p>

<h2 id="parameters">Parameters</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.
    Mostly likely, this comes from a parsed model input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
k : array-like
    Reaction rate constant(s). Units match the concentration units given to
    the returned function <code>dydt</code>.
fixed_y0 : dict-like
    Fixed initial state. Units match the concentration units given to
    the returned function <code>dydt</code>.</p>

<h2 id="returns">Returns</h2>

<p>scheme : Scheme
    Associated reaction scheme with all references to fixed compounds
    removed.
k : array-like
    Associated (effective) reaction rate constants that model the fixed
    concentrations.</p>

<h2 id="notes">Notes</h2>

<p>Keep in mind that when a compound get its concentration fixed, the
reaction scheme no longer conserves matter. You can think of it as
reacting close to an infinite source of the compound, but it accumulates
in the milleu at the given concentration.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
</code></pre>
</div>

<p>Equilibria under a specific pH can be easily modeled:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pH</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;AH &lt;=&gt; A- + H+&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;H+&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**-</span><span class="n">pH</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span>
<span class="go">Scheme(compounds=(&#39;AH&#39;, &#39;A-&#39;),</span>
<span class="go">       reactions=(&#39;AH -&gt; A-&#39;,</span>
<span class="go">                  &#39;A- -&gt; AH&#39;),</span>
<span class="go">       is_half_equilibrium=(True, True),</span>
<span class="go">       A=((-1.0, 1.0),</span>
<span class="go">          (1.0, -1.0)),</span>
<span class="go">       B=((-1.0, 0.0),</span>
<span class="go">          (1.0, 0.0)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span>
<span class="go">array([1.e+00, 1.e-07])</span>
</code></pre>
</div>

<p>It is also possible to model the fixed activity of a solvent, for
instance:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A + 2H2O -&gt; B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="mf">55.6</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((-1.0,),</span>
<span class="go">          (1.0,)),</span>
<span class="go">       B=((-1.0,),</span>
<span class="go">          (1.0,)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span>
<span class="go">array([3091.36])</span>
</code></pre>
</div>

<p>Multiple reactions work fine, see both examples below:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pH</span> <span class="o">=</span> <span class="mi">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;B &lt;- AH &lt;=&gt; A- + H+&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;H+&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**-</span><span class="n">pH</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span>
<span class="go">Scheme(compounds=(&#39;AH&#39;, &#39;B&#39;, &#39;A-&#39;),</span>
<span class="go">       reactions=(&#39;AH -&gt; B&#39;,</span>
<span class="go">                  &#39;AH -&gt; A-&#39;,</span>
<span class="go">                  &#39;A- -&gt; AH&#39;),</span>
<span class="go">       is_half_equilibrium=(False, True, True),</span>
<span class="go">       A=((-1.0, -1.0, 1.0),</span>
<span class="go">          (1.0, 0.0, 0.0),</span>
<span class="go">          (0.0, 1.0, -1.0)),</span>
<span class="go">       B=((-1.0, -1.0, 0.0),</span>
<span class="go">          (1.0, 0.0, 0.0),</span>
<span class="go">          (0.0, 1.0, 0.0)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span>
<span class="go">array([1.e+01, 1.e+00, 1.e-12])</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pH</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">([</span><span class="s2">&quot;AH &lt;=&gt; A- + H+&quot;</span><span class="p">,</span> <span class="s2">&quot;B- + H+ &lt;=&gt; BH&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;H+&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**-</span><span class="n">pH</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span>
<span class="go">Scheme(compounds=(&#39;AH&#39;, &#39;A-&#39;, &#39;B-&#39;, &#39;BH&#39;),</span>
<span class="go">       reactions=(&#39;AH -&gt; A-&#39;,</span>
<span class="go">                  &#39;A- -&gt; AH&#39;,</span>
<span class="go">                  &#39;B- -&gt; BH&#39;,</span>
<span class="go">                  &#39;BH -&gt; B-&#39;),</span>
<span class="go">       is_half_equilibrium=(True, True, True, True),</span>
<span class="go">       A=((-1.0, 1.0, 0.0, 0.0),</span>
<span class="go">          (1.0, -1.0, 0.0, 0.0),</span>
<span class="go">          (0.0, 0.0, -1.0, 1.0),</span>
<span class="go">          (0.0, 0.0, 1.0, -1.0)),</span>
<span class="go">       B=((-1.0, 0.0, 0.0, 0.0),</span>
<span class="go">          (1.0, 0.0, 0.0, 0.0),</span>
<span class="go">          (0.0, 0.0, -1.0, 0.0),</span>
<span class="go">          (0.0, 0.0, 1.0, 0.0)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span>
<span class="go">array([1. , 0.01, 0.02, 2. ])</span>
</code></pre>
</div>

<p>Multiple fixed compounds also work fine:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">pH</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A + H2O -&gt; B &lt;=&gt; B- + H+&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;H+&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="o">**-</span><span class="n">pH</span><span class="p">,</span> <span class="s2">&quot;H2O&quot;</span><span class="p">:</span> <span class="mf">55.6</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;B&#39;, &#39;B-&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;,</span>
<span class="go">                  &#39;B -&gt; B-&#39;,</span>
<span class="go">                  &#39;B- -&gt; B&#39;),</span>
<span class="go">       is_half_equilibrium=(False, True, True),</span>
<span class="go">       A=((-1.0, 0.0, 0.0),</span>
<span class="go">          (1.0, -1.0, 1.0),</span>
<span class="go">          (0.0, 1.0, -1.0)),</span>
<span class="go">       B=((-1.0, 0.0, 0.0),</span>
<span class="go">          (1.0, -1.0, 0.0),</span>
<span class="go">          (0.0, 1.0, 0.0)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span>
<span class="go">array([5.56e+01, 1.00e+02, 2.00e-06])</span>
</code></pre>
</div>

<p>This function is a no-op if <code>fixed_y0</code> is empty, which is very important
for overall code consistency:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">([</span><span class="s2">&quot;AH &lt;=&gt; A- + H+&quot;</span><span class="p">,</span> <span class="s2">&quot;B- + H+ &lt;=&gt; BH&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_scheme</span><span class="p">,</span> <span class="n">new_k</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_fixed_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">{})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_scheme</span> <span class="o">==</span> <span class="n">scheme</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">new_k</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_freeenergies">
                            <input id="get_freeenergies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_freeenergies</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span>,</span><span class="param">	<span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;standard&#39;</span>,</span><span class="param">	<span class="n">qrrho</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span>,</span><span class="param">	<span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_freeenergies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_freeenergies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_freeenergies-316"><a href="#get_freeenergies-316"><span class="linenos">316</span></a><span class="k">def</span> <span class="nf">get_freeenergies</span><span class="p">(</span>
</span><span id="get_freeenergies-317"><a href="#get_freeenergies-317"><span class="linenos">317</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="get_freeenergies-318"><a href="#get_freeenergies-318"><span class="linenos">318</span></a>    <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="get_freeenergies-319"><a href="#get_freeenergies-319"><span class="linenos">319</span></a>    <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="get_freeenergies-320"><a href="#get_freeenergies-320"><span class="linenos">320</span></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span><span class="p">,</span>
</span><span id="get_freeenergies-321"><a href="#get_freeenergies-321"><span class="linenos">321</span></a>    <span class="n">qrrho</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT002, UP007</span>
</span><span id="get_freeenergies-322"><a href="#get_freeenergies-322"><span class="linenos">322</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>
</span><span id="get_freeenergies-323"><a href="#get_freeenergies-323"><span class="linenos">323</span></a>    <span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">atm</span><span class="p">,</span>
</span><span id="get_freeenergies-324"><a href="#get_freeenergies-324"><span class="linenos">324</span></a><span class="p">):</span>
</span><span id="get_freeenergies-325"><a href="#get_freeenergies-325"><span class="linenos">325</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain free energies for compounds at a given temperature and pressure.</span>
</span><span id="get_freeenergies-326"><a href="#get_freeenergies-326"><span class="linenos">326</span></a>
</span><span id="get_freeenergies-327"><a href="#get_freeenergies-327"><span class="linenos">327</span></a><span class="sd">    Parameters</span>
</span><span id="get_freeenergies-328"><a href="#get_freeenergies-328"><span class="linenos">328</span></a><span class="sd">    ----------</span>
</span><span id="get_freeenergies-329"><a href="#get_freeenergies-329"><span class="linenos">329</span></a><span class="sd">    compounds : dict-like</span>
</span><span id="get_freeenergies-330"><a href="#get_freeenergies-330"><span class="linenos">330</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_freeenergies-331"><a href="#get_freeenergies-331"><span class="linenos">331</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_freeenergies-332"><a href="#get_freeenergies-332"><span class="linenos">332</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_freeenergies-333"><a href="#get_freeenergies-333"><span class="linenos">333</span></a><span class="sd">    bias : array-like, optional</span>
</span><span id="get_freeenergies-334"><a href="#get_freeenergies-334"><span class="linenos">334</span></a><span class="sd">        Energy to be added to free energies.</span>
</span><span id="get_freeenergies-335"><a href="#get_freeenergies-335"><span class="linenos">335</span></a><span class="sd">    environment : str or None, optional</span>
</span><span id="get_freeenergies-336"><a href="#get_freeenergies-336"><span class="linenos">336</span></a><span class="sd">        Choose between &quot;gas&quot; and a solvent. This is chosen for you by default,</span>
</span><span id="get_freeenergies-337"><a href="#get_freeenergies-337"><span class="linenos">337</span></a><span class="sd">        based on the names of each compound. If given, all compounds will</span>
</span><span id="get_freeenergies-338"><a href="#get_freeenergies-338"><span class="linenos">338</span></a><span class="sd">        have the same behavior.</span>
</span><span id="get_freeenergies-339"><a href="#get_freeenergies-339"><span class="linenos">339</span></a><span class="sd">    method : str, optional</span>
</span><span id="get_freeenergies-340"><a href="#get_freeenergies-340"><span class="linenos">340</span></a><span class="sd">        This is a placeholder for future functionality.</span>
</span><span id="get_freeenergies-341"><a href="#get_freeenergies-341"><span class="linenos">341</span></a><span class="sd">        There are plans to implement more sophisticated methods for calculating</span>
</span><span id="get_freeenergies-342"><a href="#get_freeenergies-342"><span class="linenos">342</span></a><span class="sd">        entropies such as in</span>
</span><span id="get_freeenergies-343"><a href="#get_freeenergies-343"><span class="linenos">343</span></a><span class="sd">        [*Phys. Chem. Chem. Phys.*, **2019**, 21, 18920-18929](https://doi.org/10.1039/C9CP03226F)</span>
</span><span id="get_freeenergies-344"><a href="#get_freeenergies-344"><span class="linenos">344</span></a><span class="sd">        and</span>
</span><span id="get_freeenergies-345"><a href="#get_freeenergies-345"><span class="linenos">345</span></a><span class="sd">        [*J. Chem. Theory Comput.* **2019**, 15, 5, 3204-3214](https://doi.org/10.1021/acs.jctc.9b00214).</span>
</span><span id="get_freeenergies-346"><a href="#get_freeenergies-346"><span class="linenos">346</span></a><span class="sd">        Head over to the</span>
</span><span id="get_freeenergies-347"><a href="#get_freeenergies-347"><span class="linenos">347</span></a><span class="sd">        [discussions](https://github.com/geem-lab/overreact/discussions) if</span>
</span><span id="get_freeenergies-348"><a href="#get_freeenergies-348"><span class="linenos">348</span></a><span class="sd">        you&#39;re interested and would like to contribute.</span>
</span><span id="get_freeenergies-349"><a href="#get_freeenergies-349"><span class="linenos">349</span></a><span class="sd">        Leave this as &quot;standard&quot; for now.</span>
</span><span id="get_freeenergies-350"><a href="#get_freeenergies-350"><span class="linenos">350</span></a><span class="sd">    qrrho : bool or tuple-like, optional</span>
</span><span id="get_freeenergies-351"><a href="#get_freeenergies-351"><span class="linenos">351</span></a><span class="sd">        Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)</span>
</span><span id="get_freeenergies-352"><a href="#get_freeenergies-352"><span class="linenos">352</span></a><span class="sd">        approximations of M. Head-Gordon and others (enthalpy correction, see</span>
</span><span id="get_freeenergies-353"><a href="#get_freeenergies-353"><span class="linenos">353</span></a><span class="sd">        [*J. Phys. Chem. C* **2015**, 119, 4, 1840-1850](http://dx.doi.org/10.1021/jp509921r))</span>
</span><span id="get_freeenergies-354"><a href="#get_freeenergies-354"><span class="linenos">354</span></a><span class="sd">        and S. Grimme (entropy correction, see</span>
</span><span id="get_freeenergies-355"><a href="#get_freeenergies-355"><span class="linenos">355</span></a><span class="sd">        [*Theory. Chem. Eur. J.*, **2012**, 18: 9955-9964](https://doi.org/10.1002/chem.201200497))</span>
</span><span id="get_freeenergies-356"><a href="#get_freeenergies-356"><span class="linenos">356</span></a><span class="sd">        on top of the classical RRHO.</span>
</span><span id="get_freeenergies-357"><a href="#get_freeenergies-357"><span class="linenos">357</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_freeenergies-358"><a href="#get_freeenergies-358"><span class="linenos">358</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_freeenergies-359"><a href="#get_freeenergies-359"><span class="linenos">359</span></a><span class="sd">    pressure : array-like, optional</span>
</span><span id="get_freeenergies-360"><a href="#get_freeenergies-360"><span class="linenos">360</span></a><span class="sd">        Reference gas pressure.</span>
</span><span id="get_freeenergies-361"><a href="#get_freeenergies-361"><span class="linenos">361</span></a>
</span><span id="get_freeenergies-362"><a href="#get_freeenergies-362"><span class="linenos">362</span></a><span class="sd">    Returns</span>
</span><span id="get_freeenergies-363"><a href="#get_freeenergies-363"><span class="linenos">363</span></a><span class="sd">    -------</span>
</span><span id="get_freeenergies-364"><a href="#get_freeenergies-364"><span class="linenos">364</span></a><span class="sd">    array-like</span>
</span><span id="get_freeenergies-365"><a href="#get_freeenergies-365"><span class="linenos">365</span></a>
</span><span id="get_freeenergies-366"><a href="#get_freeenergies-366"><span class="linenos">366</span></a><span class="sd">    Examples</span>
</span><span id="get_freeenergies-367"><a href="#get_freeenergies-367"><span class="linenos">367</span></a><span class="sd">    --------</span>
</span><span id="get_freeenergies-368"><a href="#get_freeenergies-368"><span class="linenos">368</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_freeenergies-369"><a href="#get_freeenergies-369"><span class="linenos">369</span></a><span class="sd">    &gt;&gt;&gt; from overreact import _constants as constants</span>
</span><span id="get_freeenergies-370"><a href="#get_freeenergies-370"><span class="linenos">370</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/ethane/B97-3c/model.k&quot;)</span>
</span><span id="get_freeenergies-371"><a href="#get_freeenergies-371"><span class="linenos">371</span></a><span class="sd">    &gt;&gt;&gt; freeenergies = get_freeenergies(model.compounds, qrrho=(False, True))</span>
</span><span id="get_freeenergies-372"><a href="#get_freeenergies-372"><span class="linenos">372</span></a><span class="sd">    &gt;&gt;&gt; (freeenergies - freeenergies.min()) / constants.kcal</span>
</span><span id="get_freeenergies-373"><a href="#get_freeenergies-373"><span class="linenos">373</span></a><span class="sd">    array([0. , 2.62281461])</span>
</span><span id="get_freeenergies-374"><a href="#get_freeenergies-374"><span class="linenos">374</span></a><span class="sd">    &gt;&gt;&gt; freeenergies = get_freeenergies(model.compounds)</span>
</span><span id="get_freeenergies-375"><a href="#get_freeenergies-375"><span class="linenos">375</span></a><span class="sd">    &gt;&gt;&gt; (freeenergies - freeenergies.min()) / constants.kcal</span>
</span><span id="get_freeenergies-376"><a href="#get_freeenergies-376"><span class="linenos">376</span></a><span class="sd">    array([0. , 2.62862818])</span>
</span><span id="get_freeenergies-377"><a href="#get_freeenergies-377"><span class="linenos">377</span></a>
</span><span id="get_freeenergies-378"><a href="#get_freeenergies-378"><span class="linenos">378</span></a><span class="sd">    You can consider all compounds as solvated if you want:</span>
</span><span id="get_freeenergies-379"><a href="#get_freeenergies-379"><span class="linenos">379</span></a>
</span><span id="get_freeenergies-380"><a href="#get_freeenergies-380"><span class="linenos">380</span></a><span class="sd">    &gt;&gt;&gt; sol_freeenergies = get_freeenergies(model.compounds, environment=&quot;solvent&quot;)</span>
</span><span id="get_freeenergies-381"><a href="#get_freeenergies-381"><span class="linenos">381</span></a><span class="sd">    &gt;&gt;&gt; (sol_freeenergies - freeenergies) / constants.kcal</span>
</span><span id="get_freeenergies-382"><a href="#get_freeenergies-382"><span class="linenos">382</span></a><span class="sd">    array([1.89432845, 1.89432845])</span>
</span><span id="get_freeenergies-383"><a href="#get_freeenergies-383"><span class="linenos">383</span></a>
</span><span id="get_freeenergies-384"><a href="#get_freeenergies-384"><span class="linenos">384</span></a><span class="sd">    You can set a simple energy bias, either as a constant or compound-wise:</span>
</span><span id="get_freeenergies-385"><a href="#get_freeenergies-385"><span class="linenos">385</span></a>
</span><span id="get_freeenergies-386"><a href="#get_freeenergies-386"><span class="linenos">386</span></a><span class="sd">    &gt;&gt;&gt; get_freeenergies(model.compounds, bias=1.0) - freeenergies</span>
</span><span id="get_freeenergies-387"><a href="#get_freeenergies-387"><span class="linenos">387</span></a><span class="sd">    array([1., 1.])</span>
</span><span id="get_freeenergies-388"><a href="#get_freeenergies-388"><span class="linenos">388</span></a><span class="sd">    &gt;&gt;&gt; get_freeenergies(model.compounds, bias=-1.0) - freeenergies</span>
</span><span id="get_freeenergies-389"><a href="#get_freeenergies-389"><span class="linenos">389</span></a><span class="sd">    array([-1., -1.])</span>
</span><span id="get_freeenergies-390"><a href="#get_freeenergies-390"><span class="linenos">390</span></a><span class="sd">    &gt;&gt;&gt; get_freeenergies(model.compounds, bias=[1.0, -1.0]) - freeenergies</span>
</span><span id="get_freeenergies-391"><a href="#get_freeenergies-391"><span class="linenos">391</span></a><span class="sd">    array([ 1., -1.])</span>
</span><span id="get_freeenergies-392"><a href="#get_freeenergies-392"><span class="linenos">392</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_freeenergies-393"><a href="#get_freeenergies-393"><span class="linenos">393</span></a>    <span class="n">qrrho_enthalpy</span><span class="p">,</span> <span class="n">qrrho_entropy</span> <span class="o">=</span> <span class="n">_check_qrrho</span><span class="p">(</span><span class="n">qrrho</span><span class="p">)</span>
</span><span id="get_freeenergies-394"><a href="#get_freeenergies-394"><span class="linenos">394</span></a>    <span class="n">enthalpies</span> <span class="o">=</span> <span class="n">get_enthalpies</span><span class="p">(</span>
</span><span id="get_freeenergies-395"><a href="#get_freeenergies-395"><span class="linenos">395</span></a>        <span class="n">compounds</span><span class="p">,</span> <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho_enthalpy</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span>
</span><span id="get_freeenergies-396"><a href="#get_freeenergies-396"><span class="linenos">396</span></a>    <span class="p">)</span>
</span><span id="get_freeenergies-397"><a href="#get_freeenergies-397"><span class="linenos">397</span></a>    <span class="n">entropies</span> <span class="o">=</span> <span class="n">get_entropies</span><span class="p">(</span>
</span><span id="get_freeenergies-398"><a href="#get_freeenergies-398"><span class="linenos">398</span></a>        <span class="n">compounds</span><span class="p">,</span>
</span><span id="get_freeenergies-399"><a href="#get_freeenergies-399"><span class="linenos">399</span></a>        <span class="n">environment</span><span class="o">=</span><span class="n">environment</span><span class="p">,</span>
</span><span id="get_freeenergies-400"><a href="#get_freeenergies-400"><span class="linenos">400</span></a>        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="get_freeenergies-401"><a href="#get_freeenergies-401"><span class="linenos">401</span></a>        <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho_entropy</span><span class="p">,</span>
</span><span id="get_freeenergies-402"><a href="#get_freeenergies-402"><span class="linenos">402</span></a>        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_freeenergies-403"><a href="#get_freeenergies-403"><span class="linenos">403</span></a>        <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_freeenergies-404"><a href="#get_freeenergies-404"><span class="linenos">404</span></a>    <span class="p">)</span>
</span><span id="get_freeenergies-405"><a href="#get_freeenergies-405"><span class="linenos">405</span></a>    <span class="c1"># TODO(schneiderfelipe): log the contribution of bias</span>
</span><span id="get_freeenergies-406"><a href="#get_freeenergies-406"><span class="linenos">406</span></a>    <span class="k">return</span> <span class="n">enthalpies</span> <span class="o">-</span> <span class="n">temperature</span> <span class="o">*</span> <span class="n">entropies</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bias</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Obtain free energies for compounds at a given temperature and pressure.</p>

<h2 id="parameters">Parameters</h2>

<p>compounds : dict-like
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
bias : array-like, optional
    Energy to be added to free energies.
environment : str or None, optional
    Choose between "gas" and a solvent. This is chosen for you by default,
    based on the names of each compound. If given, all compounds will
    have the same behavior.
method : str, optional
    This is a placeholder for future functionality.
    There are plans to implement more sophisticated methods for calculating
    entropies such as in
    <a href="https://doi.org/10.1039/C9CP03226F"><em>Phys. Chem. Chem. Phys.</em>, <strong>2019</strong>, 21, 18920-18929</a>
    and
    <a href="https://doi.org/10.1021/acs.jctc.9b00214"><em>J. Chem. Theory Comput.</em> <strong>2019</strong>, 15, 5, 3204-3214</a>.
    Head over to the
    <a href="https://github.com/geem-lab/overreact/discussions">discussions</a> if
    you're interested and would like to contribute.
    Leave this as "standard" for now.
qrrho : bool or tuple-like, optional
    Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)
    approximations of M. Head-Gordon and others (enthalpy correction, see
    <a href="http://dx.doi.org/10.1021/jp509921r"><em>J. Phys. Chem. C</em> <strong>2015</strong>, 119, 4, 1840-1850</a>)
    and S. Grimme (entropy correction, see
    <a href="https://doi.org/10.1002/chem.201200497"><em>Theory. Chem. Eur. J.</em>, <strong>2012</strong>, 18: 9955-9964</a>)
    on top of the classical RRHO.
temperature : array-like, optional
    Absolute temperature in Kelvin.
pressure : array-like, optional
    Reference gas pressure.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overreact</span> <span class="kn">import</span> <span class="n">_constants</span> <span class="k">as</span> <span class="n">constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freeenergies</span> <span class="o">=</span> <span class="n">get_freeenergies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">qrrho</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">freeenergies</span> <span class="o">-</span> <span class="n">freeenergies</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">array([0. , 2.62281461])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freeenergies</span> <span class="o">=</span> <span class="n">get_freeenergies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">freeenergies</span> <span class="o">-</span> <span class="n">freeenergies</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">array([0. , 2.62862818])</span>
</code></pre>
</div>

<p>You can consider all compounds as solvated if you want:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">sol_freeenergies</span> <span class="o">=</span> <span class="n">get_freeenergies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="s2">&quot;solvent&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">sol_freeenergies</span> <span class="o">-</span> <span class="n">freeenergies</span><span class="p">)</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">array([1.89432845, 1.89432845])</span>
</code></pre>
</div>

<p>You can set a simple energy bias, either as a constant or compound-wise:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_freeenergies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">freeenergies</span>
<span class="go">array([1., 1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_freeenergies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">bias</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-</span> <span class="n">freeenergies</span>
<span class="go">array([-1., -1.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_freeenergies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span> <span class="o">-</span> <span class="n">freeenergies</span>
<span class="go">array([ 1., -1.])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_internal_energies">
                            <input id="get_internal_energies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_internal_energies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span>, </span><span class="param"><span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>, </span><span class="param"><span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_internal_energies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_internal_energies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_internal_energies-39"><a href="#get_internal_energies-39"><span class="linenos">39</span></a><span class="k">def</span> <span class="nf">get_internal_energies</span><span class="p">(</span>
</span><span id="get_internal_energies-40"><a href="#get_internal_energies-40"><span class="linenos">40</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="get_internal_energies-41"><a href="#get_internal_energies-41"><span class="linenos">41</span></a>    <span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT001, FBT002</span>
</span><span id="get_internal_energies-42"><a href="#get_internal_energies-42"><span class="linenos">42</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>  <span class="c1"># noqa: RUF100</span>
</span><span id="get_internal_energies-43"><a href="#get_internal_energies-43"><span class="linenos">43</span></a><span class="p">):</span>
</span><span id="get_internal_energies-44"><a href="#get_internal_energies-44"><span class="linenos">44</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtain internal energies for compounds at a given temperature.</span>
</span><span id="get_internal_energies-45"><a href="#get_internal_energies-45"><span class="linenos">45</span></a>
</span><span id="get_internal_energies-46"><a href="#get_internal_energies-46"><span class="linenos">46</span></a><span class="sd">    Parameters</span>
</span><span id="get_internal_energies-47"><a href="#get_internal_energies-47"><span class="linenos">47</span></a><span class="sd">    ----------</span>
</span><span id="get_internal_energies-48"><a href="#get_internal_energies-48"><span class="linenos">48</span></a><span class="sd">    compounds : dict-like</span>
</span><span id="get_internal_energies-49"><a href="#get_internal_energies-49"><span class="linenos">49</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_internal_energies-50"><a href="#get_internal_energies-50"><span class="linenos">50</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_internal_energies-51"><a href="#get_internal_energies-51"><span class="linenos">51</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_internal_energies-52"><a href="#get_internal_energies-52"><span class="linenos">52</span></a><span class="sd">    qrrho : bool, optional</span>
</span><span id="get_internal_energies-53"><a href="#get_internal_energies-53"><span class="linenos">53</span></a><span class="sd">        Apply the quasi-rigid rotor harmonic oscillator (QRRHO) approximation of</span>
</span><span id="get_internal_energies-54"><a href="#get_internal_energies-54"><span class="linenos">54</span></a><span class="sd">        M. Head-Gordon and others (see</span>
</span><span id="get_internal_energies-55"><a href="#get_internal_energies-55"><span class="linenos">55</span></a><span class="sd">        [*J. Phys. Chem. C* **2015**, 119, 4, 1840-1850](http://dx.doi.org/10.1021/jp509921r))</span>
</span><span id="get_internal_energies-56"><a href="#get_internal_energies-56"><span class="linenos">56</span></a><span class="sd">        on top of the classical RRHO.</span>
</span><span id="get_internal_energies-57"><a href="#get_internal_energies-57"><span class="linenos">57</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_internal_energies-58"><a href="#get_internal_energies-58"><span class="linenos">58</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_internal_energies-59"><a href="#get_internal_energies-59"><span class="linenos">59</span></a>
</span><span id="get_internal_energies-60"><a href="#get_internal_energies-60"><span class="linenos">60</span></a><span class="sd">    Returns</span>
</span><span id="get_internal_energies-61"><a href="#get_internal_energies-61"><span class="linenos">61</span></a><span class="sd">    -------</span>
</span><span id="get_internal_energies-62"><a href="#get_internal_energies-62"><span class="linenos">62</span></a><span class="sd">    array-like</span>
</span><span id="get_internal_energies-63"><a href="#get_internal_energies-63"><span class="linenos">63</span></a>
</span><span id="get_internal_energies-64"><a href="#get_internal_energies-64"><span class="linenos">64</span></a><span class="sd">    Examples</span>
</span><span id="get_internal_energies-65"><a href="#get_internal_energies-65"><span class="linenos">65</span></a><span class="sd">    --------</span>
</span><span id="get_internal_energies-66"><a href="#get_internal_energies-66"><span class="linenos">66</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_internal_energies-67"><a href="#get_internal_energies-67"><span class="linenos">67</span></a><span class="sd">    &gt;&gt;&gt; from overreact import _constants as constants</span>
</span><span id="get_internal_energies-68"><a href="#get_internal_energies-68"><span class="linenos">68</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/ethane/B97-3c/model.k&quot;)</span>
</span><span id="get_internal_energies-69"><a href="#get_internal_energies-69"><span class="linenos">69</span></a><span class="sd">    &gt;&gt;&gt; internal_energies = get_internal_energies(model.compounds)</span>
</span><span id="get_internal_energies-70"><a href="#get_internal_energies-70"><span class="linenos">70</span></a><span class="sd">    &gt;&gt;&gt; (internal_energies - internal_energies.min()) / constants.kcal</span>
</span><span id="get_internal_energies-71"><a href="#get_internal_energies-71"><span class="linenos">71</span></a><span class="sd">    array([0. , 2.20053981])</span>
</span><span id="get_internal_energies-72"><a href="#get_internal_energies-72"><span class="linenos">72</span></a>
</span><span id="get_internal_energies-73"><a href="#get_internal_energies-73"><span class="linenos">73</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_internal_energies-74"><a href="#get_internal_energies-74"><span class="linenos">74</span></a>    <span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">_check_compounds</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="get_internal_energies-75"><a href="#get_internal_energies-75"><span class="linenos">75</span></a>    <span class="n">internal_energies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_internal_energies-76"><a href="#get_internal_energies-76"><span class="linenos">76</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">:</span>
</span><span id="get_internal_energies-77"><a href="#get_internal_energies-77"><span class="linenos">77</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;calculate internal energy: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_internal_energies-78"><a href="#get_internal_energies-78"><span class="linenos">78</span></a>
</span><span id="get_internal_energies-79"><a href="#get_internal_energies-79"><span class="linenos">79</span></a>        <span class="c1"># TODO(schneiderfelipe): inertia might benefit from caching</span>
</span><span id="get_internal_energies-80"><a href="#get_internal_energies-80"><span class="linenos">80</span></a>        <span class="n">moments</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">inertia</span><span class="p">(</span>
</span><span id="get_internal_energies-81"><a href="#get_internal_energies-81"><span class="linenos">81</span></a>            <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atommasses</span><span class="p">,</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">atomcoords</span>
</span><span id="get_internal_energies-82"><a href="#get_internal_energies-82"><span class="linenos">82</span></a>        <span class="p">)</span>
</span><span id="get_internal_energies-83"><a href="#get_internal_energies-83"><span class="linenos">83</span></a>
</span><span id="get_internal_energies-84"><a href="#get_internal_energies-84"><span class="linenos">84</span></a>        <span class="n">internal_energy</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">thermo</span><span class="o">.</span><span class="n">calc_internal_energy</span><span class="p">(</span>
</span><span id="get_internal_energies-85"><a href="#get_internal_energies-85"><span class="linenos">85</span></a>            <span class="n">energy</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span>
</span><span id="get_internal_energies-86"><a href="#get_internal_energies-86"><span class="linenos">86</span></a>            <span class="n">degeneracy</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">mult</span><span class="p">,</span>
</span><span id="get_internal_energies-87"><a href="#get_internal_energies-87"><span class="linenos">87</span></a>            <span class="n">moments</span><span class="o">=</span><span class="n">moments</span><span class="p">,</span>
</span><span id="get_internal_energies-88"><a href="#get_internal_energies-88"><span class="linenos">88</span></a>            <span class="n">vibfreqs</span><span class="o">=</span><span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">vibfreqs</span><span class="p">,</span>
</span><span id="get_internal_energies-89"><a href="#get_internal_energies-89"><span class="linenos">89</span></a>            <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho</span><span class="p">,</span>
</span><span id="get_internal_energies-90"><a href="#get_internal_energies-90"><span class="linenos">90</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_internal_energies-91"><a href="#get_internal_energies-91"><span class="linenos">91</span></a>        <span class="p">)</span>
</span><span id="get_internal_energies-92"><a href="#get_internal_energies-92"><span class="linenos">92</span></a>        <span class="n">internal_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">internal_energy</span><span class="p">)</span>
</span><span id="get_internal_energies-93"><a href="#get_internal_energies-93"><span class="linenos">93</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">internal_energies</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Obtain internal energies for compounds at a given temperature.</p>

<h2 id="parameters">Parameters</h2>

<p>compounds : dict-like
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
qrrho : bool, optional
    Apply the quasi-rigid rotor harmonic oscillator (QRRHO) approximation of
    M. Head-Gordon and others (see
    <a href="http://dx.doi.org/10.1021/jp509921r"><em>J. Phys. Chem. C</em> <strong>2015</strong>, 119, 4, 1840-1850</a>)
    on top of the classical RRHO.
temperature : array-like, optional
    Absolute temperature in Kelvin.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">overreact</span> <span class="kn">import</span> <span class="n">_constants</span> <span class="k">as</span> <span class="n">constants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">internal_energies</span> <span class="o">=</span> <span class="n">get_internal_energies</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">internal_energies</span> <span class="o">-</span> <span class="n">internal_energies</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="o">/</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span>
<span class="go">array([0. , 2.20053981])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_k">
                            <input id="get_k-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_k</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">scheme</span><span class="p">:</span> <span class="n"><a href="#Scheme">overreact.Scheme</a></span>,</span><span class="param">	<span class="n">compounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>,</span><span class="param">	<span class="n">tunneling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;eckart&#39;</span>,</span><span class="param">	<span class="n">qrrho</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;l mol-1 s-1&#39;</span>,</span><span class="param">	<span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span>,</span><span class="param">	<span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101325.0</span>,</span><span class="param">	<span class="n">delta_freeenergies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">molecularity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">volume</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">float</span>:</span></span>

                <label class="view-source-button" for="get_k-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_k"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_k-409"><a href="#get_k-409"><span class="linenos">409</span></a><span class="k">def</span> <span class="nf">get_k</span><span class="p">(</span>
</span><span id="get_k-410"><a href="#get_k-410"><span class="linenos">410</span></a>    <span class="n">scheme</span><span class="p">:</span> <span class="n">Scheme</span><span class="p">,</span>
</span><span id="get_k-411"><a href="#get_k-411"><span class="linenos">411</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="get_k-412"><a href="#get_k-412"><span class="linenos">412</span></a>    <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
</span><span id="get_k-413"><a href="#get_k-413"><span class="linenos">413</span></a>    <span class="n">tunneling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;eckart&quot;</span><span class="p">,</span>
</span><span id="get_k-414"><a href="#get_k-414"><span class="linenos">414</span></a>    <span class="n">qrrho</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT002, UP007</span>
</span><span id="get_k-415"><a href="#get_k-415"><span class="linenos">415</span></a>    <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;l mol-1 s-1&quot;</span><span class="p">,</span>
</span><span id="get_k-416"><a href="#get_k-416"><span class="linenos">416</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>
</span><span id="get_k-417"><a href="#get_k-417"><span class="linenos">417</span></a>    <span class="n">pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">atm</span><span class="p">,</span>
</span><span id="get_k-418"><a href="#get_k-418"><span class="linenos">418</span></a>    <span class="n">delta_freeenergies</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="get_k-419"><a href="#get_k-419"><span class="linenos">419</span></a>    <span class="n">molecularity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="get_k-420"><a href="#get_k-420"><span class="linenos">420</span></a>    <span class="n">volume</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa: UP007</span>
</span><span id="get_k-421"><a href="#get_k-421"><span class="linenos">421</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="get_k-422"><a href="#get_k-422"><span class="linenos">422</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Obtain reaction rate constants for a given reaction scheme.</span>
</span><span id="get_k-423"><a href="#get_k-423"><span class="linenos">423</span></a>
</span><span id="get_k-424"><a href="#get_k-424"><span class="linenos">424</span></a><span class="sd">    Parameters</span>
</span><span id="get_k-425"><a href="#get_k-425"><span class="linenos">425</span></a><span class="sd">    ----------</span>
</span><span id="get_k-426"><a href="#get_k-426"><span class="linenos">426</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="get_k-427"><a href="#get_k-427"><span class="linenos">427</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="get_k-428"><a href="#get_k-428"><span class="linenos">428</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_k-429"><a href="#get_k-429"><span class="linenos">429</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_k-430"><a href="#get_k-430"><span class="linenos">430</span></a><span class="sd">    compounds : dict-like, optional</span>
</span><span id="get_k-431"><a href="#get_k-431"><span class="linenos">431</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_k-432"><a href="#get_k-432"><span class="linenos">432</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_k-433"><a href="#get_k-433"><span class="linenos">433</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_k-434"><a href="#get_k-434"><span class="linenos">434</span></a><span class="sd">    bias : array-like, optional</span>
</span><span id="get_k-435"><a href="#get_k-435"><span class="linenos">435</span></a><span class="sd">        Energy to be added to free energies.</span>
</span><span id="get_k-436"><a href="#get_k-436"><span class="linenos">436</span></a><span class="sd">    tunneling : str or None, optional</span>
</span><span id="get_k-437"><a href="#get_k-437"><span class="linenos">437</span></a><span class="sd">        Choose between &quot;eckart&quot;, &quot;wigner&quot; or None (or &quot;none&quot;).</span>
</span><span id="get_k-438"><a href="#get_k-438"><span class="linenos">438</span></a><span class="sd">    qrrho : bool or tuple-like, optional</span>
</span><span id="get_k-439"><a href="#get_k-439"><span class="linenos">439</span></a><span class="sd">        Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)</span>
</span><span id="get_k-440"><a href="#get_k-440"><span class="linenos">440</span></a><span class="sd">        approximations of M. Head-Gordonand others (enthalpy correction, see</span>
</span><span id="get_k-441"><a href="#get_k-441"><span class="linenos">441</span></a><span class="sd">        [*J. Phys. Chem. C* **2015**, 119, 4, 1840-1850](http://dx.doi.org/10.1021/jp509921r))</span>
</span><span id="get_k-442"><a href="#get_k-442"><span class="linenos">442</span></a><span class="sd">        and S. Grimme (entropy correction, see</span>
</span><span id="get_k-443"><a href="#get_k-443"><span class="linenos">443</span></a><span class="sd">        [*Theory. Chem. Eur. J.*, **2012**, 18: 9955-9964](https://doi.org/10.1002/chem.201200497))</span>
</span><span id="get_k-444"><a href="#get_k-444"><span class="linenos">444</span></a><span class="sd">        on top of the classical RRHO.</span>
</span><span id="get_k-445"><a href="#get_k-445"><span class="linenos">445</span></a><span class="sd">    scale : str, optional</span>
</span><span id="get_k-446"><a href="#get_k-446"><span class="linenos">446</span></a><span class="sd">        Reaction rate units. Possible values are &quot;cm3 mol-1 s-1&quot;,</span>
</span><span id="get_k-447"><a href="#get_k-447"><span class="linenos">447</span></a><span class="sd">        &quot;l mol-1 s-1&quot;, &quot;m3 mol-1 s-1&quot;, &quot;cm3 particle-1 s-1&quot;, &quot;mmHg-1 s-1&quot; and</span>
</span><span id="get_k-448"><a href="#get_k-448"><span class="linenos">448</span></a><span class="sd">        &quot;atm-1 s-1&quot;.</span>
</span><span id="get_k-449"><a href="#get_k-449"><span class="linenos">449</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_k-450"><a href="#get_k-450"><span class="linenos">450</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_k-451"><a href="#get_k-451"><span class="linenos">451</span></a><span class="sd">    pressure : array-like, optional</span>
</span><span id="get_k-452"><a href="#get_k-452"><span class="linenos">452</span></a><span class="sd">        Reference gas pressure.</span>
</span><span id="get_k-453"><a href="#get_k-453"><span class="linenos">453</span></a><span class="sd">    delta_freeenergies : array-like, optional</span>
</span><span id="get_k-454"><a href="#get_k-454"><span class="linenos">454</span></a><span class="sd">        Use this instead of obtaining delta free energies from the compounds.</span>
</span><span id="get_k-455"><a href="#get_k-455"><span class="linenos">455</span></a><span class="sd">    molecularity : array-like, optional</span>
</span><span id="get_k-456"><a href="#get_k-456"><span class="linenos">456</span></a><span class="sd">        Reaction order, i.e., number of molecules that come together to react.</span>
</span><span id="get_k-457"><a href="#get_k-457"><span class="linenos">457</span></a><span class="sd">        If set, this is used to calculate `delta_moles` for</span>
</span><span id="get_k-458"><a href="#get_k-458"><span class="linenos">458</span></a><span class="sd">        `overreact.thermo.equilibrium_constant`, which effectively calculates a solution</span>
</span><span id="get_k-459"><a href="#get_k-459"><span class="linenos">459</span></a><span class="sd">        equilibrium constant between reactants and the transition state for</span>
</span><span id="get_k-460"><a href="#get_k-460"><span class="linenos">460</span></a><span class="sd">        gas phase data. You should set this to `None` if your free energies</span>
</span><span id="get_k-461"><a href="#get_k-461"><span class="linenos">461</span></a><span class="sd">        were already adjusted for solution Gibbs free energies.</span>
</span><span id="get_k-462"><a href="#get_k-462"><span class="linenos">462</span></a><span class="sd">    volume : float, optional</span>
</span><span id="get_k-463"><a href="#get_k-463"><span class="linenos">463</span></a><span class="sd">        Molar volume.</span>
</span><span id="get_k-464"><a href="#get_k-464"><span class="linenos">464</span></a>
</span><span id="get_k-465"><a href="#get_k-465"><span class="linenos">465</span></a><span class="sd">    Returns</span>
</span><span id="get_k-466"><a href="#get_k-466"><span class="linenos">466</span></a><span class="sd">    -------</span>
</span><span id="get_k-467"><a href="#get_k-467"><span class="linenos">467</span></a><span class="sd">    array-like</span>
</span><span id="get_k-468"><a href="#get_k-468"><span class="linenos">468</span></a>
</span><span id="get_k-469"><a href="#get_k-469"><span class="linenos">469</span></a><span class="sd">    Notes</span>
</span><span id="get_k-470"><a href="#get_k-470"><span class="linenos">470</span></a><span class="sd">    -----</span>
</span><span id="get_k-471"><a href="#get_k-471"><span class="linenos">471</span></a><span class="sd">    Some symbols are accepted as alternatives in &quot;scale&quot;: &quot;M-1&quot;, &quot;ml&quot; and</span>
</span><span id="get_k-472"><a href="#get_k-472"><span class="linenos">472</span></a><span class="sd">    &quot;torr-1&quot; are understood as &quot;l mol-1&quot;, &quot;cm3&quot; and &quot;mmHg-1&quot;, respectively.</span>
</span><span id="get_k-473"><a href="#get_k-473"><span class="linenos">473</span></a>
</span><span id="get_k-474"><a href="#get_k-474"><span class="linenos">474</span></a><span class="sd">    Examples</span>
</span><span id="get_k-475"><a href="#get_k-475"><span class="linenos">475</span></a><span class="sd">    --------</span>
</span><span id="get_k-476"><a href="#get_k-476"><span class="linenos">476</span></a><span class="sd">    Below is an example of an estimate for the rate of methyl rotation in</span>
</span><span id="get_k-477"><a href="#get_k-477"><span class="linenos">477</span></a><span class="sd">    ethane (a trivial attempt to reproduce</span>
</span><span id="get_k-478"><a href="#get_k-478"><span class="linenos">478</span></a><span class="sd">    [*Science*, **2006**, 313, 5795, 1951-1955](https://doi.org/10.1126/science.1132178)).</span>
</span><span id="get_k-479"><a href="#get_k-479"><span class="linenos">479</span></a><span class="sd">    **How many turns it does per second?**</span>
</span><span id="get_k-480"><a href="#get_k-480"><span class="linenos">480</span></a>
</span><span id="get_k-481"><a href="#get_k-481"><span class="linenos">481</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/ethane/B97-3c/model.k&quot;)</span>
</span><span id="get_k-482"><a href="#get_k-482"><span class="linenos">482</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds)</span>
</span><span id="get_k-483"><a href="#get_k-483"><span class="linenos">483</span></a><span class="sd">    array([8.16e+10])</span>
</span><span id="get_k-484"><a href="#get_k-484"><span class="linenos">484</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, qrrho=(False, True))</span>
</span><span id="get_k-485"><a href="#get_k-485"><span class="linenos">485</span></a><span class="sd">    array([8.24968117e+10])</span>
</span><span id="get_k-486"><a href="#get_k-486"><span class="linenos">486</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, qrrho=False)</span>
</span><span id="get_k-487"><a href="#get_k-487"><span class="linenos">487</span></a><span class="sd">    array([8.26909266e+10])</span>
</span><span id="get_k-488"><a href="#get_k-488"><span class="linenos">488</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, tunneling=&quot;wigner&quot;)</span>
</span><span id="get_k-489"><a href="#get_k-489"><span class="linenos">489</span></a><span class="sd">    array([7.99e+10])</span>
</span><span id="get_k-490"><a href="#get_k-490"><span class="linenos">490</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, tunneling=None)</span>
</span><span id="get_k-491"><a href="#get_k-491"><span class="linenos">491</span></a><span class="sd">    array([7.35e+10])</span>
</span><span id="get_k-492"><a href="#get_k-492"><span class="linenos">492</span></a>
</span><span id="get_k-493"><a href="#get_k-493"><span class="linenos">493</span></a><span class="sd">    The calculated value is off by less than 2% from the experimental value</span>
</span><span id="get_k-494"><a href="#get_k-494"><span class="linenos">494</span></a><span class="sd">    (:math:`\frac{1}{12 \times 10^{-12}} \text{s}^{-1} = 8.33 \times 10^{10} \text{s}^{-1}`).</span>
</span><span id="get_k-495"><a href="#get_k-495"><span class="linenos">495</span></a><span class="sd">    We use Eckart tunneling by default, but see the effect of changing it</span>
</span><span id="get_k-496"><a href="#get_k-496"><span class="linenos">496</span></a><span class="sd">    above.</span>
</span><span id="get_k-497"><a href="#get_k-497"><span class="linenos">497</span></a>
</span><span id="get_k-498"><a href="#get_k-498"><span class="linenos">498</span></a><span class="sd">    The units of the returned reaction rate constants can be selected for</span>
</span><span id="get_k-499"><a href="#get_k-499"><span class="linenos">499</span></a><span class="sd">    non-unimolecular processes. The following is an attempt to reproduce</span>
</span><span id="get_k-500"><a href="#get_k-500"><span class="linenos">500</span></a><span class="sd">    [*J Atmos Chem*, **1996** 23, 37-49](https://doi.org/10.1007/BF00058703) for</span>
</span><span id="get_k-501"><a href="#get_k-501"><span class="linenos">501</span></a><span class="sd">    the reaction of proton-withdrawal by a chloride radical from the methane</span>
</span><span id="get_k-502"><a href="#get_k-502"><span class="linenos">502</span></a><span class="sd">    molecule</span>
</span><span id="get_k-503"><a href="#get_k-503"><span class="linenos">503</span></a><span class="sd">    :math:`\ce{CH4 + \cdot Cl -&gt; [H3C\cdots H\cdots Cl]^\ddagger -&gt; H3C\cdot + HCl}`:</span>
</span><span id="get_k-504"><a href="#get_k-504"><span class="linenos">504</span></a>
</span><span id="get_k-505"><a href="#get_k-505"><span class="linenos">505</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/tanaka1996/UMP2/cc-pVTZ/model.jk&quot;)</span>
</span><span id="get_k-506"><a href="#get_k-506"><span class="linenos">506</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, temperature=300,</span>
</span><span id="get_k-507"><a href="#get_k-507"><span class="linenos">507</span></a><span class="sd">    ...       scale=&quot;cm3 particle-1 s-1&quot;)</span>
</span><span id="get_k-508"><a href="#get_k-508"><span class="linenos">508</span></a><span class="sd">    array([9.60e-14])</span>
</span><span id="get_k-509"><a href="#get_k-509"><span class="linenos">509</span></a>
</span><span id="get_k-510"><a href="#get_k-510"><span class="linenos">510</span></a><span class="sd">    (By the way, according to the Jet Propulsion Laboratory,</span>
</span><span id="get_k-511"><a href="#get_k-511"><span class="linenos">511</span></a><span class="sd">    [Publication No. 19-5](https://jpldataeval.jpl.nasa.gov/),</span>
</span><span id="get_k-512"><a href="#get_k-512"><span class="linenos">512</span></a><span class="sd">    the experimental reaction rate constant for this reaction is</span>
</span><span id="get_k-513"><a href="#get_k-513"><span class="linenos">513</span></a><span class="sd">    :math:`1.0 \times 10^{-13} \text{cm}^3 \text{particle}^{-1} \text{s}^{-1}`.)</span>
</span><span id="get_k-514"><a href="#get_k-514"><span class="linenos">514</span></a>
</span><span id="get_k-515"><a href="#get_k-515"><span class="linenos">515</span></a><span class="sd">    The returned units are &quot;M-1 s-1&quot; by default:</span>
</span><span id="get_k-516"><a href="#get_k-516"><span class="linenos">516</span></a>
</span><span id="get_k-517"><a href="#get_k-517"><span class="linenos">517</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds) \</span>
</span><span id="get_k-518"><a href="#get_k-518"><span class="linenos">518</span></a><span class="sd">    ... == get_k(model.scheme, model.compounds, scale=&quot;l mol-1 s-1&quot;)</span>
</span><span id="get_k-519"><a href="#get_k-519"><span class="linenos">519</span></a><span class="sd">    array([ True])</span>
</span><span id="get_k-520"><a href="#get_k-520"><span class="linenos">520</span></a>
</span><span id="get_k-521"><a href="#get_k-521"><span class="linenos">521</span></a><span class="sd">    You can also turn the tunneling correction off by using the string &quot;none&quot;:</span>
</span><span id="get_k-522"><a href="#get_k-522"><span class="linenos">522</span></a>
</span><span id="get_k-523"><a href="#get_k-523"><span class="linenos">523</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, tunneling=&quot;none&quot;) \</span>
</span><span id="get_k-524"><a href="#get_k-524"><span class="linenos">524</span></a><span class="sd">    ... == get_k(model.scheme, model.compounds, tunneling=None)</span>
</span><span id="get_k-525"><a href="#get_k-525"><span class="linenos">525</span></a><span class="sd">    array([ True])</span>
</span><span id="get_k-526"><a href="#get_k-526"><span class="linenos">526</span></a>
</span><span id="get_k-527"><a href="#get_k-527"><span class="linenos">527</span></a><span class="sd">    You can set a simple energy bias, either as a constant or compound-wise:</span>
</span><span id="get_k-528"><a href="#get_k-528"><span class="linenos">528</span></a>
</span><span id="get_k-529"><a href="#get_k-529"><span class="linenos">529</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds, bias=1.0 * constants.kcal,</span>
</span><span id="get_k-530"><a href="#get_k-530"><span class="linenos">530</span></a><span class="sd">    ...       temperature=300.0, scale=&quot;cm3 particle-1 s-1&quot;)</span>
</span><span id="get_k-531"><a href="#get_k-531"><span class="linenos">531</span></a><span class="sd">    array([5.14e-13])</span>
</span><span id="get_k-532"><a href="#get_k-532"><span class="linenos">532</span></a><span class="sd">    &gt;&gt;&gt; get_k(model.scheme, model.compounds,</span>
</span><span id="get_k-533"><a href="#get_k-533"><span class="linenos">533</span></a><span class="sd">    ...       bias=np.array([0.0, 0.0, -1.4, 0.0, 0.0]) * constants.kcal,</span>
</span><span id="get_k-534"><a href="#get_k-534"><span class="linenos">534</span></a><span class="sd">    ...       temperature=300.0, scale=&quot;cm3 particle-1 s-1&quot;)</span>
</span><span id="get_k-535"><a href="#get_k-535"><span class="linenos">535</span></a><span class="sd">    array([1.1e-12])</span>
</span><span id="get_k-536"><a href="#get_k-536"><span class="linenos">536</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_k-537"><a href="#get_k-537"><span class="linenos">537</span></a>    <span class="n">qrrho_enthalpy</span><span class="p">,</span> <span class="n">qrrho_entropy</span> <span class="o">=</span> <span class="n">_check_qrrho</span><span class="p">(</span><span class="n">qrrho</span><span class="p">)</span>
</span><span id="get_k-538"><a href="#get_k-538"><span class="linenos">538</span></a>    <span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_check_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
</span><span id="get_k-539"><a href="#get_k-539"><span class="linenos">539</span></a>    <span class="k">if</span> <span class="n">compounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_k-540"><a href="#get_k-540"><span class="linenos">540</span></a>        <span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">_check_compounds</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="get_k-541"><a href="#get_k-541"><span class="linenos">541</span></a>    <span class="k">if</span> <span class="n">delta_freeenergies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_k-542"><a href="#get_k-542"><span class="linenos">542</span></a>        <span class="k">assert</span> <span class="n">compounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;compounds could not be inferred&quot;</span>
</span><span id="get_k-543"><a href="#get_k-543"><span class="linenos">543</span></a>        <span class="n">freeenergies</span> <span class="o">=</span> <span class="n">get_freeenergies</span><span class="p">(</span>
</span><span id="get_k-544"><a href="#get_k-544"><span class="linenos">544</span></a>            <span class="n">compounds</span><span class="p">,</span>
</span><span id="get_k-545"><a href="#get_k-545"><span class="linenos">545</span></a>            <span class="n">bias</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
</span><span id="get_k-546"><a href="#get_k-546"><span class="linenos">546</span></a>            <span class="n">qrrho</span><span class="o">=</span><span class="p">(</span><span class="n">qrrho_enthalpy</span><span class="p">,</span> <span class="n">qrrho_entropy</span><span class="p">),</span>
</span><span id="get_k-547"><a href="#get_k-547"><span class="linenos">547</span></a>            <span class="c1"># NOTE(schneiderfelipe): ensure we get rate constants in M-1 s-1.</span>
</span><span id="get_k-548"><a href="#get_k-548"><span class="linenos">548</span></a>            <span class="c1"># TODO(schneiderfelipe): this strategy will have to change</span>
</span><span id="get_k-549"><a href="#get_k-549"><span class="linenos">549</span></a>            <span class="c1"># somewhat when we improve solvation entropy models.</span>
</span><span id="get_k-550"><a href="#get_k-550"><span class="linenos">550</span></a>            <span class="n">environment</span><span class="o">=</span><span class="s2">&quot;solvent&quot;</span><span class="p">,</span>
</span><span id="get_k-551"><a href="#get_k-551"><span class="linenos">551</span></a>            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_k-552"><a href="#get_k-552"><span class="linenos">552</span></a>            <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_k-553"><a href="#get_k-553"><span class="linenos">553</span></a>        <span class="p">)</span>
</span><span id="get_k-554"><a href="#get_k-554"><span class="linenos">554</span></a>
</span><span id="get_k-555"><a href="#get_k-555"><span class="linenos">555</span></a>        <span class="c1"># TODO(schneiderfelipe): log the contribution of reaction symmetry</span>
</span><span id="get_k-556"><a href="#get_k-556"><span class="linenos">556</span></a>        <span class="n">delta_freeenergies</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_delta</span><span class="p">(</span>
</span><span id="get_k-557"><a href="#get_k-557"><span class="linenos">557</span></a>            <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">freeenergies</span>
</span><span id="get_k-558"><a href="#get_k-558"><span class="linenos">558</span></a>        <span class="p">)</span> <span class="o">-</span> <span class="n">temperature</span> <span class="o">*</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_reaction_entropies</span><span class="p">(</span>
</span><span id="get_k-559"><a href="#get_k-559"><span class="linenos">559</span></a>            <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span>
</span><span id="get_k-560"><a href="#get_k-560"><span class="linenos">560</span></a>        <span class="p">)</span>
</span><span id="get_k-561"><a href="#get_k-561"><span class="linenos">561</span></a>
</span><span id="get_k-562"><a href="#get_k-562"><span class="linenos">562</span></a>    <span class="k">if</span> <span class="n">molecularity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_k-563"><a href="#get_k-563"><span class="linenos">563</span></a>        <span class="n">molecularity</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">thermo</span><span class="o">.</span><span class="n">get_molecularity</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
</span><span id="get_k-564"><a href="#get_k-564"><span class="linenos">564</span></a>
</span><span id="get_k-565"><a href="#get_k-565"><span class="linenos">565</span></a>    <span class="c1"># NOTE(schneiderfelipe): passing molecularity here to rates.eyring messes up</span>
</span><span id="get_k-566"><a href="#get_k-566"><span class="linenos">566</span></a>    <span class="c1"># rate constant units (by a factor of M-1 s-1 to atm-1 s-1), so we leave it as is.</span>
</span><span id="get_k-567"><a href="#get_k-567"><span class="linenos">567</span></a>    <span class="n">k</span> <span class="o">=</span> <span class="n">rates</span><span class="o">.</span><span class="n">eyring</span><span class="p">(</span>
</span><span id="get_k-568"><a href="#get_k-568"><span class="linenos">568</span></a>        <span class="n">delta_freeenergies</span><span class="p">,</span>
</span><span id="get_k-569"><a href="#get_k-569"><span class="linenos">569</span></a>        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_k-570"><a href="#get_k-570"><span class="linenos">570</span></a>        <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_k-571"><a href="#get_k-571"><span class="linenos">571</span></a>        <span class="n">volume</span><span class="o">=</span><span class="n">volume</span><span class="p">,</span>
</span><span id="get_k-572"><a href="#get_k-572"><span class="linenos">572</span></a>    <span class="p">)</span>
</span><span id="get_k-573"><a href="#get_k-573"><span class="linenos">573</span></a>
</span><span id="get_k-574"><a href="#get_k-574"><span class="linenos">574</span></a>    <span class="c1"># make reaction rate constants for equilibria as close as possible to one</span>
</span><span id="get_k-575"><a href="#get_k-575"><span class="linenos">575</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="get_k-576"><a href="#get_k-576"><span class="linenos">576</span></a>    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">):</span>
</span><span id="get_k-577"><a href="#get_k-577"><span class="linenos">577</span></a>        <span class="k">if</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="get_k-578"><a href="#get_k-578"><span class="linenos">578</span></a>            <span class="n">pair</span> <span class="o">=</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="get_k-579"><a href="#get_k-579"><span class="linenos">579</span></a>            <span class="n">_K</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># noqa: N806</span>
</span><span id="get_k-580"><a href="#get_k-580"><span class="linenos">580</span></a>
</span><span id="get_k-581"><a href="#get_k-581"><span class="linenos">581</span></a>            <span class="n">denom</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</span><span id="get_k-582"><a href="#get_k-582"><span class="linenos">582</span></a>            <span class="k">if</span> <span class="n">denom</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
</span><span id="get_k-583"><a href="#get_k-583"><span class="linenos">583</span></a>                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="get_k-584"><a href="#get_k-584"><span class="linenos">584</span></a>                    <span class="s2">&quot;found half-equilibrium reaction with zero rate constant: &quot;</span>
</span><span id="get_k-585"><a href="#get_k-585"><span class="linenos">585</span></a>                    <span class="s2">&quot;skipping equilibrium normalization&quot;</span>
</span><span id="get_k-586"><a href="#get_k-586"><span class="linenos">586</span></a>                <span class="p">)</span>
</span><span id="get_k-587"><a href="#get_k-587"><span class="linenos">587</span></a>                <span class="n">denom</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="get_k-588"><a href="#get_k-588"><span class="linenos">588</span></a>
</span><span id="get_k-589"><a href="#get_k-589"><span class="linenos">589</span></a>            <span class="n">k</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">pair</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="get_k-590"><a href="#get_k-590"><span class="linenos">590</span></a>            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">_K</span><span class="p">,</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span>
</span><span id="get_k-591"><a href="#get_k-591"><span class="linenos">591</span></a>                <span class="sa">f</span><span class="s2">&quot;reaction rate constants </span><span class="si">{</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> for &quot;</span>
</span><span id="get_k-592"><a href="#get_k-592"><span class="linenos">592</span></a>                <span class="s2">&quot;equilibria could not be made to match the expected &quot;</span>
</span><span id="get_k-593"><a href="#get_k-593"><span class="linenos">593</span></a>                <span class="sa">f</span><span class="s2">&quot;equilibrium constant value </span><span class="si">{</span><span class="n">_K</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="get_k-594"><a href="#get_k-594"><span class="linenos">594</span></a>            <span class="p">)</span>
</span><span id="get_k-595"><a href="#get_k-595"><span class="linenos">595</span></a>
</span><span id="get_k-596"><a href="#get_k-596"><span class="linenos">596</span></a>            <span class="c1"># loop over pairs of equilibria</span>
</span><span id="get_k-597"><a href="#get_k-597"><span class="linenos">597</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="get_k-598"><a href="#get_k-598"><span class="linenos">598</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="get_k-599"><a href="#get_k-599"><span class="linenos">599</span></a>
</span><span id="get_k-600"><a href="#get_k-600"><span class="linenos">600</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="get_k-601"><a href="#get_k-601"><span class="linenos">601</span></a>        <span class="s2">&quot;(classical) reaction rate constants: &quot;</span>
</span><span id="get_k-602"><a href="#get_k-602"><span class="linenos">602</span></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">7.3g</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">k</span><span class="p">])</span><span class="si">}</span><span class="s2"> atm‚Åª‚Åø‚Å∫¬π¬∑s‚Åª¬π&quot;</span>
</span><span id="get_k-603"><a href="#get_k-603"><span class="linenos">603</span></a>    <span class="p">)</span>
</span><span id="get_k-604"><a href="#get_k-604"><span class="linenos">604</span></a>    <span class="k">if</span> <span class="n">tunneling</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">}:</span>
</span><span id="get_k-605"><a href="#get_k-605"><span class="linenos">605</span></a>        <span class="k">if</span> <span class="n">compounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_k-606"><a href="#get_k-606"><span class="linenos">606</span></a>            <span class="n">kappa</span> <span class="o">=</span> <span class="n">get_kappa</span><span class="p">(</span>
</span><span id="get_k-607"><a href="#get_k-607"><span class="linenos">607</span></a>                <span class="n">scheme</span><span class="p">,</span>
</span><span id="get_k-608"><a href="#get_k-608"><span class="linenos">608</span></a>                <span class="n">compounds</span><span class="p">,</span>
</span><span id="get_k-609"><a href="#get_k-609"><span class="linenos">609</span></a>                <span class="n">method</span><span class="o">=</span><span class="n">tunneling</span><span class="p">,</span>
</span><span id="get_k-610"><a href="#get_k-610"><span class="linenos">610</span></a>                <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho_enthalpy</span><span class="p">,</span>
</span><span id="get_k-611"><a href="#get_k-611"><span class="linenos">611</span></a>                <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_k-612"><a href="#get_k-612"><span class="linenos">612</span></a>            <span class="p">)</span>
</span><span id="get_k-613"><a href="#get_k-613"><span class="linenos">613</span></a>            <span class="n">k</span> <span class="o">*=</span> <span class="n">kappa</span>
</span><span id="get_k-614"><a href="#get_k-614"><span class="linenos">614</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="get_k-615"><a href="#get_k-615"><span class="linenos">615</span></a>            <span class="c1"># TODO(schneiderfelipe): when get_kappa accept deltas, this will</span>
</span><span id="get_k-616"><a href="#get_k-616"><span class="linenos">616</span></a>            <span class="c1"># be probably unnecessary.</span>
</span><span id="get_k-617"><a href="#get_k-617"><span class="linenos">617</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="get_k-618"><a href="#get_k-618"><span class="linenos">618</span></a>                <span class="s2">&quot;assuming unitary tunneling coefficients due to incomplete &quot;</span>
</span><span id="get_k-619"><a href="#get_k-619"><span class="linenos">619</span></a>                <span class="s2">&quot;compound data&quot;</span>
</span><span id="get_k-620"><a href="#get_k-620"><span class="linenos">620</span></a>            <span class="p">)</span>
</span><span id="get_k-621"><a href="#get_k-621"><span class="linenos">621</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="get_k-622"><a href="#get_k-622"><span class="linenos">622</span></a>            <span class="s2">&quot;(tunneling) reaction rate constants: &quot;</span>
</span><span id="get_k-623"><a href="#get_k-623"><span class="linenos">623</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">v</span><span class="si">:</span><span class="s1">7.3g</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">k</span><span class="p">])</span><span class="si">}</span><span class="s2"> atm‚Åª‚Åø‚Å∫¬π¬∑s‚Åª¬π&quot;</span>
</span><span id="get_k-624"><a href="#get_k-624"><span class="linenos">624</span></a>        <span class="p">)</span>
</span><span id="get_k-625"><a href="#get_k-625"><span class="linenos">625</span></a>
</span><span id="get_k-626"><a href="#get_k-626"><span class="linenos">626</span></a>    <span class="c1"># TODO(schneiderfelipe): ensure diffusional limit for reactions in</span>
</span><span id="get_k-627"><a href="#get_k-627"><span class="linenos">627</span></a>    <span class="c1"># solvation using Collins-Kimball theory. This includes half-equilibria.</span>
</span><span id="get_k-628"><a href="#get_k-628"><span class="linenos">628</span></a>    <span class="k">return</span> <span class="n">rates</span><span class="o">.</span><span class="n">convert_rate_constant</span><span class="p">(</span>
</span><span id="get_k-629"><a href="#get_k-629"><span class="linenos">629</span></a>        <span class="n">k</span><span class="p">,</span>
</span><span id="get_k-630"><a href="#get_k-630"><span class="linenos">630</span></a>        <span class="n">new_scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
</span><span id="get_k-631"><a href="#get_k-631"><span class="linenos">631</span></a>        <span class="c1"># NOTE(schneiderfelipe): all the code above should always generate</span>
</span><span id="get_k-632"><a href="#get_k-632"><span class="linenos">632</span></a>        <span class="c1"># rate constants in M-1 s-1, so that we convert them here.</span>
</span><span id="get_k-633"><a href="#get_k-633"><span class="linenos">633</span></a>        <span class="n">old_scale</span><span class="o">=</span><span class="s2">&quot;l mol-1 s-1&quot;</span><span class="p">,</span>
</span><span id="get_k-634"><a href="#get_k-634"><span class="linenos">634</span></a>        <span class="n">molecularity</span><span class="o">=</span><span class="n">molecularity</span><span class="p">,</span>
</span><span id="get_k-635"><a href="#get_k-635"><span class="linenos">635</span></a>        <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_k-636"><a href="#get_k-636"><span class="linenos">636</span></a>        <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span>
</span><span id="get_k-637"><a href="#get_k-637"><span class="linenos">637</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Obtain reaction rate constants for a given reaction scheme.</p>

<h2 id="parameters">Parameters</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
compounds : dict-like, optional
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
bias : array-like, optional
    Energy to be added to free energies.
tunneling : str or None, optional
    Choose between "eckart", "wigner" or None (or "none").
qrrho : bool or tuple-like, optional
    Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)
    approximations of M. Head-Gordonand others (enthalpy correction, see
    <a href="http://dx.doi.org/10.1021/jp509921r"><em>J. Phys. Chem. C</em> <strong>2015</strong>, 119, 4, 1840-1850</a>)
    and S. Grimme (entropy correction, see
    <a href="https://doi.org/10.1002/chem.201200497"><em>Theory. Chem. Eur. J.</em>, <strong>2012</strong>, 18: 9955-9964</a>)
    on top of the classical RRHO.
scale : str, optional
    Reaction rate units. Possible values are "cm3 mol-1 s-1",
    "l mol-1 s-1", "m3 mol-1 s-1", "cm3 particle-1 s-1", "mmHg-1 s-1" and
    "atm-1 s-1".
temperature : array-like, optional
    Absolute temperature in Kelvin.
pressure : array-like, optional
    Reference gas pressure.
delta_freeenergies : array-like, optional
    Use this instead of obtaining delta free energies from the compounds.
molecularity : array-like, optional
    Reaction order, i.e., number of molecules that come together to react.
    If set, this is used to calculate <code>delta_moles</code> for
    <code>overreact.thermo.equilibrium_constant</code>, which effectively calculates a solution
    equilibrium constant between reactants and the transition state for
    gas phase data. You should set this to <code>None</code> if your free energies
    were already adjusted for solution Gibbs free energies.
volume : float, optional
    Molar volume.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="notes">Notes</h2>

<p>Some symbols are accepted as alternatives in "scale": "M-1", "ml" and
"torr-1" are understood as "l mol-1", "cm3" and "mmHg-1", respectively.</p>

<h2 id="examples">Examples</h2>

<p>Below is an example of an estimate for the rate of methyl rotation in
ethane (a trivial attempt to reproduce
<a href="https://doi.org/10.1126/science.1132178"><em>Science</em>, <strong>2006</strong>, 313, 5795, 1951-1955</a>).
<strong>How many turns it does per second?</strong></p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
<span class="go">array([8.16e+10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">qrrho</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="go">array([8.24968117e+10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">qrrho</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">array([8.26909266e+10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">tunneling</span><span class="o">=</span><span class="s2">&quot;wigner&quot;</span><span class="p">)</span>
<span class="go">array([7.99e+10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">tunneling</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">array([7.35e+10])</span>
</code></pre>
</div>

<p>The calculated value is off by less than 2% from the experimental value
(\( \frac{1}{12 \times 10^{-12}} \text{s}^{-1} = 8.33 \times 10^{10} \text{s}^{-1} \)).
We use Eckart tunneling by default, but see the effect of changing it
above.</p>

<p>The units of the returned reaction rate constants can be selected for
non-unimolecular processes. The following is an attempt to reproduce
<a href="https://doi.org/10.1007/BF00058703"><em>J Atmos Chem</em>, <strong>1996</strong> 23, 37-49</a> for
the reaction of proton-withdrawal by a chloride radical from the methane
molecule
\( \ce{CH4 + \cdot Cl -> [H3C\cdots H\cdots Cl]^\ddagger -> H3C\cdot + HCl} \):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/tanaka1996/UMP2/cc-pVTZ/model.jk&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;cm3 particle-1 s-1&quot;</span><span class="p">)</span>
<span class="go">array([9.60e-14])</span>
</code></pre>
</div>

<p>(By the way, according to the Jet Propulsion Laboratory,
<a href="https://jpldataeval.jpl.nasa.gov/">Publication No. 19-5</a>,
the experimental reaction rate constant for this reaction is
\( 1.0 \times 10^{-13} \text{cm}^3 \text{particle}^{-1} \text{s}^{-1} \).)</p>

<p>The returned units are "M-1 s-1" by default:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span> \
<span class="gp">... </span><span class="o">==</span> <span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;l mol-1 s-1&quot;</span><span class="p">)</span>
<span class="go">array([ True])</span>
</code></pre>
</div>

<p>You can also turn the tunneling correction off by using the string "none":</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">tunneling</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span> \
<span class="gp">... </span><span class="o">==</span> <span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">tunneling</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">array([ True])</span>
</code></pre>
</div>

<p>You can set a simple energy bias, either as a constant or compound-wise:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">temperature</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;cm3 particle-1 s-1&quot;</span><span class="p">)</span>
<span class="go">array([5.14e-13])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">bias</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">kcal</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">temperature</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;cm3 particle-1 s-1&quot;</span><span class="p">)</span>
<span class="go">array([1.1e-12])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_kappa">
                            <input id="get_kappa-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_kappa</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">scheme</span><span class="p">:</span> <span class="n"><a href="#Scheme">overreact.Scheme</a></span>,</span><span class="param">	<span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span>,</span><span class="param">	<span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;eckart&#39;</span>,</span><span class="param">	<span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_kappa-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_kappa"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_kappa-641"><a href="#get_kappa-641"><span class="linenos">641</span></a><span class="k">def</span> <span class="nf">get_kappa</span><span class="p">(</span>
</span><span id="get_kappa-642"><a href="#get_kappa-642"><span class="linenos">642</span></a>    <span class="n">scheme</span><span class="p">:</span> <span class="n">Scheme</span><span class="p">,</span>
</span><span id="get_kappa-643"><a href="#get_kappa-643"><span class="linenos">643</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="get_kappa-644"><a href="#get_kappa-644"><span class="linenos">644</span></a>    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;eckart&quot;</span><span class="p">,</span>
</span><span id="get_kappa-645"><a href="#get_kappa-645"><span class="linenos">645</span></a>    <span class="n">qrrho</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa: FBT001, FBT002</span>
</span><span id="get_kappa-646"><a href="#get_kappa-646"><span class="linenos">646</span></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">298.15</span><span class="p">,</span>
</span><span id="get_kappa-647"><a href="#get_kappa-647"><span class="linenos">647</span></a><span class="p">):</span>
</span><span id="get_kappa-648"><a href="#get_kappa-648"><span class="linenos">648</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Obtain tunneling transmission coefficients at a given temperature.</span>
</span><span id="get_kappa-649"><a href="#get_kappa-649"><span class="linenos">649</span></a>
</span><span id="get_kappa-650"><a href="#get_kappa-650"><span class="linenos">650</span></a><span class="sd">    One tunneling transmission coefficient is calculated for each reaction. If</span>
</span><span id="get_kappa-651"><a href="#get_kappa-651"><span class="linenos">651</span></a><span class="sd">    a reaction lacks a transition state (i.e., a half-equilibrium reaction),</span>
</span><span id="get_kappa-652"><a href="#get_kappa-652"><span class="linenos">652</span></a><span class="sd">    its transmission coefficient is set to unity.</span>
</span><span id="get_kappa-653"><a href="#get_kappa-653"><span class="linenos">653</span></a>
</span><span id="get_kappa-654"><a href="#get_kappa-654"><span class="linenos">654</span></a><span class="sd">    Parameters</span>
</span><span id="get_kappa-655"><a href="#get_kappa-655"><span class="linenos">655</span></a><span class="sd">    ----------</span>
</span><span id="get_kappa-656"><a href="#get_kappa-656"><span class="linenos">656</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="get_kappa-657"><a href="#get_kappa-657"><span class="linenos">657</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="get_kappa-658"><a href="#get_kappa-658"><span class="linenos">658</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_kappa-659"><a href="#get_kappa-659"><span class="linenos">659</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_kappa-660"><a href="#get_kappa-660"><span class="linenos">660</span></a><span class="sd">    compounds : dict-like</span>
</span><span id="get_kappa-661"><a href="#get_kappa-661"><span class="linenos">661</span></a><span class="sd">        A descriptor of the compounds.</span>
</span><span id="get_kappa-662"><a href="#get_kappa-662"><span class="linenos">662</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="get_kappa-663"><a href="#get_kappa-663"><span class="linenos">663</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="get_kappa-664"><a href="#get_kappa-664"><span class="linenos">664</span></a><span class="sd">    method : str or None, optional</span>
</span><span id="get_kappa-665"><a href="#get_kappa-665"><span class="linenos">665</span></a><span class="sd">        Choose between &quot;eckart&quot;, &quot;wigner&quot; or None (or &quot;none&quot;).</span>
</span><span id="get_kappa-666"><a href="#get_kappa-666"><span class="linenos">666</span></a><span class="sd">    qrrho : bool, optional</span>
</span><span id="get_kappa-667"><a href="#get_kappa-667"><span class="linenos">667</span></a><span class="sd">        Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)</span>
</span><span id="get_kappa-668"><a href="#get_kappa-668"><span class="linenos">668</span></a><span class="sd">        approximations of M. Head-Gordon and others (enthalpy correction, see</span>
</span><span id="get_kappa-669"><a href="#get_kappa-669"><span class="linenos">669</span></a><span class="sd">        [*J. Phys. Chem. C* **2015**, 119, 4, 1840-1850](http://dx.doi.org/10.1021/jp509921r))</span>
</span><span id="get_kappa-670"><a href="#get_kappa-670"><span class="linenos">670</span></a><span class="sd">        and S. Grimme (entropy correction, see</span>
</span><span id="get_kappa-671"><a href="#get_kappa-671"><span class="linenos">671</span></a><span class="sd">        [*Theory. Chem. Eur. J.*, **2012**, 18: 9955-9964](https://doi.org/10.1002/chem.201200497))</span>
</span><span id="get_kappa-672"><a href="#get_kappa-672"><span class="linenos">672</span></a><span class="sd">        on top of the classical RRHO.</span>
</span><span id="get_kappa-673"><a href="#get_kappa-673"><span class="linenos">673</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_kappa-674"><a href="#get_kappa-674"><span class="linenos">674</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_kappa-675"><a href="#get_kappa-675"><span class="linenos">675</span></a>
</span><span id="get_kappa-676"><a href="#get_kappa-676"><span class="linenos">676</span></a><span class="sd">    Returns</span>
</span><span id="get_kappa-677"><a href="#get_kappa-677"><span class="linenos">677</span></a><span class="sd">    -------</span>
</span><span id="get_kappa-678"><a href="#get_kappa-678"><span class="linenos">678</span></a><span class="sd">    array-like</span>
</span><span id="get_kappa-679"><a href="#get_kappa-679"><span class="linenos">679</span></a>
</span><span id="get_kappa-680"><a href="#get_kappa-680"><span class="linenos">680</span></a><span class="sd">    Raises</span>
</span><span id="get_kappa-681"><a href="#get_kappa-681"><span class="linenos">681</span></a><span class="sd">    ------</span>
</span><span id="get_kappa-682"><a href="#get_kappa-682"><span class="linenos">682</span></a><span class="sd">    ValueError</span>
</span><span id="get_kappa-683"><a href="#get_kappa-683"><span class="linenos">683</span></a><span class="sd">        If `method` is not supported.</span>
</span><span id="get_kappa-684"><a href="#get_kappa-684"><span class="linenos">684</span></a>
</span><span id="get_kappa-685"><a href="#get_kappa-685"><span class="linenos">685</span></a><span class="sd">    Examples</span>
</span><span id="get_kappa-686"><a href="#get_kappa-686"><span class="linenos">686</span></a><span class="sd">    --------</span>
</span><span id="get_kappa-687"><a href="#get_kappa-687"><span class="linenos">687</span></a><span class="sd">    Below is an example of an estimate of how much quantum tunneling</span>
</span><span id="get_kappa-688"><a href="#get_kappa-688"><span class="linenos">688</span></a><span class="sd">    contributes to the rate of methyl rotation in ethane (see</span>
</span><span id="get_kappa-689"><a href="#get_kappa-689"><span class="linenos">689</span></a><span class="sd">    [*Science*, **2006**, 313, 5795, 1951-1955](https://doi.org/10.1126/science.1132178)</span>
</span><span id="get_kappa-690"><a href="#get_kappa-690"><span class="linenos">690</span></a><span class="sd">    for some interesting experimental data on this reaction).</span>
</span><span id="get_kappa-691"><a href="#get_kappa-691"><span class="linenos">691</span></a>
</span><span id="get_kappa-692"><a href="#get_kappa-692"><span class="linenos">692</span></a><span class="sd">    &gt;&gt;&gt; model = rx.parse_model(&quot;data/ethane/B97-3c/model.k&quot;)</span>
</span><span id="get_kappa-693"><a href="#get_kappa-693"><span class="linenos">693</span></a><span class="sd">    &gt;&gt;&gt; kappa = get_kappa(model.scheme, model.compounds)</span>
</span><span id="get_kappa-694"><a href="#get_kappa-694"><span class="linenos">694</span></a><span class="sd">    &gt;&gt;&gt; kappa</span>
</span><span id="get_kappa-695"><a href="#get_kappa-695"><span class="linenos">695</span></a><span class="sd">    array([1.110])</span>
</span><span id="get_kappa-696"><a href="#get_kappa-696"><span class="linenos">696</span></a><span class="sd">    &gt;&gt;&gt; get_kappa(model.scheme, model.compounds, method=&quot;none&quot;)</span>
</span><span id="get_kappa-697"><a href="#get_kappa-697"><span class="linenos">697</span></a><span class="sd">    array([1.0])</span>
</span><span id="get_kappa-698"><a href="#get_kappa-698"><span class="linenos">698</span></a><span class="sd">    &gt;&gt;&gt; get_kappa(model.scheme, model.compounds, method=&quot;none&quot;) \</span>
</span><span id="get_kappa-699"><a href="#get_kappa-699"><span class="linenos">699</span></a><span class="sd">    ... == get_kappa(model.scheme, model.compounds, method=None)</span>
</span><span id="get_kappa-700"><a href="#get_kappa-700"><span class="linenos">700</span></a><span class="sd">    array([ True])</span>
</span><span id="get_kappa-701"><a href="#get_kappa-701"><span class="linenos">701</span></a>
</span><span id="get_kappa-702"><a href="#get_kappa-702"><span class="linenos">702</span></a><span class="sd">    You can calculate each piece of the reaction rate constant by hand,</span>
</span><span id="get_kappa-703"><a href="#get_kappa-703"><span class="linenos">703</span></a><span class="sd">    if you want. Just make sure that you don&#39;t calculate the tunneling</span>
</span><span id="get_kappa-704"><a href="#get_kappa-704"><span class="linenos">704</span></a><span class="sd">    coefficient twice:</span>
</span><span id="get_kappa-705"><a href="#get_kappa-705"><span class="linenos">705</span></a>
</span><span id="get_kappa-706"><a href="#get_kappa-706"><span class="linenos">706</span></a><span class="sd">    &gt;&gt;&gt; kappa * get_k(model.scheme, model.compounds, tunneling=None)</span>
</span><span id="get_kappa-707"><a href="#get_kappa-707"><span class="linenos">707</span></a><span class="sd">    array([8.e+10])</span>
</span><span id="get_kappa-708"><a href="#get_kappa-708"><span class="linenos">708</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="get_kappa-709"><a href="#get_kappa-709"><span class="linenos">709</span></a>    <span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">_check_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
</span><span id="get_kappa-710"><a href="#get_kappa-710"><span class="linenos">710</span></a>    <span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">_check_compounds</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="get_kappa-711"><a href="#get_kappa-711"><span class="linenos">711</span></a>
</span><span id="get_kappa-712"><a href="#get_kappa-712"><span class="linenos">712</span></a>    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;eckart&quot;</span><span class="p">:</span>
</span><span id="get_kappa-713"><a href="#get_kappa-713"><span class="linenos">713</span></a>        <span class="c1"># NOTE(schneiderfelipe): We need electronic energies + ZPE here, so we</span>
</span><span id="get_kappa-714"><a href="#get_kappa-714"><span class="linenos">714</span></a>        <span class="c1"># get smaller transmission coefficients.</span>
</span><span id="get_kappa-715"><a href="#get_kappa-715"><span class="linenos">715</span></a>        <span class="n">energies</span> <span class="o">=</span> <span class="n">get_enthalpies</span><span class="p">(</span><span class="n">compounds</span><span class="p">,</span> <span class="n">qrrho</span><span class="o">=</span><span class="n">qrrho</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="get_kappa-716"><a href="#get_kappa-716"><span class="linenos">716</span></a>        <span class="n">delta_forward</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_delta</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">energies</span><span class="p">)</span>  <span class="c1"># B - A</span>
</span><span id="get_kappa-717"><a href="#get_kappa-717"><span class="linenos">717</span></a>        <span class="n">delta_backward</span> <span class="o">=</span> <span class="n">delta_forward</span> <span class="o">-</span> <span class="n">rx</span><span class="o">.</span><span class="n">get_delta</span><span class="p">(</span>
</span><span id="get_kappa-718"><a href="#get_kappa-718"><span class="linenos">718</span></a>            <span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">energies</span>
</span><span id="get_kappa-719"><a href="#get_kappa-719"><span class="linenos">719</span></a>        <span class="p">)</span>  <span class="c1"># B - C == B - A - (C - A)</span>
</span><span id="get_kappa-720"><a href="#get_kappa-720"><span class="linenos">720</span></a>
</span><span id="get_kappa-721"><a href="#get_kappa-721"><span class="linenos">721</span></a>    <span class="n">kappas</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="get_kappa-722"><a href="#get_kappa-722"><span class="linenos">722</span></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
</span><span id="get_kappa-723"><a href="#get_kappa-723"><span class="linenos">723</span></a>        <span class="n">rx</span><span class="o">.</span><span class="n">get_transition_states</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">)</span>
</span><span id="get_kappa-724"><a href="#get_kappa-724"><span class="linenos">724</span></a>    <span class="p">):</span>
</span><span id="get_kappa-725"><a href="#get_kappa-725"><span class="linenos">725</span></a>        <span class="k">if</span> <span class="n">ts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_kappa-726"><a href="#get_kappa-726"><span class="linenos">726</span></a>            <span class="n">kappas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
</span><span id="get_kappa-727"><a href="#get_kappa-727"><span class="linenos">727</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="get_kappa-728"><a href="#get_kappa-728"><span class="linenos">728</span></a>            <span class="n">transition_state</span> <span class="o">=</span> <span class="n">scheme</span><span class="o">.</span><span class="n">compounds</span><span class="p">[</span><span class="n">ts</span><span class="p">]</span>
</span><span id="get_kappa-729"><a href="#get_kappa-729"><span class="linenos">729</span></a>            <span class="n">vibfreq</span> <span class="o">=</span> <span class="n">compounds</span><span class="p">[</span><span class="n">transition_state</span><span class="p">]</span><span class="o">.</span><span class="n">vibfreqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="get_kappa-730"><a href="#get_kappa-730"><span class="linenos">730</span></a>
</span><span id="get_kappa-731"><a href="#get_kappa-731"><span class="linenos">731</span></a>            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;eckart&quot;</span><span class="p">:</span>
</span><span id="get_kappa-732"><a href="#get_kappa-732"><span class="linenos">732</span></a>                <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
</span><span id="get_kappa-733"><a href="#get_kappa-733"><span class="linenos">733</span></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
</span><span id="get_kappa-734"><a href="#get_kappa-734"><span class="linenos">734</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="get_kappa-735"><a href="#get_kappa-735"><span class="linenos">735</span></a>                        <span class="n">kappa</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="n">eckart</span><span class="p">(</span>
</span><span id="get_kappa-736"><a href="#get_kappa-736"><span class="linenos">736</span></a>                            <span class="n">vibfreq</span><span class="p">,</span>
</span><span id="get_kappa-737"><a href="#get_kappa-737"><span class="linenos">737</span></a>                            <span class="n">delta_forward</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="get_kappa-738"><a href="#get_kappa-738"><span class="linenos">738</span></a>                            <span class="n">delta_backward</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="get_kappa-739"><a href="#get_kappa-739"><span class="linenos">739</span></a>                            <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span>
</span><span id="get_kappa-740"><a href="#get_kappa-740"><span class="linenos">740</span></a>                        <span class="p">)</span>
</span><span id="get_kappa-741"><a href="#get_kappa-741"><span class="linenos">741</span></a>                    <span class="k">except</span> <span class="ne">RuntimeWarning</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="get_kappa-742"><a href="#get_kappa-742"><span class="linenos">742</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;using Wigner tunneling correction: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="get_kappa-743"><a href="#get_kappa-743"><span class="linenos">743</span></a>                        <span class="n">kappa</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="n">wigner</span><span class="p">(</span><span class="n">vibfreq</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">)</span>
</span><span id="get_kappa-744"><a href="#get_kappa-744"><span class="linenos">744</span></a>            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;wigner&quot;</span><span class="p">:</span>
</span><span id="get_kappa-745"><a href="#get_kappa-745"><span class="linenos">745</span></a>                <span class="n">kappa</span> <span class="o">=</span> <span class="n">tunnel</span><span class="o">.</span><span class="n">wigner</span><span class="p">(</span><span class="n">vibfreq</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">)</span>
</span><span id="get_kappa-746"><a href="#get_kappa-746"><span class="linenos">746</span></a>            <span class="k">elif</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">}:</span>
</span><span id="get_kappa-747"><a href="#get_kappa-747"><span class="linenos">747</span></a>                <span class="n">kappa</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="get_kappa-748"><a href="#get_kappa-748"><span class="linenos">748</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="get_kappa-749"><a href="#get_kappa-749"><span class="linenos">749</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unavailable method: &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>  <span class="c1"># noqa: EM102</span>
</span><span id="get_kappa-750"><a href="#get_kappa-750"><span class="linenos">750</span></a>
</span><span id="get_kappa-751"><a href="#get_kappa-751"><span class="linenos">751</span></a>            <span class="n">kappas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kappa</span><span class="p">)</span>
</span><span id="get_kappa-752"><a href="#get_kappa-752"><span class="linenos">752</span></a>
</span><span id="get_kappa-753"><a href="#get_kappa-753"><span class="linenos">753</span></a>    <span class="c1"># TODO(schneiderfelipe): is this correct? shouldn&#39;t we correct shapes</span>
</span><span id="get_kappa-754"><a href="#get_kappa-754"><span class="linenos">754</span></a>    <span class="c1"># somewhere else?</span>
</span><span id="get_kappa-755"><a href="#get_kappa-755"><span class="linenos">755</span></a>    <span class="n">vec_kappas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">kappas</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</span><span id="get_kappa-756"><a href="#get_kappa-756"><span class="linenos">756</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="get_kappa-757"><a href="#get_kappa-757"><span class="linenos">757</span></a>        <span class="s2">&quot;(quantum) tunneling coefficients: &quot;</span>
</span><span id="get_kappa-758"><a href="#get_kappa-758"><span class="linenos">758</span></a>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">kappa</span><span class="si">:</span><span class="s1">7.3g</span><span class="si">}</span><span class="s1">&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">kappa</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">vec_kappas</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="get_kappa-759"><a href="#get_kappa-759"><span class="linenos">759</span></a>    <span class="p">)</span>
</span><span id="get_kappa-760"><a href="#get_kappa-760"><span class="linenos">760</span></a>    <span class="k">return</span> <span class="n">vec_kappas</span>
</span></pre></div>


            <div class="docstring"><p>Obtain tunneling transmission coefficients at a given temperature.</p>

<p>One tunneling transmission coefficient is calculated for each reaction. If
a reaction lacks a transition state (i.e., a half-equilibrium reaction),
its transmission coefficient is set to unity.</p>

<h2 id="parameters">Parameters</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
compounds : dict-like
    A descriptor of the compounds.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.
method : str or None, optional
    Choose between "eckart", "wigner" or None (or "none").
qrrho : bool, optional
    Apply both the quasi-rigid rotor harmonic oscillator (QRRHO)
    approximations of M. Head-Gordon and others (enthalpy correction, see
    <a href="http://dx.doi.org/10.1021/jp509921r"><em>J. Phys. Chem. C</em> <strong>2015</strong>, 119, 4, 1840-1850</a>)
    and S. Grimme (entropy correction, see
    <a href="https://doi.org/10.1002/chem.201200497"><em>Theory. Chem. Eur. J.</em>, <strong>2012</strong>, 18: 9955-9964</a>)
    on top of the classical RRHO.
temperature : array-like, optional
    Absolute temperature in Kelvin.</p>

<h2 id="returns">Returns</h2>

<p>array-like</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If <code>method</code> is not supported.</p>

<h2 id="examples">Examples</h2>

<p>Below is an example of an estimate of how much quantum tunneling
contributes to the rate of methyl rotation in ethane (see
<a href="https://doi.org/10.1126/science.1132178"><em>Science</em>, <strong>2006</strong>, 313, 5795, 1951-1955</a>
for some interesting experimental data on this reaction).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span> <span class="o">=</span> <span class="n">get_kappa</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span>
<span class="go">array([1.110])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_kappa</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="go">array([1.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_kappa</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span> \
<span class="gp">... </span><span class="o">==</span> <span class="n">get_kappa</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">array([ True])</span>
</code></pre>
</div>

<p>You can calculate each piece of the reaction rate constant by hand,
if you want. Just make sure that you don't calculate the tunneling
coefficient twice:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">kappa</span> <span class="o">*</span> <span class="n">get_k</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">,</span> <span class="n">tunneling</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">array([8.e+10])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_reaction_entropies">
                            <input id="get_reaction_entropies-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_reaction_entropies</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">transform</span>, </span><span class="param"><span class="n">temperature</span><span class="o">=</span><span class="mf">298.15</span>, </span><span class="param"><span class="n">pressure</span><span class="o">=</span><span class="mf">101325.0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_reaction_entropies-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_reaction_entropies"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_reaction_entropies-846"><a href="#get_reaction_entropies-846"><span class="linenos">846</span></a><span class="k">def</span> <span class="nf">get_reaction_entropies</span><span class="p">(</span><span class="n">transform</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">298.15</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="n">constants</span><span class="o">.</span><span class="n">atm</span><span class="p">):</span>
</span><span id="get_reaction_entropies-847"><a href="#get_reaction_entropies-847"><span class="linenos">847</span></a><span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate entropy contributions from the overall reaction structure.</span>
</span><span id="get_reaction_entropies-848"><a href="#get_reaction_entropies-848"><span class="linenos">848</span></a>
</span><span id="get_reaction_entropies-849"><a href="#get_reaction_entropies-849"><span class="linenos">849</span></a><span class="sd">    This function currently implements the reaction translational entropy, a</span>
</span><span id="get_reaction_entropies-850"><a href="#get_reaction_entropies-850"><span class="linenos">850</span></a><span class="sd">    result of the indistinguishability of reactants or products, i.e., a</span>
</span><span id="get_reaction_entropies-851"><a href="#get_reaction_entropies-851"><span class="linenos">851</span></a><span class="sd">    difference in entropy of :math:`R ln 2!` for the reactions</span>
</span><span id="get_reaction_entropies-852"><a href="#get_reaction_entropies-852"><span class="linenos">852</span></a>
</span><span id="get_reaction_entropies-853"><a href="#get_reaction_entropies-853"><span class="linenos">853</span></a><span class="sd">    .. math::</span>
</span><span id="get_reaction_entropies-854"><a href="#get_reaction_entropies-854"><span class="linenos">854</span></a><span class="sd">        \ce{A + B -&gt; C}</span>
</span><span id="get_reaction_entropies-855"><a href="#get_reaction_entropies-855"><span class="linenos">855</span></a>
</span><span id="get_reaction_entropies-856"><a href="#get_reaction_entropies-856"><span class="linenos">856</span></a><span class="sd">    and</span>
</span><span id="get_reaction_entropies-857"><a href="#get_reaction_entropies-857"><span class="linenos">857</span></a>
</span><span id="get_reaction_entropies-858"><a href="#get_reaction_entropies-858"><span class="linenos">858</span></a><span class="sd">    .. math::</span>
</span><span id="get_reaction_entropies-859"><a href="#get_reaction_entropies-859"><span class="linenos">859</span></a><span class="sd">        \ce{2A -&gt; C}</span>
</span><span id="get_reaction_entropies-860"><a href="#get_reaction_entropies-860"><span class="linenos">860</span></a>
</span><span id="get_reaction_entropies-861"><a href="#get_reaction_entropies-861"><span class="linenos">861</span></a><span class="sd">    Parameters</span>
</span><span id="get_reaction_entropies-862"><a href="#get_reaction_entropies-862"><span class="linenos">862</span></a><span class="sd">    ----------</span>
</span><span id="get_reaction_entropies-863"><a href="#get_reaction_entropies-863"><span class="linenos">863</span></a><span class="sd">    transform : array-like</span>
</span><span id="get_reaction_entropies-864"><a href="#get_reaction_entropies-864"><span class="linenos">864</span></a><span class="sd">    temperature : array-like, optional</span>
</span><span id="get_reaction_entropies-865"><a href="#get_reaction_entropies-865"><span class="linenos">865</span></a><span class="sd">        Absolute temperature in Kelvin.</span>
</span><span id="get_reaction_entropies-866"><a href="#get_reaction_entropies-866"><span class="linenos">866</span></a><span class="sd">    pressure : array-like, optional</span>
</span><span id="get_reaction_entropies-867"><a href="#get_reaction_entropies-867"><span class="linenos">867</span></a><span class="sd">        Reference gas pressure.</span>
</span><span id="get_reaction_entropies-868"><a href="#get_reaction_entropies-868"><span class="linenos">868</span></a>
</span><span id="get_reaction_entropies-869"><a href="#get_reaction_entropies-869"><span class="linenos">869</span></a><span class="sd">    Returns</span>
</span><span id="get_reaction_entropies-870"><a href="#get_reaction_entropies-870"><span class="linenos">870</span></a><span class="sd">    -------</span>
</span><span id="get_reaction_entropies-871"><a href="#get_reaction_entropies-871"><span class="linenos">871</span></a><span class="sd">    delta_entropy : array-like</span>
</span><span id="get_reaction_entropies-872"><a href="#get_reaction_entropies-872"><span class="linenos">872</span></a>
</span><span id="get_reaction_entropies-873"><a href="#get_reaction_entropies-873"><span class="linenos">873</span></a><span class="sd">    Examples</span>
</span><span id="get_reaction_entropies-874"><a href="#get_reaction_entropies-874"><span class="linenos">874</span></a><span class="sd">    --------</span>
</span><span id="get_reaction_entropies-875"><a href="#get_reaction_entropies-875"><span class="linenos">875</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_reaction_entropies-876"><a href="#get_reaction_entropies-876"><span class="linenos">876</span></a>
</span><span id="get_reaction_entropies-877"><a href="#get_reaction_entropies-877"><span class="linenos">877</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A + B &lt;=&gt; C&quot;)</span>
</span><span id="get_reaction_entropies-878"><a href="#get_reaction_entropies-878"><span class="linenos">878</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A)</span>
</span><span id="get_reaction_entropies-879"><a href="#get_reaction_entropies-879"><span class="linenos">879</span></a><span class="sd">    array([0.0, 0.0])</span>
</span><span id="get_reaction_entropies-880"><a href="#get_reaction_entropies-880"><span class="linenos">880</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;2A &lt;=&gt; C&quot;)</span>
</span><span id="get_reaction_entropies-881"><a href="#get_reaction_entropies-881"><span class="linenos">881</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A)</span>
</span><span id="get_reaction_entropies-882"><a href="#get_reaction_entropies-882"><span class="linenos">882</span></a><span class="sd">    array([-5.763, 5.763])</span>
</span><span id="get_reaction_entropies-883"><a href="#get_reaction_entropies-883"><span class="linenos">883</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A, temperature=400.0)</span>
</span><span id="get_reaction_entropies-884"><a href="#get_reaction_entropies-884"><span class="linenos">884</span></a><span class="sd">    array([-5.763, 5.763])</span>
</span><span id="get_reaction_entropies-885"><a href="#get_reaction_entropies-885"><span class="linenos">885</span></a>
</span><span id="get_reaction_entropies-886"><a href="#get_reaction_entropies-886"><span class="linenos">886</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A &lt;=&gt; B + C&quot;)</span>
</span><span id="get_reaction_entropies-887"><a href="#get_reaction_entropies-887"><span class="linenos">887</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A)</span>
</span><span id="get_reaction_entropies-888"><a href="#get_reaction_entropies-888"><span class="linenos">888</span></a><span class="sd">    array([0.0, 0.0])</span>
</span><span id="get_reaction_entropies-889"><a href="#get_reaction_entropies-889"><span class="linenos">889</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A &lt;=&gt; 2B&quot;)</span>
</span><span id="get_reaction_entropies-890"><a href="#get_reaction_entropies-890"><span class="linenos">890</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A)</span>
</span><span id="get_reaction_entropies-891"><a href="#get_reaction_entropies-891"><span class="linenos">891</span></a><span class="sd">    array([ 5.763, -5.763])</span>
</span><span id="get_reaction_entropies-892"><a href="#get_reaction_entropies-892"><span class="linenos">892</span></a>
</span><span id="get_reaction_entropies-893"><a href="#get_reaction_entropies-893"><span class="linenos">893</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A + B -&gt; E# -&gt; C&quot;)</span>
</span><span id="get_reaction_entropies-894"><a href="#get_reaction_entropies-894"><span class="linenos">894</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A)</span>
</span><span id="get_reaction_entropies-895"><a href="#get_reaction_entropies-895"><span class="linenos">895</span></a><span class="sd">    array([0.0])</span>
</span><span id="get_reaction_entropies-896"><a href="#get_reaction_entropies-896"><span class="linenos">896</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.B)</span>
</span><span id="get_reaction_entropies-897"><a href="#get_reaction_entropies-897"><span class="linenos">897</span></a><span class="sd">    array([0.0])</span>
</span><span id="get_reaction_entropies-898"><a href="#get_reaction_entropies-898"><span class="linenos">898</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;2A -&gt; E# -&gt; C&quot;)</span>
</span><span id="get_reaction_entropies-899"><a href="#get_reaction_entropies-899"><span class="linenos">899</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.A)</span>
</span><span id="get_reaction_entropies-900"><a href="#get_reaction_entropies-900"><span class="linenos">900</span></a><span class="sd">    array([-5.763])</span>
</span><span id="get_reaction_entropies-901"><a href="#get_reaction_entropies-901"><span class="linenos">901</span></a><span class="sd">    &gt;&gt;&gt; get_reaction_entropies(scheme.B)</span>
</span><span id="get_reaction_entropies-902"><a href="#get_reaction_entropies-902"><span class="linenos">902</span></a><span class="sd">    array([-5.763])</span>
</span><span id="get_reaction_entropies-903"><a href="#get_reaction_entropies-903"><span class="linenos">903</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_reaction_entropies-904"><a href="#get_reaction_entropies-904"><span class="linenos">904</span></a>    <span class="n">sym</span> <span class="o">=</span> <span class="n">factorial</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">transform</span><span class="p">)))</span>
</span><span id="get_reaction_entropies-905"><a href="#get_reaction_entropies-905"><span class="linenos">905</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
</span><span id="get_reaction_entropies-906"><a href="#get_reaction_entropies-906"><span class="linenos">906</span></a>        <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span>
</span><span id="get_reaction_entropies-907"><a href="#get_reaction_entropies-907"><span class="linenos">907</span></a>        <span class="o">*</span> <span class="n">change_reference_state</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">),</span>
</span><span id="get_reaction_entropies-908"><a href="#get_reaction_entropies-908"><span class="linenos">908</span></a>        <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="get_reaction_entropies-909"><a href="#get_reaction_entropies-909"><span class="linenos">909</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate entropy contributions from the overall reaction structure.</p>

<p>This function currently implements the reaction translational entropy, a
result of the indistinguishability of reactants or products, i.e., a
difference in entropy of \( R ln 2! \) for the reactions</p>

<p>$$\ce{A + B -> C}$$</p>

<p>and</p>

<p>$$\ce{2A -> C}$$</p>

<h2 id="parameters">Parameters</h2>

<p>transform : array-like
temperature : array-like, optional
    Absolute temperature in Kelvin.
pressure : array-like, optional
    Reference gas pressure.</p>

<h2 id="returns">Returns</h2>

<p>delta_entropy : array-like</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A + B &lt;=&gt; C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([0.0, 0.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;2A &lt;=&gt; C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([-5.763, 5.763])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mf">400.0</span><span class="p">)</span>
<span class="go">array([-5.763, 5.763])</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A &lt;=&gt; B + C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([0.0, 0.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A &lt;=&gt; 2B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([ 5.763, -5.763])</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A + B -&gt; E# -&gt; C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([0.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
<span class="go">array([0.0])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;2A -&gt; E# -&gt; C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
<span class="go">array([-5.763])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_reaction_entropies</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">)</span>
<span class="go">array([-5.763])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_transition_states">
                            <input id="get_transition_states-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_transition_states</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span>, </span><span class="param"><span class="n">B</span>, </span><span class="param"><span class="n">is_half_equilibrium</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_transition_states-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_transition_states"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_transition_states-85"><a href="#get_transition_states-85"><span class="linenos"> 85</span></a><span class="k">def</span> <span class="nf">get_transition_states</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">):</span>  <span class="c1"># noqa: N803</span>
</span><span id="get_transition_states-86"><a href="#get_transition_states-86"><span class="linenos"> 86</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the indices of transition states for each reaction.</span>
</span><span id="get_transition_states-87"><a href="#get_transition_states-87"><span class="linenos"> 87</span></a>
</span><span id="get_transition_states-88"><a href="#get_transition_states-88"><span class="linenos"> 88</span></a><span class="sd">    Parameters</span>
</span><span id="get_transition_states-89"><a href="#get_transition_states-89"><span class="linenos"> 89</span></a><span class="sd">    ----------</span>
</span><span id="get_transition_states-90"><a href="#get_transition_states-90"><span class="linenos"> 90</span></a><span class="sd">    A, B : array-like</span>
</span><span id="get_transition_states-91"><a href="#get_transition_states-91"><span class="linenos"> 91</span></a><span class="sd">    is_half_equilibrium : sequence</span>
</span><span id="get_transition_states-92"><a href="#get_transition_states-92"><span class="linenos"> 92</span></a>
</span><span id="get_transition_states-93"><a href="#get_transition_states-93"><span class="linenos"> 93</span></a><span class="sd">    Returns</span>
</span><span id="get_transition_states-94"><a href="#get_transition_states-94"><span class="linenos"> 94</span></a><span class="sd">    -------</span>
</span><span id="get_transition_states-95"><a href="#get_transition_states-95"><span class="linenos"> 95</span></a><span class="sd">    sequence</span>
</span><span id="get_transition_states-96"><a href="#get_transition_states-96"><span class="linenos"> 96</span></a>
</span><span id="get_transition_states-97"><a href="#get_transition_states-97"><span class="linenos"> 97</span></a><span class="sd">    Examples</span>
</span><span id="get_transition_states-98"><a href="#get_transition_states-98"><span class="linenos"> 98</span></a><span class="sd">    --------</span>
</span><span id="get_transition_states-99"><a href="#get_transition_states-99"><span class="linenos"> 99</span></a><span class="sd">    &gt;&gt;&gt; scheme = parse_reactions(&quot;A -&gt; B&quot;)</span>
</span><span id="get_transition_states-100"><a href="#get_transition_states-100"><span class="linenos">100</span></a><span class="sd">    &gt;&gt;&gt; print(scheme)</span>
</span><span id="get_transition_states-101"><a href="#get_transition_states-101"><span class="linenos">101</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
</span><span id="get_transition_states-102"><a href="#get_transition_states-102"><span class="linenos">102</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="get_transition_states-103"><a href="#get_transition_states-103"><span class="linenos">103</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="get_transition_states-104"><a href="#get_transition_states-104"><span class="linenos">104</span></a><span class="sd">           A=((-1.,), (1.,)),</span>
</span><span id="get_transition_states-105"><a href="#get_transition_states-105"><span class="linenos">105</span></a><span class="sd">           B=((-1.,), (1.,)))</span>
</span><span id="get_transition_states-106"><a href="#get_transition_states-106"><span class="linenos">106</span></a><span class="sd">    &gt;&gt;&gt; get_transition_states(scheme.A, scheme.B, scheme.is_half_equilibrium)</span>
</span><span id="get_transition_states-107"><a href="#get_transition_states-107"><span class="linenos">107</span></a><span class="sd">    (None,)</span>
</span><span id="get_transition_states-108"><a href="#get_transition_states-108"><span class="linenos">108</span></a>
</span><span id="get_transition_states-109"><a href="#get_transition_states-109"><span class="linenos">109</span></a><span class="sd">    &gt;&gt;&gt; scheme = parse_reactions(&quot;S -&gt; E‚Ä° -&gt; S&quot;)</span>
</span><span id="get_transition_states-110"><a href="#get_transition_states-110"><span class="linenos">110</span></a><span class="sd">    &gt;&gt;&gt; print(scheme)</span>
</span><span id="get_transition_states-111"><a href="#get_transition_states-111"><span class="linenos">111</span></a><span class="sd">    Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
</span><span id="get_transition_states-112"><a href="#get_transition_states-112"><span class="linenos">112</span></a><span class="sd">           reactions=(&#39;S -&gt; S&#39;,),</span>
</span><span id="get_transition_states-113"><a href="#get_transition_states-113"><span class="linenos">113</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="get_transition_states-114"><a href="#get_transition_states-114"><span class="linenos">114</span></a><span class="sd">           A=((0.,), (0.,)),</span>
</span><span id="get_transition_states-115"><a href="#get_transition_states-115"><span class="linenos">115</span></a><span class="sd">           B=((-1.,), (1.,)))</span>
</span><span id="get_transition_states-116"><a href="#get_transition_states-116"><span class="linenos">116</span></a><span class="sd">    &gt;&gt;&gt; get_transition_states(scheme.A, scheme.B, scheme.is_half_equilibrium)</span>
</span><span id="get_transition_states-117"><a href="#get_transition_states-117"><span class="linenos">117</span></a><span class="sd">    (1,)</span>
</span><span id="get_transition_states-118"><a href="#get_transition_states-118"><span class="linenos">118</span></a>
</span><span id="get_transition_states-119"><a href="#get_transition_states-119"><span class="linenos">119</span></a><span class="sd">    &gt;&gt;&gt; scheme = parse_reactions(&quot;E + S &lt;=&gt; ES -&gt; ES‚Ä° -&gt; E + P&quot;)</span>
</span><span id="get_transition_states-120"><a href="#get_transition_states-120"><span class="linenos">120</span></a><span class="sd">    &gt;&gt;&gt; print(scheme)</span>
</span><span id="get_transition_states-121"><a href="#get_transition_states-121"><span class="linenos">121</span></a><span class="sd">    Scheme(compounds=(&#39;E&#39;, &#39;S&#39;, &#39;ES&#39;, &#39;ES‚Ä°&#39;, &#39;P&#39;),</span>
</span><span id="get_transition_states-122"><a href="#get_transition_states-122"><span class="linenos">122</span></a><span class="sd">           reactions=(&#39;E + S -&gt; ES&#39;, &#39;ES -&gt; E + S&#39;, &#39;ES -&gt; E + P&#39;),</span>
</span><span id="get_transition_states-123"><a href="#get_transition_states-123"><span class="linenos">123</span></a><span class="sd">           is_half_equilibrium=(True,  True, False),</span>
</span><span id="get_transition_states-124"><a href="#get_transition_states-124"><span class="linenos">124</span></a><span class="sd">           A=((-1.,  1.,  1.),</span>
</span><span id="get_transition_states-125"><a href="#get_transition_states-125"><span class="linenos">125</span></a><span class="sd">              (-1.,  1.,  0.),</span>
</span><span id="get_transition_states-126"><a href="#get_transition_states-126"><span class="linenos">126</span></a><span class="sd">              (1., -1., -1.),</span>
</span><span id="get_transition_states-127"><a href="#get_transition_states-127"><span class="linenos">127</span></a><span class="sd">              (0.,  0.,  0.),</span>
</span><span id="get_transition_states-128"><a href="#get_transition_states-128"><span class="linenos">128</span></a><span class="sd">              (0.,  0.,  1.)),</span>
</span><span id="get_transition_states-129"><a href="#get_transition_states-129"><span class="linenos">129</span></a><span class="sd">           B=((-1.,  0.,  0.),</span>
</span><span id="get_transition_states-130"><a href="#get_transition_states-130"><span class="linenos">130</span></a><span class="sd">              (-1.,  0.,  0.),</span>
</span><span id="get_transition_states-131"><a href="#get_transition_states-131"><span class="linenos">131</span></a><span class="sd">              (1.,  0., -1.),</span>
</span><span id="get_transition_states-132"><a href="#get_transition_states-132"><span class="linenos">132</span></a><span class="sd">              (0.,  0.,  1.),</span>
</span><span id="get_transition_states-133"><a href="#get_transition_states-133"><span class="linenos">133</span></a><span class="sd">              (0.,  0.,  0.)))</span>
</span><span id="get_transition_states-134"><a href="#get_transition_states-134"><span class="linenos">134</span></a><span class="sd">    &gt;&gt;&gt; get_transition_states(scheme.A, scheme.B, scheme.is_half_equilibrium)</span>
</span><span id="get_transition_states-135"><a href="#get_transition_states-135"><span class="linenos">135</span></a><span class="sd">    (None, None, 3)</span>
</span><span id="get_transition_states-136"><a href="#get_transition_states-136"><span class="linenos">136</span></a>
</span><span id="get_transition_states-137"><a href="#get_transition_states-137"><span class="linenos">137</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_transition_states-138"><a href="#get_transition_states-138"><span class="linenos">138</span></a>    <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>  <span class="c1"># transition state matrix</span>
</span><span id="get_transition_states-139"><a href="#get_transition_states-139"><span class="linenos">139</span></a>    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
</span><span id="get_transition_states-140"><a href="#get_transition_states-140"><span class="linenos">140</span></a>        <span class="n">x</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">is_half_equilibrium</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">and</span> <span class="n">tau</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="get_transition_states-141"><a href="#get_transition_states-141"><span class="linenos">141</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</span><span id="get_transition_states-142"><a href="#get_transition_states-142"><span class="linenos">142</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the indices of transition states for each reaction.</p>

<h2 id="parameters">Parameters</h2>

<p>A, B : array-like
is_half_equilibrium : sequence</p>

<h2 id="returns">Returns</h2>

<p>sequence</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A -&gt; B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((-1.,), (1.,)),</span>
<span class="go">       B=((-1.,), (1.,)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_transition_states</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">)</span>
<span class="go">(None,)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;S -&gt; E‚Ä° -&gt; S&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
<span class="go">       reactions=(&#39;S -&gt; S&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((0.,), (0.,)),</span>
<span class="go">       B=((-1.,), (1.,)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_transition_states</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">)</span>
<span class="go">(1,)</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;E + S &lt;=&gt; ES -&gt; ES‚Ä° -&gt; E + P&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;E&#39;, &#39;S&#39;, &#39;ES&#39;, &#39;ES‚Ä°&#39;, &#39;P&#39;),</span>
<span class="go">       reactions=(&#39;E + S -&gt; ES&#39;, &#39;ES -&gt; E + S&#39;, &#39;ES -&gt; E + P&#39;),</span>
<span class="go">       is_half_equilibrium=(True,  True, False),</span>
<span class="go">       A=((-1.,  1.,  1.),</span>
<span class="go">          (-1.,  1.,  0.),</span>
<span class="go">          (1., -1., -1.),</span>
<span class="go">          (0.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  1.)),</span>
<span class="go">       B=((-1.,  0.,  0.),</span>
<span class="go">          (-1.,  0.,  0.),</span>
<span class="go">          (1.,  0., -1.),</span>
<span class="go">          (0.,  0.,  1.),</span>
<span class="go">          (0.,  0.,  0.)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_transition_states</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">)</span>
<span class="go">(None, None, 3)</span>
</code></pre>
</div>
</div>


                </section>
                <section id="get_y">
                            <input id="get_y-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_y</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">dydt</span>,</span><span class="param">	<span class="n">y0</span>,</span><span class="param">	<span class="n">t_span</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">method</span><span class="o">=</span><span class="s1">&#39;LSODA&#39;</span>,</span><span class="param">	<span class="n">rtol</span><span class="o">=</span><span class="mf">0.001</span>,</span><span class="param">	<span class="n">atol</span><span class="o">=</span><span class="mf">1e-06</span>,</span><span class="param">	<span class="n">max_time</span><span class="o">=</span><span class="mi">3600</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_y-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_y"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_y-60"><a href="#get_y-60"><span class="linenos"> 60</span></a><span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span>
</span><span id="get_y-61"><a href="#get_y-61"><span class="linenos"> 61</span></a>    <span class="n">dydt</span><span class="p">,</span>
</span><span id="get_y-62"><a href="#get_y-62"><span class="linenos"> 62</span></a>    <span class="n">y0</span><span class="p">,</span>
</span><span id="get_y-63"><a href="#get_y-63"><span class="linenos"> 63</span></a>    <span class="n">t_span</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="get_y-64"><a href="#get_y-64"><span class="linenos"> 64</span></a>    <span class="n">method</span><span class="o">=</span><span class="s2">&quot;LSODA&quot;</span><span class="p">,</span>
</span><span id="get_y-65"><a href="#get_y-65"><span class="linenos"> 65</span></a>    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
</span><span id="get_y-66"><a href="#get_y-66"><span class="linenos"> 66</span></a>    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>
</span><span id="get_y-67"><a href="#get_y-67"><span class="linenos"> 67</span></a>    <span class="n">max_time</span><span class="o">=</span><span class="mi">1</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="p">,</span>
</span><span id="get_y-68"><a href="#get_y-68"><span class="linenos"> 68</span></a><span class="p">):</span>
</span><span id="get_y-69"><a href="#get_y-69"><span class="linenos"> 69</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate a reaction scheme from its rate function.</span>
</span><span id="get_y-70"><a href="#get_y-70"><span class="linenos"> 70</span></a>
</span><span id="get_y-71"><a href="#get_y-71"><span class="linenos"> 71</span></a><span class="sd">    This function provides two functions that calculate the concentrations and</span>
</span><span id="get_y-72"><a href="#get_y-72"><span class="linenos"> 72</span></a><span class="sd">    the rates of formation at any point in time for any compound. It does that</span>
</span><span id="get_y-73"><a href="#get_y-73"><span class="linenos"> 73</span></a><span class="sd">    by solving an initial value problem (IVP) through scipy&#39;s ``solve_ivp``</span>
</span><span id="get_y-74"><a href="#get_y-74"><span class="linenos"> 74</span></a><span class="sd">    under the hood.</span>
</span><span id="get_y-75"><a href="#get_y-75"><span class="linenos"> 75</span></a>
</span><span id="get_y-76"><a href="#get_y-76"><span class="linenos"> 76</span></a><span class="sd">    Parameters</span>
</span><span id="get_y-77"><a href="#get_y-77"><span class="linenos"> 77</span></a><span class="sd">    ----------</span>
</span><span id="get_y-78"><a href="#get_y-78"><span class="linenos"> 78</span></a><span class="sd">    dydt : callable</span>
</span><span id="get_y-79"><a href="#get_y-79"><span class="linenos"> 79</span></a><span class="sd">        Right-hand side of the system.</span>
</span><span id="get_y-80"><a href="#get_y-80"><span class="linenos"> 80</span></a><span class="sd">    y0 : array-like</span>
</span><span id="get_y-81"><a href="#get_y-81"><span class="linenos"> 81</span></a><span class="sd">        Initial state.</span>
</span><span id="get_y-82"><a href="#get_y-82"><span class="linenos"> 82</span></a><span class="sd">    t_span : array-like, optional</span>
</span><span id="get_y-83"><a href="#get_y-83"><span class="linenos"> 83</span></a><span class="sd">        Interval of integration (t0, tf). The solver starts with t=t0 and</span>
</span><span id="get_y-84"><a href="#get_y-84"><span class="linenos"> 84</span></a><span class="sd">        integrates until it reaches t=tf. If not given, a conservative value</span>
</span><span id="get_y-85"><a href="#get_y-85"><span class="linenos"> 85</span></a><span class="sd">        is chosen based on the system at hand (the method of choice works for</span>
</span><span id="get_y-86"><a href="#get_y-86"><span class="linenos"> 86</span></a><span class="sd">        any zeroth-, first- or second-order reactions).</span>
</span><span id="get_y-87"><a href="#get_y-87"><span class="linenos"> 87</span></a><span class="sd">    method : str, optional</span>
</span><span id="get_y-88"><a href="#get_y-88"><span class="linenos"> 88</span></a><span class="sd">        Integration method to use. See `scipy.integrate.solve_ivp` for details.</span>
</span><span id="get_y-89"><a href="#get_y-89"><span class="linenos"> 89</span></a><span class="sd">        Kinetics problems are very often stiff and, as such, &quot;RK45&quot; is</span>
</span><span id="get_y-90"><a href="#get_y-90"><span class="linenos"> 90</span></a><span class="sd">        normally unsuited. &quot;Radau&quot;, &quot;BDF&quot; or &quot;LSODA&quot; are good choices.</span>
</span><span id="get_y-91"><a href="#get_y-91"><span class="linenos"> 91</span></a><span class="sd">    rtol, atol : array-like</span>
</span><span id="get_y-92"><a href="#get_y-92"><span class="linenos"> 92</span></a><span class="sd">        See `scipy.integrate.solve_ivp` for details.</span>
</span><span id="get_y-93"><a href="#get_y-93"><span class="linenos"> 93</span></a><span class="sd">    max_time : float, optional</span>
</span><span id="get_y-94"><a href="#get_y-94"><span class="linenos"> 94</span></a><span class="sd">        If `t_span` is not given, an interval will be estimated, but it can&#39;t</span>
</span><span id="get_y-95"><a href="#get_y-95"><span class="linenos"> 95</span></a><span class="sd">        be larger than this parameter.</span>
</span><span id="get_y-96"><a href="#get_y-96"><span class="linenos"> 96</span></a>
</span><span id="get_y-97"><a href="#get_y-97"><span class="linenos"> 97</span></a><span class="sd">    Returns</span>
</span><span id="get_y-98"><a href="#get_y-98"><span class="linenos"> 98</span></a><span class="sd">    -------</span>
</span><span id="get_y-99"><a href="#get_y-99"><span class="linenos"> 99</span></a><span class="sd">    y, r : callable</span>
</span><span id="get_y-100"><a href="#get_y-100"><span class="linenos">100</span></a><span class="sd">        Concentrations and reaction rates as functions of time. The y object</span>
</span><span id="get_y-101"><a href="#get_y-101"><span class="linenos">101</span></a><span class="sd">        is an OdeSolution and stores attributes t_min and t_max.</span>
</span><span id="get_y-102"><a href="#get_y-102"><span class="linenos">102</span></a>
</span><span id="get_y-103"><a href="#get_y-103"><span class="linenos">103</span></a>
</span><span id="get_y-104"><a href="#get_y-104"><span class="linenos">104</span></a><span class="sd">    Examples</span>
</span><span id="get_y-105"><a href="#get_y-105"><span class="linenos">105</span></a><span class="sd">    --------</span>
</span><span id="get_y-106"><a href="#get_y-106"><span class="linenos">106</span></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
</span><span id="get_y-107"><a href="#get_y-107"><span class="linenos">107</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="get_y-108"><a href="#get_y-108"><span class="linenos">108</span></a>
</span><span id="get_y-109"><a href="#get_y-109"><span class="linenos">109</span></a><span class="sd">    A toy simulation can be performed in just two lines:</span>
</span><span id="get_y-110"><a href="#get_y-110"><span class="linenos">110</span></a>
</span><span id="get_y-111"><a href="#get_y-111"><span class="linenos">111</span></a><span class="sd">    &gt;&gt;&gt; scheme = rx.parse_reactions(&quot;A &lt;=&gt; B&quot;)</span>
</span><span id="get_y-112"><a href="#get_y-112"><span class="linenos">112</span></a><span class="sd">    &gt;&gt;&gt; y, r = get_y(get_dydt(scheme, np.array([1, 1])), y0=[1, 0])</span>
</span><span id="get_y-113"><a href="#get_y-113"><span class="linenos">113</span></a>
</span><span id="get_y-114"><a href="#get_y-114"><span class="linenos">114</span></a><span class="sd">    The `y` object stores information about the simulation time, which can be</span>
</span><span id="get_y-115"><a href="#get_y-115"><span class="linenos">115</span></a><span class="sd">    used to produce a suitable vector of timepoints for, e.g., plotting:</span>
</span><span id="get_y-116"><a href="#get_y-116"><span class="linenos">116</span></a>
</span><span id="get_y-117"><a href="#get_y-117"><span class="linenos">117</span></a><span class="sd">    &gt;&gt;&gt; y.t_min, y.t_max  # doctest: +SKIP</span>
</span><span id="get_y-118"><a href="#get_y-118"><span class="linenos">118</span></a><span class="sd">    (0.0, 3.0)</span>
</span><span id="get_y-119"><a href="#get_y-119"><span class="linenos">119</span></a><span class="sd">    &gt;&gt;&gt; t = np.linspace(y.t_min, y.t_max)</span>
</span><span id="get_y-120"><a href="#get_y-120"><span class="linenos">120</span></a><span class="sd">    &gt;&gt;&gt; t  # doctest: +SKIP</span>
</span><span id="get_y-121"><a href="#get_y-121"><span class="linenos">121</span></a><span class="sd">    array([0. , 0.06122449, ..., 2.93877551, 3. ])</span>
</span><span id="get_y-122"><a href="#get_y-122"><span class="linenos">122</span></a>
</span><span id="get_y-123"><a href="#get_y-123"><span class="linenos">123</span></a><span class="sd">    Both `y` and `r` can be used to check concentrations and rates in any</span>
</span><span id="get_y-124"><a href="#get_y-124"><span class="linenos">124</span></a><span class="sd">    point in time. In particular, both are vectorized:</span>
</span><span id="get_y-125"><a href="#get_y-125"><span class="linenos">125</span></a>
</span><span id="get_y-126"><a href="#get_y-126"><span class="linenos">126</span></a><span class="sd">    &gt;&gt;&gt; y(t)  # doctest: +SKIP</span>
</span><span id="get_y-127"><a href="#get_y-127"><span class="linenos">127</span></a><span class="sd">    array([[1. , 0.94237559, ..., 0.5012394, 0.5 ],</span>
</span><span id="get_y-128"><a href="#get_y-128"><span class="linenos">128</span></a><span class="sd">           [0. , 0.05762441, ..., 0.4987606, 0.5 ]])</span>
</span><span id="get_y-129"><a href="#get_y-129"><span class="linenos">129</span></a><span class="sd">    &gt;&gt;&gt; r(t)  # doctest: +SKIP</span>
</span><span id="get_y-130"><a href="#get_y-130"><span class="linenos">130</span></a><span class="sd">    array([[-1.00000000e+00, ..., -1.39544265e-10],</span>
</span><span id="get_y-131"><a href="#get_y-131"><span class="linenos">131</span></a><span class="sd">           [ 1.00000000e+00, ...,  1.39544265e-10]])</span>
</span><span id="get_y-132"><a href="#get_y-132"><span class="linenos">132</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_y-133"><a href="#get_y-133"><span class="linenos">133</span></a>    <span class="c1"># TODO(schneiderfelipe): raise a meaningful error when y0 has the wrong shape.</span>
</span><span id="get_y-134"><a href="#get_y-134"><span class="linenos">134</span></a>    <span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
</span><span id="get_y-135"><a href="#get_y-135"><span class="linenos">135</span></a>
</span><span id="get_y-136"><a href="#get_y-136"><span class="linenos">136</span></a>    <span class="k">if</span> <span class="n">t_span</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="get_y-137"><a href="#get_y-137"><span class="linenos">137</span></a>        <span class="c1"># We defined alpha such that 1.0 - alpha is an (under)estimate of the extend</span>
</span><span id="get_y-138"><a href="#get_y-138"><span class="linenos">138</span></a>        <span class="c1"># to which the reaction is simulated. And then we apply the Pareto principle.</span>
</span><span id="get_y-139"><a href="#get_y-139"><span class="linenos">139</span></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.2</span>
</span><span id="get_y-140"><a href="#get_y-140"><span class="linenos">140</span></a>        <span class="n">n_halflives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span><span id="get_y-141"><a href="#get_y-141"><span class="linenos">141</span></a>
</span><span id="get_y-142"><a href="#get_y-142"><span class="linenos">142</span></a>        <span class="n">halflife_estimate</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="get_y-143"><a href="#get_y-143"><span class="linenos">143</span></a>        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">):</span>
</span><span id="get_y-144"><a href="#get_y-144"><span class="linenos">144</span></a>            <span class="n">halflife_estimate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
</span><span id="get_y-145"><a href="#get_y-145"><span class="linenos">145</span></a>                <span class="p">[</span>
</span><span id="get_y-146"><a href="#get_y-146"><span class="linenos">146</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>  <span class="c1"># zeroth-order halflife</span>
</span><span id="get_y-147"><a href="#get_y-147"><span class="linenos">147</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>  <span class="c1"># first-order halflife</span>
</span><span id="get_y-148"><a href="#get_y-148"><span class="linenos">148</span></a>                    <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y0</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">y0</span><span class="p">)]),</span>  <span class="c1"># second-order halflife</span>
</span><span id="get_y-149"><a href="#get_y-149"><span class="linenos">149</span></a>                <span class="p">]</span>
</span><span id="get_y-150"><a href="#get_y-150"><span class="linenos">150</span></a>            <span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dydt</span><span class="o">.</span><span class="n">k</span><span class="p">)</span>
</span><span id="get_y-151"><a href="#get_y-151"><span class="linenos">151</span></a>            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;largest halflife guess = </span><span class="si">{</span><span class="n">halflife_estimate</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</span><span id="get_y-152"><a href="#get_y-152"><span class="linenos">152</span></a>
</span><span id="get_y-153"><a href="#get_y-153"><span class="linenos">153</span></a>        <span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_halflives</span> <span class="o">*</span> <span class="n">halflife_estimate</span><span class="p">,</span> <span class="n">max_time</span><span class="p">)]</span>
</span><span id="get_y-154"><a href="#get_y-154"><span class="linenos">154</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;simulation time span   = </span><span class="si">{</span><span class="n">t_span</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</span><span id="get_y-155"><a href="#get_y-155"><span class="linenos">155</span></a>
</span><span id="get_y-156"><a href="#get_y-156"><span class="linenos">156</span></a>    <span class="n">jac</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="get_y-157"><a href="#get_y-157"><span class="linenos">157</span></a>    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dydt</span><span class="p">,</span> <span class="s2">&quot;jac&quot;</span><span class="p">):</span>
</span><span id="get_y-158"><a href="#get_y-158"><span class="linenos">158</span></a>        <span class="n">jac</span> <span class="o">=</span> <span class="n">dydt</span><span class="o">.</span><span class="n">jac</span>
</span><span id="get_y-159"><a href="#get_y-159"><span class="linenos">159</span></a>
</span><span id="get_y-160"><a href="#get_y-160"><span class="linenos">160</span></a>    <span class="c1"># This should be small enough.</span>
</span><span id="get_y-161"><a href="#get_y-161"><span class="linenos">161</span></a>    <span class="c1"># It seems to be required by LSODA, but has no visible effect on Radau.</span>
</span><span id="get_y-162"><a href="#get_y-162"><span class="linenos">162</span></a>    <span class="c1"># I don&#39;t care about BDF.</span>
</span><span id="get_y-163"><a href="#get_y-163"><span class="linenos">163</span></a>    <span class="c1">#</span>
</span><span id="get_y-164"><a href="#get_y-164"><span class="linenos">164</span></a>    <span class="c1"># Estimates are based on</span>
</span><span id="get_y-165"><a href="#get_y-165"><span class="linenos">165</span></a>    <span class="c1"># - the estimated time it takes for hydrogen atoms bind to a graphene sheet,</span>
</span><span id="get_y-166"><a href="#get_y-166"><span class="linenos">166</span></a>    <span class="c1"># - the diffusion constant of n-pentane,</span>
</span><span id="get_y-167"><a href="#get_y-167"><span class="linenos">167</span></a>    <span class="c1"># - the reaction rate of H2CO3 dehydration by carbonic anhydrase,</span>
</span><span id="get_y-168"><a href="#get_y-168"><span class="linenos">168</span></a>    <span class="c1"># - the hundredth part of the timespan,</span>
</span><span id="get_y-169"><a href="#get_y-169"><span class="linenos">169</span></a>    <span class="c1"># - some numberical limits,</span>
</span><span id="get_y-170"><a href="#get_y-170"><span class="linenos">170</span></a>    <span class="n">first_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span>
</span><span id="get_y-171"><a href="#get_y-171"><span class="linenos">171</span></a>        <span class="p">[</span>
</span><span id="get_y-172"><a href="#get_y-172"><span class="linenos">172</span></a>            <span class="mf">1e-14</span><span class="p">,</span>  <span class="c1"># Too small?</span>
</span><span id="get_y-173"><a href="#get_y-173"><span class="linenos">173</span></a>            <span class="mi">1</span> <span class="o">/</span> <span class="mf">27e9</span><span class="p">,</span>  <span class="c1"># Too small?</span>
</span><span id="get_y-174"><a href="#get_y-174"><span class="linenos">174</span></a>            <span class="mi">1</span> <span class="o">/</span> <span class="mf">1.5e10</span><span class="p">,</span>
</span><span id="get_y-175"><a href="#get_y-175"><span class="linenos">175</span></a>            <span class="p">(</span><span class="n">t_span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">,</span>
</span><span id="get_y-176"><a href="#get_y-176"><span class="linenos">176</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
</span><span id="get_y-177"><a href="#get_y-177"><span class="linenos">177</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
</span><span id="get_y-178"><a href="#get_y-178"><span class="linenos">178</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>  <span class="c1"># Too small?</span>
</span><span id="get_y-179"><a href="#get_y-179"><span class="linenos">179</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">nextafter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span>
</span><span id="get_y-180"><a href="#get_y-180"><span class="linenos">180</span></a>        <span class="p">]</span>
</span><span id="get_y-181"><a href="#get_y-181"><span class="linenos">181</span></a>    <span class="p">)</span>
</span><span id="get_y-182"><a href="#get_y-182"><span class="linenos">182</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;first step = </span><span class="si">{</span><span class="n">first_step</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</span><span id="get_y-183"><a href="#get_y-183"><span class="linenos">183</span></a>
</span><span id="get_y-184"><a href="#get_y-184"><span class="linenos">184</span></a>    <span class="c1"># Too large a max step breaks LSODA. A too small one breaks it too.</span>
</span><span id="get_y-185"><a href="#get_y-185"><span class="linenos">185</span></a>    <span class="n">max_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">t_span</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mf">100.0</span><span class="p">])</span>
</span><span id="get_y-186"><a href="#get_y-186"><span class="linenos">186</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;max step = </span><span class="si">{</span><span class="n">max_step</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>
</span><span id="get_y-187"><a href="#get_y-187"><span class="linenos">187</span></a>
</span><span id="get_y-188"><a href="#get_y-188"><span class="linenos">188</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;@t = </span><span class="se">\x1b</span><span class="s2">[94m</span><span class="si">{</span><span class="mi">0</span><span class="si">:</span><span class="s2">10.3f</span><span class="si">}</span><span class="s2"> </span><span class="se">\x1b</span><span class="s2">[ms</span><span class="se">\x1b</span><span class="s2">[K&quot;</span><span class="p">)</span>
</span><span id="get_y-189"><a href="#get_y-189"><span class="linenos">189</span></a>    <span class="n">res</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
</span><span id="get_y-190"><a href="#get_y-190"><span class="linenos">190</span></a>        <span class="n">dydt</span><span class="p">,</span>
</span><span id="get_y-191"><a href="#get_y-191"><span class="linenos">191</span></a>        <span class="n">t_span</span><span class="p">,</span>
</span><span id="get_y-192"><a href="#get_y-192"><span class="linenos">192</span></a>        <span class="n">y0</span><span class="p">,</span>
</span><span id="get_y-193"><a href="#get_y-193"><span class="linenos">193</span></a>        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
</span><span id="get_y-194"><a href="#get_y-194"><span class="linenos">194</span></a>        <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="get_y-195"><a href="#get_y-195"><span class="linenos">195</span></a>        <span class="n">first_step</span><span class="o">=</span><span class="n">first_step</span><span class="p">,</span>
</span><span id="get_y-196"><a href="#get_y-196"><span class="linenos">196</span></a>        <span class="n">max_step</span><span class="o">=</span><span class="n">max_step</span><span class="p">,</span>
</span><span id="get_y-197"><a href="#get_y-197"><span class="linenos">197</span></a>        <span class="n">rtol</span><span class="o">=</span><span class="n">rtol</span><span class="p">,</span>
</span><span id="get_y-198"><a href="#get_y-198"><span class="linenos">198</span></a>        <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">,</span>
</span><span id="get_y-199"><a href="#get_y-199"><span class="linenos">199</span></a>        <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span>
</span><span id="get_y-200"><a href="#get_y-200"><span class="linenos">200</span></a>    <span class="p">)</span>
</span><span id="get_y-201"><a href="#get_y-201"><span class="linenos">201</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span id="get_y-202"><a href="#get_y-202"><span class="linenos">202</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">sol</span>
</span><span id="get_y-203"><a href="#get_y-203"><span class="linenos">203</span></a>
</span><span id="get_y-204"><a href="#get_y-204"><span class="linenos">204</span></a>    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
</span><span id="get_y-205"><a href="#get_y-205"><span class="linenos">205</span></a>        <span class="c1"># TODO(schneiderfelipe): this is probably not the best way to</span>
</span><span id="get_y-206"><a href="#get_y-206"><span class="linenos">206</span></a>        <span class="c1"># vectorize a function!</span>
</span><span id="get_y-207"><a href="#get_y-207"><span class="linenos">207</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="get_y-208"><a href="#get_y-208"><span class="linenos">208</span></a>            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dydt</span><span class="p">(</span><span class="n">_t</span><span class="p">,</span> <span class="n">_y</span><span class="p">)</span> <span class="k">for</span> <span class="n">_t</span><span class="p">,</span> <span class="n">_y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
</span><span id="get_y-209"><a href="#get_y-209"><span class="linenos">209</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="get_y-210"><a href="#get_y-210"><span class="linenos">210</span></a>            <span class="k">return</span> <span class="n">dydt</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</span><span id="get_y-211"><a href="#get_y-211"><span class="linenos">211</span></a>
</span><span id="get_y-212"><a href="#get_y-212"><span class="linenos">212</span></a>    <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">r</span>
</span></pre></div>


            <div class="docstring"><p>Simulate a reaction scheme from its rate function.</p>

<p>This function provides two functions that calculate the concentrations and
the rates of formation at any point in time for any compound. It does that
by solving an initial value problem (IVP) through scipy's <code>solve_ivp</code>
under the hood.</p>

<h2 id="parameters">Parameters</h2>

<p>dydt : callable
    Right-hand side of the system.
y0 : array-like
    Initial state.
t_span : array-like, optional
    Interval of integration (t0, tf). The solver starts with t=t0 and
    integrates until it reaches t=tf. If not given, a conservative value
    is chosen based on the system at hand (the method of choice works for
    any zeroth-, first- or second-order reactions).
method : str, optional
    Integration method to use. See <code>scipy.integrate.solve_ivp</code> for details.
    Kinetics problems are very often stiff and, as such, "RK45" is
    normally unsuited. "Radau", "BDF" or "LSODA" are good choices.
rtol, atol : array-like
    See <code>scipy.integrate.solve_ivp</code> for details.
max_time : float, optional
    If <code>t_span</code> is not given, an interval will be estimated, but it can't
    be larger than this parameter.</p>

<h2 id="returns">Returns</h2>

<p>y, r : callable
    Concentrations and reaction rates as functions of time. The y object
    is an OdeSolution and stores attributes t_min and t_max.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
</code></pre>
</div>

<p>A toy simulation can be performed in just two lines:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A &lt;=&gt; B&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">get_y</span><span class="p">(</span><span class="n">get_dydt</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])),</span> <span class="n">y0</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</code></pre>
</div>

<p>The <code>y</code> object stores information about the simulation time, which can be
used to produce a suitable vector of timepoints for, e.g., plotting:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">t_min</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">t_max</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">(0.0, 3.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">t_min</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">t_max</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([0. , 0.06122449, ..., 2.93877551, 3. ])</span>
</code></pre>
</div>

<p>Both <code>y</code> and <code>r</code> can be used to check concentrations and rates in any
point in time. In particular, both are vectorized:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([[1. , 0.94237559, ..., 0.5012394, 0.5 ],</span>
<span class="go">       [0. , 0.05762441, ..., 0.4987606, 0.5 ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>  <span class="c1"># doctest: +SKIP</span>
<span class="go">array([[-1.00000000e+00, ..., -1.39544265e-10],</span>
<span class="go">       [ 1.00000000e+00, ...,  1.39544265e-10]])</span>
</code></pre>
</div>
</div>


                </section>
                <section id="is_transition_state">
                            <input id="is_transition_state-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_transition_state</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">name</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="is_transition_state-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#is_transition_state"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="is_transition_state-348"><a href="#is_transition_state-348"><span class="linenos">348</span></a><span class="k">def</span> <span class="nf">is_transition_state</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
</span><span id="is_transition_state-349"><a href="#is_transition_state-349"><span class="linenos">349</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether a name specifies a transition state.</span>
</span><span id="is_transition_state-350"><a href="#is_transition_state-350"><span class="linenos">350</span></a>
</span><span id="is_transition_state-351"><a href="#is_transition_state-351"><span class="linenos">351</span></a><span class="sd">    Parameters</span>
</span><span id="is_transition_state-352"><a href="#is_transition_state-352"><span class="linenos">352</span></a><span class="sd">    ----------</span>
</span><span id="is_transition_state-353"><a href="#is_transition_state-353"><span class="linenos">353</span></a><span class="sd">    name : str</span>
</span><span id="is_transition_state-354"><a href="#is_transition_state-354"><span class="linenos">354</span></a>
</span><span id="is_transition_state-355"><a href="#is_transition_state-355"><span class="linenos">355</span></a><span class="sd">    Returns</span>
</span><span id="is_transition_state-356"><a href="#is_transition_state-356"><span class="linenos">356</span></a><span class="sd">    -------</span>
</span><span id="is_transition_state-357"><a href="#is_transition_state-357"><span class="linenos">357</span></a><span class="sd">    bool</span>
</span><span id="is_transition_state-358"><a href="#is_transition_state-358"><span class="linenos">358</span></a>
</span><span id="is_transition_state-359"><a href="#is_transition_state-359"><span class="linenos">359</span></a><span class="sd">    Examples</span>
</span><span id="is_transition_state-360"><a href="#is_transition_state-360"><span class="linenos">360</span></a><span class="sd">    --------</span>
</span><span id="is_transition_state-361"><a href="#is_transition_state-361"><span class="linenos">361</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A#&quot;)</span>
</span><span id="is_transition_state-362"><a href="#is_transition_state-362"><span class="linenos">362</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-363"><a href="#is_transition_state-363"><span class="linenos">363</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A‚Ä°&quot;)</span>
</span><span id="is_transition_state-364"><a href="#is_transition_state-364"><span class="linenos">364</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-365"><a href="#is_transition_state-365"><span class="linenos">365</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;pyrrole#&quot;)</span>
</span><span id="is_transition_state-366"><a href="#is_transition_state-366"><span class="linenos">366</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-367"><a href="#is_transition_state-367"><span class="linenos">367</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;pyrrole‚Ä°&quot;)</span>
</span><span id="is_transition_state-368"><a href="#is_transition_state-368"><span class="linenos">368</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-369"><a href="#is_transition_state-369"><span class="linenos">369</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A&quot;)</span>
</span><span id="is_transition_state-370"><a href="#is_transition_state-370"><span class="linenos">370</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-371"><a href="#is_transition_state-371"><span class="linenos">371</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A~&quot;)</span>
</span><span id="is_transition_state-372"><a href="#is_transition_state-372"><span class="linenos">372</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-373"><a href="#is_transition_state-373"><span class="linenos">373</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;pyrrole&quot;)</span>
</span><span id="is_transition_state-374"><a href="#is_transition_state-374"><span class="linenos">374</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-375"><a href="#is_transition_state-375"><span class="linenos">375</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;pyrrole~&quot;)</span>
</span><span id="is_transition_state-376"><a href="#is_transition_state-376"><span class="linenos">376</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-377"><a href="#is_transition_state-377"><span class="linenos">377</span></a>
</span><span id="is_transition_state-378"><a href="#is_transition_state-378"><span class="linenos">378</span></a><span class="sd">    This function also works for names that specify environment:</span>
</span><span id="is_transition_state-379"><a href="#is_transition_state-379"><span class="linenos">379</span></a>
</span><span id="is_transition_state-380"><a href="#is_transition_state-380"><span class="linenos">380</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A#(w)&quot;)</span>
</span><span id="is_transition_state-381"><a href="#is_transition_state-381"><span class="linenos">381</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-382"><a href="#is_transition_state-382"><span class="linenos">382</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A‚Ä°(w)&quot;)</span>
</span><span id="is_transition_state-383"><a href="#is_transition_state-383"><span class="linenos">383</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-384"><a href="#is_transition_state-384"><span class="linenos">384</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;TS#(w)&quot;)</span>
</span><span id="is_transition_state-385"><a href="#is_transition_state-385"><span class="linenos">385</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-386"><a href="#is_transition_state-386"><span class="linenos">386</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;TS‚Ä°(w)&quot;)</span>
</span><span id="is_transition_state-387"><a href="#is_transition_state-387"><span class="linenos">387</span></a><span class="sd">    True</span>
</span><span id="is_transition_state-388"><a href="#is_transition_state-388"><span class="linenos">388</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A(w)&quot;)</span>
</span><span id="is_transition_state-389"><a href="#is_transition_state-389"><span class="linenos">389</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-390"><a href="#is_transition_state-390"><span class="linenos">390</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;A~(w)&quot;)</span>
</span><span id="is_transition_state-391"><a href="#is_transition_state-391"><span class="linenos">391</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-392"><a href="#is_transition_state-392"><span class="linenos">392</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;TS(w)&quot;)</span>
</span><span id="is_transition_state-393"><a href="#is_transition_state-393"><span class="linenos">393</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-394"><a href="#is_transition_state-394"><span class="linenos">394</span></a><span class="sd">    &gt;&gt;&gt; is_transition_state(&quot;TS~(w)&quot;)</span>
</span><span id="is_transition_state-395"><a href="#is_transition_state-395"><span class="linenos">395</span></a><span class="sd">    False</span>
</span><span id="is_transition_state-396"><a href="#is_transition_state-396"><span class="linenos">396</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="is_transition_state-397"><a href="#is_transition_state-397"><span class="linenos">397</span></a>    <span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;‚Ä°&quot;</span><span class="p">,</span> <span class="s2">&quot;#&quot;</span><span class="p">}:</span>
</span><span id="is_transition_state-398"><a href="#is_transition_state-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">marker</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
</span><span id="is_transition_state-399"><a href="#is_transition_state-399"><span class="linenos">399</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="is_transition_state-400"><a href="#is_transition_state-400"><span class="linenos">400</span></a>    <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Check whether a name specifies a transition state.</p>

<h2 id="parameters">Parameters</h2>

<p>name : str</p>

<h2 id="returns">Returns</h2>

<p>bool</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A#&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A‚Ä°&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;pyrrole#&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;pyrrole‚Ä°&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A~&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;pyrrole&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;pyrrole~&quot;</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>

<p>This function also works for names that specify environment:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A#(w)&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A‚Ä°(w)&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;TS#(w)&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;TS‚Ä°(w)&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A(w)&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;A~(w)&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;TS(w)&quot;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_transition_state</span><span class="p">(</span><span class="s2">&quot;TS~(w)&quot;</span><span class="p">)</span>
<span class="go">False</span>
</code></pre>
</div>
</div>


                </section>
                <section id="parse_compounds">
                            <input id="parse_compounds-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_compounds</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">text</span>, </span><span class="param"><span class="n">path</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,)</span>, </span><span class="param"><span class="n">select</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="parse_compounds-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_compounds"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_compounds-444"><a href="#parse_compounds-444"><span class="linenos">444</span></a><span class="k">def</span> <span class="nf">parse_compounds</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,),</span> <span class="n">select</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># noqa: C901</span>
</span><span id="parse_compounds-445"><a href="#parse_compounds-445"><span class="linenos">445</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse a set of compounds.</span>
</span><span id="parse_compounds-446"><a href="#parse_compounds-446"><span class="linenos">446</span></a>
</span><span id="parse_compounds-447"><a href="#parse_compounds-447"><span class="linenos">447</span></a><span class="sd">    Parameters</span>
</span><span id="parse_compounds-448"><a href="#parse_compounds-448"><span class="linenos">448</span></a><span class="sd">    ----------</span>
</span><span id="parse_compounds-449"><a href="#parse_compounds-449"><span class="linenos">449</span></a><span class="sd">    text : str, sequence of str or dict-like</span>
</span><span id="parse_compounds-450"><a href="#parse_compounds-450"><span class="linenos">450</span></a><span class="sd">        Compound descriptions or sequence of lines of it.</span>
</span><span id="parse_compounds-451"><a href="#parse_compounds-451"><span class="linenos">451</span></a><span class="sd">    path : sequence of str, optional</span>
</span><span id="parse_compounds-452"><a href="#parse_compounds-452"><span class="linenos">452</span></a><span class="sd">        Paths for searching logfiles.</span>
</span><span id="parse_compounds-453"><a href="#parse_compounds-453"><span class="linenos">453</span></a><span class="sd">    select : sequence of str, optional</span>
</span><span id="parse_compounds-454"><a href="#parse_compounds-454"><span class="linenos">454</span></a><span class="sd">        If defined, only those compounds will be returned.</span>
</span><span id="parse_compounds-455"><a href="#parse_compounds-455"><span class="linenos">455</span></a>
</span><span id="parse_compounds-456"><a href="#parse_compounds-456"><span class="linenos">456</span></a><span class="sd">    Returns</span>
</span><span id="parse_compounds-457"><a href="#parse_compounds-457"><span class="linenos">457</span></a><span class="sd">    -------</span>
</span><span id="parse_compounds-458"><a href="#parse_compounds-458"><span class="linenos">458</span></a><span class="sd">    compounds : immutable dict-like</span>
</span><span id="parse_compounds-459"><a href="#parse_compounds-459"><span class="linenos">459</span></a>
</span><span id="parse_compounds-460"><a href="#parse_compounds-460"><span class="linenos">460</span></a><span class="sd">    Raises</span>
</span><span id="parse_compounds-461"><a href="#parse_compounds-461"><span class="linenos">461</span></a><span class="sd">    ------</span>
</span><span id="parse_compounds-462"><a href="#parse_compounds-462"><span class="linenos">462</span></a><span class="sd">    FileNotFoundError</span>
</span><span id="parse_compounds-463"><a href="#parse_compounds-463"><span class="linenos">463</span></a><span class="sd">        If a logfile is not found.</span>
</span><span id="parse_compounds-464"><a href="#parse_compounds-464"><span class="linenos">464</span></a>
</span><span id="parse_compounds-465"><a href="#parse_compounds-465"><span class="linenos">465</span></a><span class="sd">    Examples</span>
</span><span id="parse_compounds-466"><a href="#parse_compounds-466"><span class="linenos">466</span></a><span class="sd">    --------</span>
</span><span id="parse_compounds-467"><a href="#parse_compounds-467"><span class="linenos">467</span></a><span class="sd">    &gt;&gt;&gt; import overreact as rx</span>
</span><span id="parse_compounds-468"><a href="#parse_compounds-468"><span class="linenos">468</span></a>
</span><span id="parse_compounds-469"><a href="#parse_compounds-469"><span class="linenos">469</span></a><span class="sd">    &gt;&gt;&gt; compounds = rx.parse_compounds(&quot;S: data/ethane/B97-3c/staggered.out&quot;)</span>
</span><span id="parse_compounds-470"><a href="#parse_compounds-470"><span class="linenos">470</span></a><span class="sd">    &gt;&gt;&gt; compounds</span>
</span><span id="parse_compounds-471"><a href="#parse_compounds-471"><span class="linenos">471</span></a><span class="sd">    {&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
</span><span id="parse_compounds-472"><a href="#parse_compounds-472"><span class="linenos">472</span></a><span class="sd">           &#39;energy&#39;: -209483812.77142256,</span>
</span><span id="parse_compounds-473"><a href="#parse_compounds-473"><span class="linenos">473</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-474"><a href="#parse_compounds-474"><span class="linenos">474</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-475"><a href="#parse_compounds-475"><span class="linenos">475</span></a><span class="sd">           ...}}</span>
</span><span id="parse_compounds-476"><a href="#parse_compounds-476"><span class="linenos">476</span></a>
</span><span id="parse_compounds-477"><a href="#parse_compounds-477"><span class="linenos">477</span></a><span class="sd">    &gt;&gt;&gt; compounds = rx.parse_compounds({&quot;S&quot;: &quot;data/ethane/B97-3c/staggered.out&quot;})</span>
</span><span id="parse_compounds-478"><a href="#parse_compounds-478"><span class="linenos">478</span></a><span class="sd">    &gt;&gt;&gt; compounds</span>
</span><span id="parse_compounds-479"><a href="#parse_compounds-479"><span class="linenos">479</span></a><span class="sd">    {&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
</span><span id="parse_compounds-480"><a href="#parse_compounds-480"><span class="linenos">480</span></a><span class="sd">           &#39;energy&#39;: -209483812.77142256,</span>
</span><span id="parse_compounds-481"><a href="#parse_compounds-481"><span class="linenos">481</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-482"><a href="#parse_compounds-482"><span class="linenos">482</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-483"><a href="#parse_compounds-483"><span class="linenos">483</span></a><span class="sd">           ...}}</span>
</span><span id="parse_compounds-484"><a href="#parse_compounds-484"><span class="linenos">484</span></a>
</span><span id="parse_compounds-485"><a href="#parse_compounds-485"><span class="linenos">485</span></a><span class="sd">    &gt;&gt;&gt; compounds = rx.parse_compounds([&quot;S: data/ethane/B97-3c/staggered.out&quot;,</span>
</span><span id="parse_compounds-486"><a href="#parse_compounds-486"><span class="linenos">486</span></a><span class="sd">    ...                              &quot;E‚Ä°: data/ethane/B97-3c/eclipsed.out&quot;])</span>
</span><span id="parse_compounds-487"><a href="#parse_compounds-487"><span class="linenos">487</span></a><span class="sd">    &gt;&gt;&gt; compounds</span>
</span><span id="parse_compounds-488"><a href="#parse_compounds-488"><span class="linenos">488</span></a><span class="sd">    {&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
</span><span id="parse_compounds-489"><a href="#parse_compounds-489"><span class="linenos">489</span></a><span class="sd">           &#39;energy&#39;: -209483812.77142256,</span>
</span><span id="parse_compounds-490"><a href="#parse_compounds-490"><span class="linenos">490</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-491"><a href="#parse_compounds-491"><span class="linenos">491</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-492"><a href="#parse_compounds-492"><span class="linenos">492</span></a><span class="sd">           ...},</span>
</span><span id="parse_compounds-493"><a href="#parse_compounds-493"><span class="linenos">493</span></a><span class="sd">    &#39;E‚Ä°&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/eclipsed.out&#39;,</span>
</span><span id="parse_compounds-494"><a href="#parse_compounds-494"><span class="linenos">494</span></a><span class="sd">           &#39;energy&#39;: -209472585.3539883,</span>
</span><span id="parse_compounds-495"><a href="#parse_compounds-495"><span class="linenos">495</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-496"><a href="#parse_compounds-496"><span class="linenos">496</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-497"><a href="#parse_compounds-497"><span class="linenos">497</span></a><span class="sd">           ...}}</span>
</span><span id="parse_compounds-498"><a href="#parse_compounds-498"><span class="linenos">498</span></a>
</span><span id="parse_compounds-499"><a href="#parse_compounds-499"><span class="linenos">499</span></a><span class="sd">    &gt;&gt;&gt; compounds = rx.parse_compounds(&#39;&#39;&#39;S: data/ethane/B97-3c/staggered.out</span>
</span><span id="parse_compounds-500"><a href="#parse_compounds-500"><span class="linenos">500</span></a><span class="sd">    ...                                E‚Ä°: data/ethane/B97-3c/eclipsed.out&#39;&#39;&#39;)</span>
</span><span id="parse_compounds-501"><a href="#parse_compounds-501"><span class="linenos">501</span></a><span class="sd">    &gt;&gt;&gt; compounds</span>
</span><span id="parse_compounds-502"><a href="#parse_compounds-502"><span class="linenos">502</span></a><span class="sd">    {&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
</span><span id="parse_compounds-503"><a href="#parse_compounds-503"><span class="linenos">503</span></a><span class="sd">           &#39;energy&#39;: -209483812.77142256,</span>
</span><span id="parse_compounds-504"><a href="#parse_compounds-504"><span class="linenos">504</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-505"><a href="#parse_compounds-505"><span class="linenos">505</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-506"><a href="#parse_compounds-506"><span class="linenos">506</span></a><span class="sd">           ...},</span>
</span><span id="parse_compounds-507"><a href="#parse_compounds-507"><span class="linenos">507</span></a><span class="sd">    &#39;E‚Ä°&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/eclipsed.out&#39;,</span>
</span><span id="parse_compounds-508"><a href="#parse_compounds-508"><span class="linenos">508</span></a><span class="sd">           &#39;energy&#39;: -209472585.3539883,</span>
</span><span id="parse_compounds-509"><a href="#parse_compounds-509"><span class="linenos">509</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-510"><a href="#parse_compounds-510"><span class="linenos">510</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-511"><a href="#parse_compounds-511"><span class="linenos">511</span></a><span class="sd">           ...}}</span>
</span><span id="parse_compounds-512"><a href="#parse_compounds-512"><span class="linenos">512</span></a>
</span><span id="parse_compounds-513"><a href="#parse_compounds-513"><span class="linenos">513</span></a><span class="sd">    &gt;&gt;&gt; compounds = rx.parse_compounds({&quot;S&quot;: &quot;data/ethane/B97-3c/staggered.out&quot;,</span>
</span><span id="parse_compounds-514"><a href="#parse_compounds-514"><span class="linenos">514</span></a><span class="sd">    ...                              &quot;E‚Ä°&quot;: &quot;data/ethane/B97-3c/eclipsed.out&quot;})</span>
</span><span id="parse_compounds-515"><a href="#parse_compounds-515"><span class="linenos">515</span></a><span class="sd">    &gt;&gt;&gt; compounds</span>
</span><span id="parse_compounds-516"><a href="#parse_compounds-516"><span class="linenos">516</span></a><span class="sd">    {&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
</span><span id="parse_compounds-517"><a href="#parse_compounds-517"><span class="linenos">517</span></a><span class="sd">           &#39;energy&#39;: -209483812.77142256,</span>
</span><span id="parse_compounds-518"><a href="#parse_compounds-518"><span class="linenos">518</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-519"><a href="#parse_compounds-519"><span class="linenos">519</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-520"><a href="#parse_compounds-520"><span class="linenos">520</span></a><span class="sd">           ...},</span>
</span><span id="parse_compounds-521"><a href="#parse_compounds-521"><span class="linenos">521</span></a><span class="sd">    &#39;E‚Ä°&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/eclipsed.out&#39;,</span>
</span><span id="parse_compounds-522"><a href="#parse_compounds-522"><span class="linenos">522</span></a><span class="sd">           &#39;energy&#39;: -209472585.3539883,</span>
</span><span id="parse_compounds-523"><a href="#parse_compounds-523"><span class="linenos">523</span></a><span class="sd">           &#39;mult&#39;: 1,</span>
</span><span id="parse_compounds-524"><a href="#parse_compounds-524"><span class="linenos">524</span></a><span class="sd">           &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_compounds-525"><a href="#parse_compounds-525"><span class="linenos">525</span></a><span class="sd">           ...}}</span>
</span><span id="parse_compounds-526"><a href="#parse_compounds-526"><span class="linenos">526</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parse_compounds-527"><a href="#parse_compounds-527"><span class="linenos">527</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="parse_compounds-528"><a href="#parse_compounds-528"><span class="linenos">528</span></a>        <span class="k">return</span> <span class="n">_check_compounds</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span id="parse_compounds-529"><a href="#parse_compounds-529"><span class="linenos">529</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="parse_compounds-530"><a href="#parse_compounds-530"><span class="linenos">530</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_compounds-531"><a href="#parse_compounds-531"><span class="linenos">531</span></a>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="parse_compounds-532"><a href="#parse_compounds-532"><span class="linenos">532</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="parse_compounds-533"><a href="#parse_compounds-533"><span class="linenos">533</span></a>    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="parse_compounds-534"><a href="#parse_compounds-534"><span class="linenos">534</span></a>    <span class="n">compounds</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
</span><span id="parse_compounds-535"><a href="#parse_compounds-535"><span class="linenos">535</span></a>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="parse_compounds-536"><a href="#parse_compounds-536"><span class="linenos">536</span></a>        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="parse_compounds-537"><a href="#parse_compounds-537"><span class="linenos">537</span></a>            <span class="n">name</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="parse_compounds-538"><a href="#parse_compounds-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
</span><span id="parse_compounds-539"><a href="#parse_compounds-539"><span class="linenos">539</span></a>            <span class="k">continue</span>
</span><span id="parse_compounds-540"><a href="#parse_compounds-540"><span class="linenos">540</span></a>
</span><span id="parse_compounds-541"><a href="#parse_compounds-541"><span class="linenos">541</span></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="parse_compounds-542"><a href="#parse_compounds-542"><span class="linenos">542</span></a>            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="parse_compounds-543"><a href="#parse_compounds-543"><span class="linenos">543</span></a>                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="parse_compounds-544"><a href="#parse_compounds-544"><span class="linenos">544</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="parse_compounds-545"><a href="#parse_compounds-545"><span class="linenos">545</span></a>                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;logfile&quot;</span><span class="p">,</span> <span class="n">line</span>
</span><span id="parse_compounds-546"><a href="#parse_compounds-546"><span class="linenos">546</span></a>
</span><span id="parse_compounds-547"><a href="#parse_compounds-547"><span class="linenos">547</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;logfile&quot;</span><span class="p">:</span>
</span><span id="parse_compounds-548"><a href="#parse_compounds-548"><span class="linenos">548</span></a>                <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="parse_compounds-549"><a href="#parse_compounds-549"><span class="linenos">549</span></a>                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
</span><span id="parse_compounds-550"><a href="#parse_compounds-550"><span class="linenos">550</span></a>                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
</span><span id="parse_compounds-551"><a href="#parse_compounds-551"><span class="linenos">551</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="parse_compounds-552"><a href="#parse_compounds-552"><span class="linenos">552</span></a>                        <span class="c1"># TODO: move on to use pathlib.</span>
</span><span id="parse_compounds-553"><a href="#parse_compounds-553"><span class="linenos">553</span></a>                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;trying to read </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_compounds-554"><a href="#parse_compounds-554"><span class="linenos">554</span></a>                        <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">read_logfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">value</span><span class="p">)))</span>
</span><span id="parse_compounds-555"><a href="#parse_compounds-555"><span class="linenos">555</span></a>                    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="parse_compounds-556"><a href="#parse_compounds-556"><span class="linenos">556</span></a>                        <span class="k">continue</span>
</span><span id="parse_compounds-557"><a href="#parse_compounds-557"><span class="linenos">557</span></a>                    <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="parse_compounds-558"><a href="#parse_compounds-558"><span class="linenos">558</span></a>                    <span class="k">break</span>
</span><span id="parse_compounds-559"><a href="#parse_compounds-559"><span class="linenos">559</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
</span><span id="parse_compounds-560"><a href="#parse_compounds-560"><span class="linenos">560</span></a>                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
</span><span id="parse_compounds-561"><a href="#parse_compounds-561"><span class="linenos">561</span></a>                        <span class="sa">f</span><span class="s2">&quot;could not find logfile &#39;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#39; in path: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: E501, EM102</span>
</span><span id="parse_compounds-562"><a href="#parse_compounds-562"><span class="linenos">562</span></a>                    <span class="p">)</span>
</span><span id="parse_compounds-563"><a href="#parse_compounds-563"><span class="linenos">563</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="parse_compounds-564"><a href="#parse_compounds-564"><span class="linenos">564</span></a>                <span class="c1"># one-line JSON-encoded object</span>
</span><span id="parse_compounds-565"><a href="#parse_compounds-565"><span class="linenos">565</span></a>                <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="parse_compounds-566"><a href="#parse_compounds-566"><span class="linenos">566</span></a>    <span class="k">if</span> <span class="n">select</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="parse_compounds-567"><a href="#parse_compounds-567"><span class="linenos">567</span></a>        <span class="c1"># TODO(schneiderfelipe): this workaround still allow unused compounds</span>
</span><span id="parse_compounds-568"><a href="#parse_compounds-568"><span class="linenos">568</span></a>        <span class="c1"># to be parsed! This should change in the future.</span>
</span><span id="parse_compounds-569"><a href="#parse_compounds-569"><span class="linenos">569</span></a>        <span class="n">compounds</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">select</span><span class="p">}</span>
</span><span id="parse_compounds-570"><a href="#parse_compounds-570"><span class="linenos">570</span></a>
</span><span id="parse_compounds-571"><a href="#parse_compounds-571"><span class="linenos">571</span></a>    <span class="c1"># Apply `extra_energy_term`s</span>
</span><span id="parse_compounds-572"><a href="#parse_compounds-572"><span class="linenos">572</span></a>    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">:</span>
</span><span id="parse_compounds-573"><a href="#parse_compounds-573"><span class="linenos">573</span></a>        <span class="k">if</span> <span class="s2">&quot;extra_energy_term&quot;</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
</span><span id="parse_compounds-574"><a href="#parse_compounds-574"><span class="linenos">574</span></a>            <span class="c1"># TODO: this assumes that 1. there&#39;s a single `extra_energy_term` and 2. `energy` is present  # noqa: E501</span>
</span><span id="parse_compounds-575"><a href="#parse_compounds-575"><span class="linenos">575</span></a>            <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;energy&quot;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">compounds</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;extra_energy_term&quot;</span><span class="p">]</span>
</span><span id="parse_compounds-576"><a href="#parse_compounds-576"><span class="linenos">576</span></a>
</span><span id="parse_compounds-577"><a href="#parse_compounds-577"><span class="linenos">577</span></a>    <span class="k">return</span> <span class="n">dotdict</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parse a set of compounds.</p>

<h2 id="parameters">Parameters</h2>

<p>text : str, sequence of str or dict-like
    Compound descriptions or sequence of lines of it.
path : sequence of str, optional
    Paths for searching logfiles.
select : sequence of str, optional
    If defined, only those compounds will be returned.</p>

<h2 id="returns">Returns</h2>

<p>compounds : immutable dict-like</p>

<h2 id="raises">Raises</h2>

<p>FileNotFoundError
    If a logfile is not found.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">overreact</span> <span class="k">as</span> <span class="nn">rx</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_compounds</span><span class="p">(</span><span class="s2">&quot;S: data/ethane/B97-3c/staggered.out&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span>
<span class="go">{&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209483812.77142256,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...}}</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_compounds</span><span class="p">({</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;data/ethane/B97-3c/staggered.out&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span>
<span class="go">{&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209483812.77142256,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...}}</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_compounds</span><span class="p">([</span><span class="s2">&quot;S: data/ethane/B97-3c/staggered.out&quot;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="s2">&quot;E‚Ä°: data/ethane/B97-3c/eclipsed.out&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span>
<span class="go">{&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209483812.77142256,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...},</span>
<span class="go">&#39;E‚Ä°&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/eclipsed.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209472585.3539883,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...}}</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_compounds</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;S: data/ethane/B97-3c/staggered.out</span>
<span class="gp">... </span><span class="s1">                               E‚Ä°: data/ethane/B97-3c/eclipsed.out&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span>
<span class="go">{&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209483812.77142256,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...},</span>
<span class="go">&#39;E‚Ä°&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/eclipsed.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209472585.3539883,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...}}</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span> <span class="o">=</span> <span class="n">rx</span><span class="o">.</span><span class="n">parse_compounds</span><span class="p">({</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;data/ethane/B97-3c/staggered.out&quot;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="s2">&quot;E‚Ä°&quot;</span><span class="p">:</span> <span class="s2">&quot;data/ethane/B97-3c/eclipsed.out&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compounds</span>
<span class="go">{&#39;S&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209483812.77142256,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...},</span>
<span class="go">&#39;E‚Ä°&#39;: {&#39;logfile&#39;: &#39;data/ethane/B97-3c/eclipsed.out&#39;,</span>
<span class="go">       &#39;energy&#39;: -209472585.3539883,</span>
<span class="go">       &#39;mult&#39;: 1,</span>
<span class="go">       &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go">       ...}}</span>
</code></pre>
</div>
</div>


                </section>
                <section id="parse_model">
                            <input id="parse_model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_model</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">force_compile</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="parse_model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_model-30"><a href="#parse_model-30"><span class="linenos"> 30</span></a><span class="k">def</span> <span class="nf">parse_model</span><span class="p">(</span><span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">force_compile</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>  <span class="c1"># noqa: FBT001, FBT002</span>
</span><span id="parse_model-31"><a href="#parse_model-31"><span class="linenos"> 31</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse either a source or model input file, whichever is available.</span>
</span><span id="parse_model-32"><a href="#parse_model-32"><span class="linenos"> 32</span></a>
</span><span id="parse_model-33"><a href="#parse_model-33"><span class="linenos"> 33</span></a><span class="sd">    A **source input file** (also known as a `.k` file) contains all the information needed</span>
</span><span id="parse_model-34"><a href="#parse_model-34"><span class="linenos"> 34</span></a><span class="sd">    to *create a model input file*.</span>
</span><span id="parse_model-35"><a href="#parse_model-35"><span class="linenos"> 35</span></a><span class="sd">    A **model input file** (also known as a `.jk` file) is a JSON encoded file with all the</span>
</span><span id="parse_model-36"><a href="#parse_model-36"><span class="linenos"> 36</span></a><span class="sd">    information needed to study microkinetic simulations from first principles.</span>
</span><span id="parse_model-37"><a href="#parse_model-37"><span class="linenos"> 37</span></a>
</span><span id="parse_model-38"><a href="#parse_model-38"><span class="linenos"> 38</span></a><span class="sd">    You probably won&#39;t need to use model input files directly, they are</span>
</span><span id="parse_model-39"><a href="#parse_model-39"><span class="linenos"> 39</span></a><span class="sd">    automatically created based on source input files.</span>
</span><span id="parse_model-40"><a href="#parse_model-40"><span class="linenos"> 40</span></a><span class="sd">    [**Take a look at our guide on how to write an source input file**](https://geem-lab.github.io/overreact-guide/input.html).</span>
</span><span id="parse_model-41"><a href="#parse_model-41"><span class="linenos"> 41</span></a>
</span><span id="parse_model-42"><a href="#parse_model-42"><span class="linenos"> 42</span></a><span class="sd">    This function attempts to parse a model input file if available. If not, a source</span>
</span><span id="parse_model-43"><a href="#parse_model-43"><span class="linenos"> 43</span></a><span class="sd">    input file is parsed and a model input file is generated from it. Extensions are</span>
</span><span id="parse_model-44"><a href="#parse_model-44"><span class="linenos"> 44</span></a><span class="sd">    guessed if none given (i.e., if only the base name given).</span>
</span><span id="parse_model-45"><a href="#parse_model-45"><span class="linenos"> 45</span></a>
</span><span id="parse_model-46"><a href="#parse_model-46"><span class="linenos"> 46</span></a><span class="sd">    Parameters</span>
</span><span id="parse_model-47"><a href="#parse_model-47"><span class="linenos"> 47</span></a><span class="sd">    ----------</span>
</span><span id="parse_model-48"><a href="#parse_model-48"><span class="linenos"> 48</span></a><span class="sd">    path : str</span>
</span><span id="parse_model-49"><a href="#parse_model-49"><span class="linenos"> 49</span></a><span class="sd">        Path to the model or source input file.</span>
</span><span id="parse_model-50"><a href="#parse_model-50"><span class="linenos"> 50</span></a><span class="sd">        If the final extension is not `.jk` or `.k`, it is guessed.</span>
</span><span id="parse_model-51"><a href="#parse_model-51"><span class="linenos"> 51</span></a><span class="sd">    force_compile : bool</span>
</span><span id="parse_model-52"><a href="#parse_model-52"><span class="linenos"> 52</span></a><span class="sd">        If True, a `.k` file will take precedence over any `.jk` file for reading. A</span>
</span><span id="parse_model-53"><a href="#parse_model-53"><span class="linenos"> 53</span></a><span class="sd">        `.jk` file is thus either generated or overwritten. This is sometimes</span>
</span><span id="parse_model-54"><a href="#parse_model-54"><span class="linenos"> 54</span></a><span class="sd">        needed to force an update with new data.</span>
</span><span id="parse_model-55"><a href="#parse_model-55"><span class="linenos"> 55</span></a>
</span><span id="parse_model-56"><a href="#parse_model-56"><span class="linenos"> 56</span></a><span class="sd">    Returns</span>
</span><span id="parse_model-57"><a href="#parse_model-57"><span class="linenos"> 57</span></a><span class="sd">    -------</span>
</span><span id="parse_model-58"><a href="#parse_model-58"><span class="linenos"> 58</span></a><span class="sd">    model : immutable dict-like</span>
</span><span id="parse_model-59"><a href="#parse_model-59"><span class="linenos"> 59</span></a>
</span><span id="parse_model-60"><a href="#parse_model-60"><span class="linenos"> 60</span></a><span class="sd">    Raises</span>
</span><span id="parse_model-61"><a href="#parse_model-61"><span class="linenos"> 61</span></a><span class="sd">    ------</span>
</span><span id="parse_model-62"><a href="#parse_model-62"><span class="linenos"> 62</span></a><span class="sd">    FileNotFoundError</span>
</span><span id="parse_model-63"><a href="#parse_model-63"><span class="linenos"> 63</span></a><span class="sd">        If the model or source input file is not found.</span>
</span><span id="parse_model-64"><a href="#parse_model-64"><span class="linenos"> 64</span></a>
</span><span id="parse_model-65"><a href="#parse_model-65"><span class="linenos"> 65</span></a><span class="sd">    Examples</span>
</span><span id="parse_model-66"><a href="#parse_model-66"><span class="linenos"> 66</span></a><span class="sd">    --------</span>
</span><span id="parse_model-67"><a href="#parse_model-67"><span class="linenos"> 67</span></a><span class="sd">    Some examples of how overreact &quot;sees&quot; your data below üòÑ:</span>
</span><span id="parse_model-68"><a href="#parse_model-68"><span class="linenos"> 68</span></a>
</span><span id="parse_model-69"><a href="#parse_model-69"><span class="linenos"> 69</span></a><span class="sd">    &gt;&gt;&gt; model = parse_model(&quot;data/ethane/B97-3c/model.jk&quot;)</span>
</span><span id="parse_model-70"><a href="#parse_model-70"><span class="linenos"> 70</span></a><span class="sd">    &gt;&gt;&gt; model.scheme</span>
</span><span id="parse_model-71"><a href="#parse_model-71"><span class="linenos"> 71</span></a><span class="sd">    Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
</span><span id="parse_model-72"><a href="#parse_model-72"><span class="linenos"> 72</span></a><span class="sd">           reactions=(&#39;S -&gt; S&#39;,),</span>
</span><span id="parse_model-73"><a href="#parse_model-73"><span class="linenos"> 73</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="parse_model-74"><a href="#parse_model-74"><span class="linenos"> 74</span></a><span class="sd">           A=((0.0,), (0.0,)),</span>
</span><span id="parse_model-75"><a href="#parse_model-75"><span class="linenos"> 75</span></a><span class="sd">           B=((-1.0,), (1.0,)))</span>
</span><span id="parse_model-76"><a href="#parse_model-76"><span class="linenos"> 76</span></a><span class="sd">    &gt;&gt;&gt; model.compounds[&quot;S&quot;]</span>
</span><span id="parse_model-77"><a href="#parse_model-77"><span class="linenos"> 77</span></a><span class="sd">    {&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
</span><span id="parse_model-78"><a href="#parse_model-78"><span class="linenos"> 78</span></a><span class="sd">     &#39;energy&#39;: -209483812.77142256,</span>
</span><span id="parse_model-79"><a href="#parse_model-79"><span class="linenos"> 79</span></a><span class="sd">     &#39;mult&#39;: 1,</span>
</span><span id="parse_model-80"><a href="#parse_model-80"><span class="linenos"> 80</span></a><span class="sd">     &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
</span><span id="parse_model-81"><a href="#parse_model-81"><span class="linenos"> 81</span></a><span class="sd">     &#39;atommasses&#39;: (12.011, 12.011, 1.008, 1.008, 1.008, 1.008, 1.008, 1.008),</span>
</span><span id="parse_model-82"><a href="#parse_model-82"><span class="linenos"> 82</span></a><span class="sd">     &#39;atomcoords&#39;: ((-7.633588, 2.520693, -4.8e-05),</span>
</span><span id="parse_model-83"><a href="#parse_model-83"><span class="linenos"> 83</span></a><span class="sd">                    ...,</span>
</span><span id="parse_model-84"><a href="#parse_model-84"><span class="linenos"> 84</span></a><span class="sd">                    (-5.832852, 3.674431, 0.363239)),</span>
</span><span id="parse_model-85"><a href="#parse_model-85"><span class="linenos"> 85</span></a><span class="sd">     &#39;vibfreqs&#39;: (307.57, 825.42, ..., 3071.11, 3071.45),</span>
</span><span id="parse_model-86"><a href="#parse_model-86"><span class="linenos"> 86</span></a><span class="sd">     &#39;vibdisps&#39;: (((-1.7e-05, 3.4e-05, 5.4e-05),</span>
</span><span id="parse_model-87"><a href="#parse_model-87"><span class="linenos"> 87</span></a><span class="sd">                   ...,</span>
</span><span id="parse_model-88"><a href="#parse_model-88"><span class="linenos"> 88</span></a><span class="sd">                   (-0.011061, -0.030431, -0.027036)))}</span>
</span><span id="parse_model-89"><a href="#parse_model-89"><span class="linenos"> 89</span></a><span class="sd">    &gt;&gt;&gt; model_from_source = parse_model(&quot;data/ethane/B97-3c/model.k&quot;,</span>
</span><span id="parse_model-90"><a href="#parse_model-90"><span class="linenos"> 90</span></a><span class="sd">    ...                                 force_compile=True)</span>
</span><span id="parse_model-91"><a href="#parse_model-91"><span class="linenos"> 91</span></a><span class="sd">    &gt;&gt;&gt; model_from_source == model</span>
</span><span id="parse_model-92"><a href="#parse_model-92"><span class="linenos"> 92</span></a><span class="sd">    True</span>
</span><span id="parse_model-93"><a href="#parse_model-93"><span class="linenos"> 93</span></a><span class="sd">    &gt;&gt;&gt; model_from_source = parse_model(&quot;data/ethane/B97-3c/model&quot;)</span>
</span><span id="parse_model-94"><a href="#parse_model-94"><span class="linenos"> 94</span></a><span class="sd">    &gt;&gt;&gt; model_from_source == model</span>
</span><span id="parse_model-95"><a href="#parse_model-95"><span class="linenos"> 95</span></a><span class="sd">    True</span>
</span><span id="parse_model-96"><a href="#parse_model-96"><span class="linenos"> 96</span></a><span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa: E501</span>
</span><span id="parse_model-97"><a href="#parse_model-97"><span class="linenos"> 97</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.k&quot;</span><span class="p">,</span> <span class="s2">&quot;.jk&quot;</span><span class="p">)):</span>
</span><span id="parse_model-98"><a href="#parse_model-98"><span class="linenos"> 98</span></a>        <span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">.jk&quot;</span>
</span><span id="parse_model-99"><a href="#parse_model-99"><span class="linenos"> 99</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;assuming `.jk` file in </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_model-100"><a href="#parse_model-100"><span class="linenos">100</span></a>    <span class="n">name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="parse_model-101"><a href="#parse_model-101"><span class="linenos">101</span></a>
</span><span id="parse_model-102"><a href="#parse_model-102"><span class="linenos">102</span></a>    <span class="n">path_jk</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.jk&quot;</span>
</span><span id="parse_model-103"><a href="#parse_model-103"><span class="linenos">103</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">force_compile</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path_jk</span><span class="p">):</span>
</span><span id="parse_model-104"><a href="#parse_model-104"><span class="linenos">104</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parsing `.jk` file in </span><span class="si">{</span><span class="n">path_jk</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_model-105"><a href="#parse_model-105"><span class="linenos">105</span></a>        <span class="k">return</span> <span class="n">_parse_model</span><span class="p">(</span><span class="n">path_jk</span><span class="p">)</span>
</span><span id="parse_model-106"><a href="#parse_model-106"><span class="linenos">106</span></a>
</span><span id="parse_model-107"><a href="#parse_model-107"><span class="linenos">107</span></a>    <span class="n">path_k</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.k&quot;</span>
</span><span id="parse_model-108"><a href="#parse_model-108"><span class="linenos">108</span></a>    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parsing `.k` file in </span><span class="si">{</span><span class="n">path_k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_model-109"><a href="#parse_model-109"><span class="linenos">109</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path_k</span><span class="p">):</span>
</span><span id="parse_model-110"><a href="#parse_model-110"><span class="linenos">110</span></a>        <span class="c1"># TODO: add a nice error message here and everywhere?</span>
</span><span id="parse_model-111"><a href="#parse_model-111"><span class="linenos">111</span></a>        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no `.k` file found in </span><span class="si">{</span><span class="n">path_k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># noqa: EM102</span>
</span><span id="parse_model-112"><a href="#parse_model-112"><span class="linenos">112</span></a>
</span><span id="parse_model-113"><a href="#parse_model-113"><span class="linenos">113</span></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">_parse_source</span><span class="p">(</span><span class="n">path_k</span><span class="p">)</span>
</span><span id="parse_model-114"><a href="#parse_model-114"><span class="linenos">114</span></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_jk</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="parse_model-115"><a href="#parse_model-115"><span class="linenos">115</span></a>        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;writing `.jk` file in </span><span class="si">{</span><span class="n">path_jk</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="parse_model-116"><a href="#parse_model-116"><span class="linenos">116</span></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">_unparse_model</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</span><span id="parse_model-117"><a href="#parse_model-117"><span class="linenos">117</span></a>
</span><span id="parse_model-118"><a href="#parse_model-118"><span class="linenos">118</span></a>    <span class="k">return</span> <span class="n">model</span>
</span></pre></div>


            <div class="docstring"><p>Parse either a source or model input file, whichever is available.</p>

<p>A <strong>source input file</strong> (also known as a <code>.k</code> file) contains all the information needed
to <em>create a model input file</em>.
A <strong>model input file</strong> (also known as a <code>.jk</code> file) is a JSON encoded file with all the
information needed to study microkinetic simulations from first principles.</p>

<p>You probably won't need to use model input files directly, they are
automatically created based on source input files.
<a href="https://geem-lab.github.io/overreact-guide/input.html"><strong>Take a look at our guide on how to write an source input file</strong></a>.</p>

<p>This function attempts to parse a model input file if available. If not, a source
input file is parsed and a model input file is generated from it. Extensions are
guessed if none given (i.e., if only the base name given).</p>

<h2 id="parameters">Parameters</h2>

<p>path : str
    Path to the model or source input file.
    If the final extension is not <code>.jk</code> or <code>.k</code>, it is guessed.
force_compile : bool
    If True, a <code>.k</code> file will take precedence over any <code>.jk</code> file for reading. A
    <code>.jk</code> file is thus either generated or overwritten. This is sometimes
    needed to force an update with new data.</p>

<h2 id="returns">Returns</h2>

<p>model : immutable dict-like</p>

<h2 id="raises">Raises</h2>

<p>FileNotFoundError
    If the model or source input file is not found.</p>

<h2 id="examples">Examples</h2>

<p>Some examples of how overreact "sees" your data below üòÑ:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.jk&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">scheme</span>
<span class="go">Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
<span class="go">       reactions=(&#39;S -&gt; S&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((0.0,), (0.0,)),</span>
<span class="go">       B=((-1.0,), (1.0,)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compounds</span><span class="p">[</span><span class="s2">&quot;S&quot;</span><span class="p">]</span>
<span class="go">{&#39;logfile&#39;: &#39;data/ethane/B97-3c/staggered.out&#39;,</span>
<span class="go"> &#39;energy&#39;: -209483812.77142256,</span>
<span class="go"> &#39;mult&#39;: 1,</span>
<span class="go"> &#39;atomnos&#39;: (6, 6, 1, 1, 1, 1, 1, 1),</span>
<span class="go"> &#39;atommasses&#39;: (12.011, 12.011, 1.008, 1.008, 1.008, 1.008, 1.008, 1.008),</span>
<span class="go"> &#39;atomcoords&#39;: ((-7.633588, 2.520693, -4.8e-05),</span>
<span class="go">                ...,</span>
<span class="go">                (-5.832852, 3.674431, 0.363239)),</span>
<span class="go"> &#39;vibfreqs&#39;: (307.57, 825.42, ..., 3071.11, 3071.45),</span>
<span class="go"> &#39;vibdisps&#39;: (((-1.7e-05, 3.4e-05, 5.4e-05),</span>
<span class="go">               ...,</span>
<span class="go">               (-0.011061, -0.030431, -0.027036)))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_from_source</span> <span class="o">=</span> <span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model.k&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">force_compile</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_from_source</span> <span class="o">==</span> <span class="n">model</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_from_source</span> <span class="o">=</span> <span class="n">parse_model</span><span class="p">(</span><span class="s2">&quot;data/ethane/B97-3c/model&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_from_source</span> <span class="o">==</span> <span class="n">model</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="parse_reactions">
                            <input id="parse_reactions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parse_reactions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span></span><span class="return-annotation">) -> <span class="n"><a href="#Scheme">overreact.Scheme</a></span>:</span></span>

                <label class="view-source-button" for="parse_reactions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#parse_reactions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="parse_reactions-403"><a href="#parse_reactions-403"><span class="linenos">403</span></a><span class="k">def</span> <span class="nf">parse_reactions</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Scheme</span><span class="p">:</span>  <span class="c1"># noqa: C901</span>
</span><span id="parse_reactions-404"><a href="#parse_reactions-404"><span class="linenos">404</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="parse_reactions-405"><a href="#parse_reactions-405"><span class="linenos">405</span></a><span class="sd">    Parse a kinetic model as a chemical reaction scheme.</span>
</span><span id="parse_reactions-406"><a href="#parse_reactions-406"><span class="linenos">406</span></a>
</span><span id="parse_reactions-407"><a href="#parse_reactions-407"><span class="linenos">407</span></a><span class="sd">    This is an essential part of the parsing process.</span>
</span><span id="parse_reactions-408"><a href="#parse_reactions-408"><span class="linenos">408</span></a><span class="sd">    See `overreact.io.parse_model` other details.</span>
</span><span id="parse_reactions-409"><a href="#parse_reactions-409"><span class="linenos">409</span></a>
</span><span id="parse_reactions-410"><a href="#parse_reactions-410"><span class="linenos">410</span></a><span class="sd">    Parameters</span>
</span><span id="parse_reactions-411"><a href="#parse_reactions-411"><span class="linenos">411</span></a><span class="sd">    ----------</span>
</span><span id="parse_reactions-412"><a href="#parse_reactions-412"><span class="linenos">412</span></a><span class="sd">    text : str or sequence of str</span>
</span><span id="parse_reactions-413"><a href="#parse_reactions-413"><span class="linenos">413</span></a><span class="sd">        Model description or sequence of lines of it.</span>
</span><span id="parse_reactions-414"><a href="#parse_reactions-414"><span class="linenos">414</span></a>
</span><span id="parse_reactions-415"><a href="#parse_reactions-415"><span class="linenos">415</span></a><span class="sd">    Returns</span>
</span><span id="parse_reactions-416"><a href="#parse_reactions-416"><span class="linenos">416</span></a><span class="sd">    -------</span>
</span><span id="parse_reactions-417"><a href="#parse_reactions-417"><span class="linenos">417</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="parse_reactions-418"><a href="#parse_reactions-418"><span class="linenos">418</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="parse_reactions-419"><a href="#parse_reactions-419"><span class="linenos">419</span></a>
</span><span id="parse_reactions-420"><a href="#parse_reactions-420"><span class="linenos">420</span></a><span class="sd">    Notes</span>
</span><span id="parse_reactions-421"><a href="#parse_reactions-421"><span class="linenos">421</span></a><span class="sd">    -----</span>
</span><span id="parse_reactions-422"><a href="#parse_reactions-422"><span class="linenos">422</span></a><span class="sd">    The model description should comply with the mini-language for systems of</span>
</span><span id="parse_reactions-423"><a href="#parse_reactions-423"><span class="linenos">423</span></a><span class="sd">    reactions. A semi-formal definition of the grammar in</span>
</span><span id="parse_reactions-424"><a href="#parse_reactions-424"><span class="linenos">424</span></a><span class="sd">    [Backus-Naur form](https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form)</span>
</span><span id="parse_reactions-425"><a href="#parse_reactions-425"><span class="linenos">425</span></a><span class="sd">    is given below:</span>
</span><span id="parse_reactions-426"><a href="#parse_reactions-426"><span class="linenos">426</span></a>
</span><span id="parse_reactions-427"><a href="#parse_reactions-427"><span class="linenos">427</span></a><span class="sd">             equation ::= equation_side arrow equation_side</span>
</span><span id="parse_reactions-428"><a href="#parse_reactions-428"><span class="linenos">428</span></a><span class="sd">        equation_side ::= coefficient compound [&#39;+&#39; coefficient compound]*</span>
</span><span id="parse_reactions-429"><a href="#parse_reactions-429"><span class="linenos">429</span></a><span class="sd">          coefficient ::= [integers] (defaults to 1)</span>
</span><span id="parse_reactions-430"><a href="#parse_reactions-430"><span class="linenos">430</span></a><span class="sd">             compound ::= mix of printable characters</span>
</span><span id="parse_reactions-431"><a href="#parse_reactions-431"><span class="linenos">431</span></a><span class="sd">                arrow ::= &#39;-&gt;&#39; | &#39;&lt;=&gt;&#39; | &#39;&lt;-&#39;</span>
</span><span id="parse_reactions-432"><a href="#parse_reactions-432"><span class="linenos">432</span></a>
</span><span id="parse_reactions-433"><a href="#parse_reactions-433"><span class="linenos">433</span></a><span class="sd">    Blank lines and comments (starting with `//`) are ignored. Repeated</span>
</span><span id="parse_reactions-434"><a href="#parse_reactions-434"><span class="linenos">434</span></a><span class="sd">    reactions are ignored. Furthermore, reactions can be chained one after</span>
</span><span id="parse_reactions-435"><a href="#parse_reactions-435"><span class="linenos">435</span></a><span class="sd">    another and, if a single compound (with either a `‚Ä°` or a `#` at the end)</span>
</span><span id="parse_reactions-436"><a href="#parse_reactions-436"><span class="linenos">436</span></a><span class="sd">    appears alone on one side of a reaction, it&#39;s considered a transition</span>
</span><span id="parse_reactions-437"><a href="#parse_reactions-437"><span class="linenos">437</span></a><span class="sd">    state. Transition states have zero lifetime during the simulation.</span>
</span><span id="parse_reactions-438"><a href="#parse_reactions-438"><span class="linenos">438</span></a>
</span><span id="parse_reactions-439"><a href="#parse_reactions-439"><span class="linenos">439</span></a><span class="sd">    Examples</span>
</span><span id="parse_reactions-440"><a href="#parse_reactions-440"><span class="linenos">440</span></a><span class="sd">    --------</span>
</span><span id="parse_reactions-441"><a href="#parse_reactions-441"><span class="linenos">441</span></a><span class="sd">    What follows is a rather long tour over the parsing process and its</span>
</span><span id="parse_reactions-442"><a href="#parse_reactions-442"><span class="linenos">442</span></a><span class="sd">    output in general. You can skip it if you are not interested in the</span>
</span><span id="parse_reactions-443"><a href="#parse_reactions-443"><span class="linenos">443</span></a><span class="sd">    details.</span>
</span><span id="parse_reactions-444"><a href="#parse_reactions-444"><span class="linenos">444</span></a>
</span><span id="parse_reactions-445"><a href="#parse_reactions-445"><span class="linenos">445</span></a><span class="sd">    &gt;&gt;&gt; scheme = parse_reactions(&quot;A -&gt; B  // a direct reaction&quot;)</span>
</span><span id="parse_reactions-446"><a href="#parse_reactions-446"><span class="linenos">446</span></a>
</span><span id="parse_reactions-447"><a href="#parse_reactions-447"><span class="linenos">447</span></a><span class="sd">    The reaction above is a direct one (observe that comments are ignored). The</span>
</span><span id="parse_reactions-448"><a href="#parse_reactions-448"><span class="linenos">448</span></a><span class="sd">    returned object has the following attributes:</span>
</span><span id="parse_reactions-449"><a href="#parse_reactions-449"><span class="linenos">449</span></a>
</span><span id="parse_reactions-450"><a href="#parse_reactions-450"><span class="linenos">450</span></a><span class="sd">    &gt;&gt;&gt; scheme.compounds</span>
</span><span id="parse_reactions-451"><a href="#parse_reactions-451"><span class="linenos">451</span></a><span class="sd">    (&#39;A&#39;, &#39;B&#39;)</span>
</span><span id="parse_reactions-452"><a href="#parse_reactions-452"><span class="linenos">452</span></a><span class="sd">    &gt;&gt;&gt; scheme.reactions</span>
</span><span id="parse_reactions-453"><a href="#parse_reactions-453"><span class="linenos">453</span></a><span class="sd">    (&#39;A -&gt; B&#39;,)</span>
</span><span id="parse_reactions-454"><a href="#parse_reactions-454"><span class="linenos">454</span></a><span class="sd">    &gt;&gt;&gt; scheme.is_half_equilibrium</span>
</span><span id="parse_reactions-455"><a href="#parse_reactions-455"><span class="linenos">455</span></a><span class="sd">    (False,)</span>
</span><span id="parse_reactions-456"><a href="#parse_reactions-456"><span class="linenos">456</span></a><span class="sd">    &gt;&gt;&gt; scheme.A</span>
</span><span id="parse_reactions-457"><a href="#parse_reactions-457"><span class="linenos">457</span></a><span class="sd">    ((-1.,), (1.,))</span>
</span><span id="parse_reactions-458"><a href="#parse_reactions-458"><span class="linenos">458</span></a><span class="sd">    &gt;&gt;&gt; scheme.B</span>
</span><span id="parse_reactions-459"><a href="#parse_reactions-459"><span class="linenos">459</span></a><span class="sd">    ((-1.,), (1.,))</span>
</span><span id="parse_reactions-460"><a href="#parse_reactions-460"><span class="linenos">460</span></a>
</span><span id="parse_reactions-461"><a href="#parse_reactions-461"><span class="linenos">461</span></a><span class="sd">    The same reaction can be specified in reverse order:</span>
</span><span id="parse_reactions-462"><a href="#parse_reactions-462"><span class="linenos">462</span></a>
</span><span id="parse_reactions-463"><a href="#parse_reactions-463"><span class="linenos">463</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&quot;B &lt;- A  // reverse reaction of the above&quot;)</span>
</span><span id="parse_reactions-464"><a href="#parse_reactions-464"><span class="linenos">464</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
</span><span id="parse_reactions-465"><a href="#parse_reactions-465"><span class="linenos">465</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="parse_reactions-466"><a href="#parse_reactions-466"><span class="linenos">466</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="parse_reactions-467"><a href="#parse_reactions-467"><span class="linenos">467</span></a><span class="sd">           A=((-1.,), (1.,)),</span>
</span><span id="parse_reactions-468"><a href="#parse_reactions-468"><span class="linenos">468</span></a><span class="sd">           B=((-1.,), (1.,)))</span>
</span><span id="parse_reactions-469"><a href="#parse_reactions-469"><span class="linenos">469</span></a>
</span><span id="parse_reactions-470"><a href="#parse_reactions-470"><span class="linenos">470</span></a><span class="sd">    Equilibria produce twice as many direct reactions, while the $B$ matrix</span>
</span><span id="parse_reactions-471"><a href="#parse_reactions-471"><span class="linenos">471</span></a><span class="sd">    defines an energy relationship for only one of each pair:</span>
</span><span id="parse_reactions-472"><a href="#parse_reactions-472"><span class="linenos">472</span></a>
</span><span id="parse_reactions-473"><a href="#parse_reactions-473"><span class="linenos">473</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&quot;A &lt;=&gt; B  // an equilibrium&quot;)</span>
</span><span id="parse_reactions-474"><a href="#parse_reactions-474"><span class="linenos">474</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
</span><span id="parse_reactions-475"><a href="#parse_reactions-475"><span class="linenos">475</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;, &#39;B -&gt; A&#39;),</span>
</span><span id="parse_reactions-476"><a href="#parse_reactions-476"><span class="linenos">476</span></a><span class="sd">           is_half_equilibrium=(True, True),</span>
</span><span id="parse_reactions-477"><a href="#parse_reactions-477"><span class="linenos">477</span></a><span class="sd">           A=((-1.,  1.),</span>
</span><span id="parse_reactions-478"><a href="#parse_reactions-478"><span class="linenos">478</span></a><span class="sd">              (1., -1.)),</span>
</span><span id="parse_reactions-479"><a href="#parse_reactions-479"><span class="linenos">479</span></a><span class="sd">           B=((-1.,  0.),</span>
</span><span id="parse_reactions-480"><a href="#parse_reactions-480"><span class="linenos">480</span></a><span class="sd">              (1.,  0.)))</span>
</span><span id="parse_reactions-481"><a href="#parse_reactions-481"><span class="linenos">481</span></a>
</span><span id="parse_reactions-482"><a href="#parse_reactions-482"><span class="linenos">482</span></a><span class="sd">    Adding twice the same reaction results in a single reaction being added.</span>
</span><span id="parse_reactions-483"><a href="#parse_reactions-483"><span class="linenos">483</span></a><span class="sd">    This of course also works with equilibria (extra whitespaces are ignored):</span>
</span><span id="parse_reactions-484"><a href="#parse_reactions-484"><span class="linenos">484</span></a>
</span><span id="parse_reactions-485"><a href="#parse_reactions-485"><span class="linenos">485</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&#39;&#39;&#39;</span>
</span><span id="parse_reactions-486"><a href="#parse_reactions-486"><span class="linenos">486</span></a><span class="sd">    ...     A &lt;=&gt; B  -&gt; A</span>
</span><span id="parse_reactions-487"><a href="#parse_reactions-487"><span class="linenos">487</span></a><span class="sd">    ...     A  -&gt; B &lt;=&gt; A</span>
</span><span id="parse_reactions-488"><a href="#parse_reactions-488"><span class="linenos">488</span></a><span class="sd">    ...     A  -&gt; B &lt;-  A</span>
</span><span id="parse_reactions-489"><a href="#parse_reactions-489"><span class="linenos">489</span></a><span class="sd">    ...     B &lt;-  A  -&gt; B</span>
</span><span id="parse_reactions-490"><a href="#parse_reactions-490"><span class="linenos">490</span></a><span class="sd">    ... &#39;&#39;&#39;)</span>
</span><span id="parse_reactions-491"><a href="#parse_reactions-491"><span class="linenos">491</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
</span><span id="parse_reactions-492"><a href="#parse_reactions-492"><span class="linenos">492</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;, &#39;B -&gt; A&#39;),</span>
</span><span id="parse_reactions-493"><a href="#parse_reactions-493"><span class="linenos">493</span></a><span class="sd">           is_half_equilibrium=(True, True),</span>
</span><span id="parse_reactions-494"><a href="#parse_reactions-494"><span class="linenos">494</span></a><span class="sd">           A=((-1.,  1.),</span>
</span><span id="parse_reactions-495"><a href="#parse_reactions-495"><span class="linenos">495</span></a><span class="sd">              (1., -1.)),</span>
</span><span id="parse_reactions-496"><a href="#parse_reactions-496"><span class="linenos">496</span></a><span class="sd">           B=((-1.,  0.),</span>
</span><span id="parse_reactions-497"><a href="#parse_reactions-497"><span class="linenos">497</span></a><span class="sd">              (1.,  0.)))</span>
</span><span id="parse_reactions-498"><a href="#parse_reactions-498"><span class="linenos">498</span></a>
</span><span id="parse_reactions-499"><a href="#parse_reactions-499"><span class="linenos">499</span></a><span class="sd">    Transition states are specified with a special symbol at the end (either</span>
</span><span id="parse_reactions-500"><a href="#parse_reactions-500"><span class="linenos">500</span></a><span class="sd">    `‚Ä°` or `#`). They are shown among compounds, but the matrix $A$ ensures</span>
</span><span id="parse_reactions-501"><a href="#parse_reactions-501"><span class="linenos">501</span></a><span class="sd">    they&#39;ll never have a non-zero rate of formation/consumption. On the other</span>
</span><span id="parse_reactions-502"><a href="#parse_reactions-502"><span class="linenos">502</span></a><span class="sd">    hand, they are needed in the $B$ matrix:</span>
</span><span id="parse_reactions-503"><a href="#parse_reactions-503"><span class="linenos">503</span></a>
</span><span id="parse_reactions-504"><a href="#parse_reactions-504"><span class="linenos">504</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&quot;A -&gt; A‚Ä° -&gt; B&quot;)</span>
</span><span id="parse_reactions-505"><a href="#parse_reactions-505"><span class="linenos">505</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
</span><span id="parse_reactions-506"><a href="#parse_reactions-506"><span class="linenos">506</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="parse_reactions-507"><a href="#parse_reactions-507"><span class="linenos">507</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="parse_reactions-508"><a href="#parse_reactions-508"><span class="linenos">508</span></a><span class="sd">           A=((-1.,), (0.,), (1.,)),</span>
</span><span id="parse_reactions-509"><a href="#parse_reactions-509"><span class="linenos">509</span></a><span class="sd">           B=((-1.,), (1.,), (0.,)))</span>
</span><span id="parse_reactions-510"><a href="#parse_reactions-510"><span class="linenos">510</span></a>
</span><span id="parse_reactions-511"><a href="#parse_reactions-511"><span class="linenos">511</span></a><span class="sd">    This gives the same result as above:</span>
</span><span id="parse_reactions-512"><a href="#parse_reactions-512"><span class="linenos">512</span></a>
</span><span id="parse_reactions-513"><a href="#parse_reactions-513"><span class="linenos">513</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&quot;A -&gt; A‚Ä° -&gt; B &lt;- A‚Ä° &lt;- A&quot;)</span>
</span><span id="parse_reactions-514"><a href="#parse_reactions-514"><span class="linenos">514</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
</span><span id="parse_reactions-515"><a href="#parse_reactions-515"><span class="linenos">515</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="parse_reactions-516"><a href="#parse_reactions-516"><span class="linenos">516</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="parse_reactions-517"><a href="#parse_reactions-517"><span class="linenos">517</span></a><span class="sd">           A=((-1.,), (0.,), (1.,)),</span>
</span><span id="parse_reactions-518"><a href="#parse_reactions-518"><span class="linenos">518</span></a><span class="sd">           B=((-1.,), (1.,), (0.,)))</span>
</span><span id="parse_reactions-519"><a href="#parse_reactions-519"><span class="linenos">519</span></a>
</span><span id="parse_reactions-520"><a href="#parse_reactions-520"><span class="linenos">520</span></a><span class="sd">    It is possible to define a reaction whose product is the same as the</span>
</span><span id="parse_reactions-521"><a href="#parse_reactions-521"><span class="linenos">521</span></a><span class="sd">    reactant. This is found in isomerization processes (e.g., ammonia</span>
</span><span id="parse_reactions-522"><a href="#parse_reactions-522"><span class="linenos">522</span></a><span class="sd">    inversion or the methyl rotation in ethane):</span>
</span><span id="parse_reactions-523"><a href="#parse_reactions-523"><span class="linenos">523</span></a>
</span><span id="parse_reactions-524"><a href="#parse_reactions-524"><span class="linenos">524</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&quot;S -&gt; E‚Ä° -&gt; S&quot;)</span>
</span><span id="parse_reactions-525"><a href="#parse_reactions-525"><span class="linenos">525</span></a><span class="sd">    Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
</span><span id="parse_reactions-526"><a href="#parse_reactions-526"><span class="linenos">526</span></a><span class="sd">           reactions=(&#39;S -&gt; S&#39;,),</span>
</span><span id="parse_reactions-527"><a href="#parse_reactions-527"><span class="linenos">527</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="parse_reactions-528"><a href="#parse_reactions-528"><span class="linenos">528</span></a><span class="sd">           A=((0.,), (0.,)),</span>
</span><span id="parse_reactions-529"><a href="#parse_reactions-529"><span class="linenos">529</span></a><span class="sd">           B=((-1.,), (1.,)))</span>
</span><span id="parse_reactions-530"><a href="#parse_reactions-530"><span class="linenos">530</span></a>
</span><span id="parse_reactions-531"><a href="#parse_reactions-531"><span class="linenos">531</span></a><span class="sd">    As such, a column full of zeros in the $A$ matrix corresponds to a reaction</span>
</span><span id="parse_reactions-532"><a href="#parse_reactions-532"><span class="linenos">532</span></a><span class="sd">    with zero net change. As can be seen, overreact allows for very general</span>
</span><span id="parse_reactions-533"><a href="#parse_reactions-533"><span class="linenos">533</span></a><span class="sd">    models. An interesting feature is that a single transition state can link</span>
</span><span id="parse_reactions-534"><a href="#parse_reactions-534"><span class="linenos">534</span></a><span class="sd">    many different compounds (whether it is useful is a matter of debate):</span>
</span><span id="parse_reactions-535"><a href="#parse_reactions-535"><span class="linenos">535</span></a>
</span><span id="parse_reactions-536"><a href="#parse_reactions-536"><span class="linenos">536</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&#39;&#39;&#39;</span>
</span><span id="parse_reactions-537"><a href="#parse_reactions-537"><span class="linenos">537</span></a><span class="sd">    ...     B  -&gt; B‚Ä°  -&gt; C  // chained reactions and transition states</span>
</span><span id="parse_reactions-538"><a href="#parse_reactions-538"><span class="linenos">538</span></a><span class="sd">    ...     B‚Ä° -&gt; D         // this is a bifurcation</span>
</span><span id="parse_reactions-539"><a href="#parse_reactions-539"><span class="linenos">539</span></a><span class="sd">    ...     B  -&gt; B&#39;‚Ä° -&gt; E  // this is a classical competitive reaction</span>
</span><span id="parse_reactions-540"><a href="#parse_reactions-540"><span class="linenos">540</span></a><span class="sd">    ...     A  -&gt; B‚Ä°</span>
</span><span id="parse_reactions-541"><a href="#parse_reactions-541"><span class="linenos">541</span></a><span class="sd">    ... &#39;&#39;&#39;)</span>
</span><span id="parse_reactions-542"><a href="#parse_reactions-542"><span class="linenos">542</span></a><span class="sd">    Scheme(compounds=(&#39;B&#39;, &#39;B‚Ä°&#39;, &#39;C&#39;, &#39;D&#39;, &quot;B&#39;‚Ä°&quot;, &#39;E&#39;, &#39;A&#39;),</span>
</span><span id="parse_reactions-543"><a href="#parse_reactions-543"><span class="linenos">543</span></a><span class="sd">           reactions=(&#39;B -&gt; C&#39;, &#39;B -&gt; D&#39;, &#39;B -&gt; E&#39;, &#39;A -&gt; C&#39;, &#39;A -&gt; D&#39;),</span>
</span><span id="parse_reactions-544"><a href="#parse_reactions-544"><span class="linenos">544</span></a><span class="sd">           is_half_equilibrium=(False, False, False, False, False),</span>
</span><span id="parse_reactions-545"><a href="#parse_reactions-545"><span class="linenos">545</span></a><span class="sd">           A=((-1., -1., -1.,  0.,  0.),</span>
</span><span id="parse_reactions-546"><a href="#parse_reactions-546"><span class="linenos">546</span></a><span class="sd">              (0.,  0.,  0.,  0.,  0.),</span>
</span><span id="parse_reactions-547"><a href="#parse_reactions-547"><span class="linenos">547</span></a><span class="sd">              (1.,  0.,  0.,  1.,  0.),</span>
</span><span id="parse_reactions-548"><a href="#parse_reactions-548"><span class="linenos">548</span></a><span class="sd">              (0.,  1.,  0.,  0.,  1.),</span>
</span><span id="parse_reactions-549"><a href="#parse_reactions-549"><span class="linenos">549</span></a><span class="sd">              (0.,  0.,  0.,  0.,  0.),</span>
</span><span id="parse_reactions-550"><a href="#parse_reactions-550"><span class="linenos">550</span></a><span class="sd">              (0.,  0.,  1.,  0.,  0.),</span>
</span><span id="parse_reactions-551"><a href="#parse_reactions-551"><span class="linenos">551</span></a><span class="sd">              (0.,  0.,  0., -1., -1.)),</span>
</span><span id="parse_reactions-552"><a href="#parse_reactions-552"><span class="linenos">552</span></a><span class="sd">           B=((-1., -1., -1.,  0.,  0.),</span>
</span><span id="parse_reactions-553"><a href="#parse_reactions-553"><span class="linenos">553</span></a><span class="sd">              (1.,  1.,  0.,  1.,  1.),</span>
</span><span id="parse_reactions-554"><a href="#parse_reactions-554"><span class="linenos">554</span></a><span class="sd">              (0.,  0.,  0.,  0.,  0.),</span>
</span><span id="parse_reactions-555"><a href="#parse_reactions-555"><span class="linenos">555</span></a><span class="sd">              (0.,  0.,  0.,  0.,  0.),</span>
</span><span id="parse_reactions-556"><a href="#parse_reactions-556"><span class="linenos">556</span></a><span class="sd">              (0.,  0.,  1.,  0.,  0.),</span>
</span><span id="parse_reactions-557"><a href="#parse_reactions-557"><span class="linenos">557</span></a><span class="sd">              (0.,  0.,  0.,  0.,  0.),</span>
</span><span id="parse_reactions-558"><a href="#parse_reactions-558"><span class="linenos">558</span></a><span class="sd">              (0.,  0.,  0., -1., -1.)))</span>
</span><span id="parse_reactions-559"><a href="#parse_reactions-559"><span class="linenos">559</span></a>
</span><span id="parse_reactions-560"><a href="#parse_reactions-560"><span class="linenos">560</span></a><span class="sd">    The following is a borderline case but both reactions should be considered</span>
</span><span id="parse_reactions-561"><a href="#parse_reactions-561"><span class="linenos">561</span></a><span class="sd">    different since they define different processes:</span>
</span><span id="parse_reactions-562"><a href="#parse_reactions-562"><span class="linenos">562</span></a>
</span><span id="parse_reactions-563"><a href="#parse_reactions-563"><span class="linenos">563</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&#39;&#39;&#39;</span>
</span><span id="parse_reactions-564"><a href="#parse_reactions-564"><span class="linenos">564</span></a><span class="sd">    ...     A -&gt; A‚Ä° -&gt; B</span>
</span><span id="parse_reactions-565"><a href="#parse_reactions-565"><span class="linenos">565</span></a><span class="sd">    ...     A -&gt; B</span>
</span><span id="parse_reactions-566"><a href="#parse_reactions-566"><span class="linenos">566</span></a><span class="sd">    ... &#39;&#39;&#39;)</span>
</span><span id="parse_reactions-567"><a href="#parse_reactions-567"><span class="linenos">567</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
</span><span id="parse_reactions-568"><a href="#parse_reactions-568"><span class="linenos">568</span></a><span class="sd">           reactions=(&#39;A -&gt; B&#39;, &#39;A -&gt; B&#39;),</span>
</span><span id="parse_reactions-569"><a href="#parse_reactions-569"><span class="linenos">569</span></a><span class="sd">           is_half_equilibrium=(False, False),</span>
</span><span id="parse_reactions-570"><a href="#parse_reactions-570"><span class="linenos">570</span></a><span class="sd">           A=((-1., -1.),</span>
</span><span id="parse_reactions-571"><a href="#parse_reactions-571"><span class="linenos">571</span></a><span class="sd">              (0.,  0.),</span>
</span><span id="parse_reactions-572"><a href="#parse_reactions-572"><span class="linenos">572</span></a><span class="sd">              (1.,  1.)),</span>
</span><span id="parse_reactions-573"><a href="#parse_reactions-573"><span class="linenos">573</span></a><span class="sd">           B=((-1., -1.),</span>
</span><span id="parse_reactions-574"><a href="#parse_reactions-574"><span class="linenos">574</span></a><span class="sd">              (1.,  0.),</span>
</span><span id="parse_reactions-575"><a href="#parse_reactions-575"><span class="linenos">575</span></a><span class="sd">              (0.,  1.)))</span>
</span><span id="parse_reactions-576"><a href="#parse_reactions-576"><span class="linenos">576</span></a>
</span><span id="parse_reactions-577"><a href="#parse_reactions-577"><span class="linenos">577</span></a><span class="sd">    The following is correct behavior. In fact, the reactions are badly</span>
</span><span id="parse_reactions-578"><a href="#parse_reactions-578"><span class="linenos">578</span></a><span class="sd">    defined: if more than one transition state are chained, the following</span>
</span><span id="parse_reactions-579"><a href="#parse_reactions-579"><span class="linenos">579</span></a><span class="sd">    happens, which is correct since it&#39;s the most physically plausible model</span>
</span><span id="parse_reactions-580"><a href="#parse_reactions-580"><span class="linenos">580</span></a><span class="sd">    that can be extracted. It can be seen as a feature that the product B is</span>
</span><span id="parse_reactions-581"><a href="#parse_reactions-581"><span class="linenos">581</span></a><span class="sd">    ignored and not the reactant A, since the user would easily see the mistake</span>
</span><span id="parse_reactions-582"><a href="#parse_reactions-582"><span class="linenos">582</span></a><span class="sd">    in graphs of concentration over time (the alternative would be no</span>
</span><span id="parse_reactions-583"><a href="#parse_reactions-583"><span class="linenos">583</span></a><span class="sd">    reaction happening at all, which is rather cryptic to debug).</span>
</span><span id="parse_reactions-584"><a href="#parse_reactions-584"><span class="linenos">584</span></a>
</span><span id="parse_reactions-585"><a href="#parse_reactions-585"><span class="linenos">585</span></a><span class="sd">    &gt;&gt;&gt; parse_reactions(&quot;A -&gt; A‚Ä° -&gt; A&#39;‚Ä° -&gt; B&quot;)</span>
</span><span id="parse_reactions-586"><a href="#parse_reactions-586"><span class="linenos">586</span></a><span class="sd">    Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &quot;A&#39;‚Ä°&quot;, &#39;B&#39;),</span>
</span><span id="parse_reactions-587"><a href="#parse_reactions-587"><span class="linenos">587</span></a><span class="sd">           reactions=(&quot;A -&gt; A&#39;‚Ä°&quot;,),</span>
</span><span id="parse_reactions-588"><a href="#parse_reactions-588"><span class="linenos">588</span></a><span class="sd">           is_half_equilibrium=(False,),</span>
</span><span id="parse_reactions-589"><a href="#parse_reactions-589"><span class="linenos">589</span></a><span class="sd">           A=((-1.,), (0.,), (1.,), (0.,)),</span>
</span><span id="parse_reactions-590"><a href="#parse_reactions-590"><span class="linenos">590</span></a><span class="sd">           B=((-1.,), (1.,), (0.,), (0.,)))</span>
</span><span id="parse_reactions-591"><a href="#parse_reactions-591"><span class="linenos">591</span></a>
</span><span id="parse_reactions-592"><a href="#parse_reactions-592"><span class="linenos">592</span></a><span class="sd">    In any case, it&#39;s not clear how a reaction barrier be defined in such a</span>
</span><span id="parse_reactions-593"><a href="#parse_reactions-593"><span class="linenos">593</span></a><span class="sd">    case. If you have a use case, don&#39;t hesitate to</span>
</span><span id="parse_reactions-594"><a href="#parse_reactions-594"><span class="linenos">594</span></a><span class="sd">    [open an issue](https://github.com/geem-lab/overreact/issues/), we&#39;ll be</span>
</span><span id="parse_reactions-595"><a href="#parse_reactions-595"><span class="linenos">595</span></a><span class="sd">    happy to hear from you.</span>
</span><span id="parse_reactions-596"><a href="#parse_reactions-596"><span class="linenos">596</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="parse_reactions-597"><a href="#parse_reactions-597"><span class="linenos">597</span></a>    <span class="n">compounds</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_reactions-598"><a href="#parse_reactions-598"><span class="linenos">598</span></a>    <span class="n">reactions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span>
</span><span id="parse_reactions-599"><a href="#parse_reactions-599"><span class="linenos">599</span></a>        <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]</span>
</span><span id="parse_reactions-600"><a href="#parse_reactions-600"><span class="linenos">600</span></a>    <span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_reactions-601"><a href="#parse_reactions-601"><span class="linenos">601</span></a>    <span class="n">A</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># coefficients between reactants and products  # noqa: N806</span>
</span><span id="parse_reactions-602"><a href="#parse_reactions-602"><span class="linenos">602</span></a>    <span class="n">B</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># coefficients between reactants and transition states  # noqa: N806</span>
</span><span id="parse_reactions-603"><a href="#parse_reactions-603"><span class="linenos">603</span></a>
</span><span id="parse_reactions-604"><a href="#parse_reactions-604"><span class="linenos">604</span></a>    <span class="k">def</span> <span class="nf">_add_reaction</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="n">transition</span><span class="p">):</span>
</span><span id="parse_reactions-605"><a href="#parse_reactions-605"><span class="linenos">605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Local helper function with side-effects.&quot;&quot;&quot;</span>
</span><span id="parse_reactions-606"><a href="#parse_reactions-606"><span class="linenos">606</span></a>        <span class="c1"># TODO(schneiderfelipe): what if reaction is defined, then redefined</span>
</span><span id="parse_reactions-607"><a href="#parse_reactions-607"><span class="linenos">607</span></a>        <span class="c1"># as equilibrium, or vice-versa?</span>
</span><span id="parse_reactions-608"><a href="#parse_reactions-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="parse_reactions-609"><a href="#parse_reactions-609"><span class="linenos">609</span></a>            <span class="n">transition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</span><span id="parse_reactions-610"><a href="#parse_reactions-610"><span class="linenos">610</span></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="n">transition</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reactions</span>
</span><span id="parse_reactions-611"><a href="#parse_reactions-611"><span class="linenos">611</span></a>        <span class="p">):</span>
</span><span id="parse_reactions-612"><a href="#parse_reactions-612"><span class="linenos">612</span></a>            <span class="k">return</span>
</span><span id="parse_reactions-613"><a href="#parse_reactions-613"><span class="linenos">613</span></a>
</span><span id="parse_reactions-614"><a href="#parse_reactions-614"><span class="linenos">614</span></a>        <span class="c1"># found new reaction</span>
</span><span id="parse_reactions-615"><a href="#parse_reactions-615"><span class="linenos">615</span></a>        <span class="n">reactions</span><span class="p">[(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="n">transition</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="parse_reactions-616"><a href="#parse_reactions-616"><span class="linenos">616</span></a>
</span><span id="parse_reactions-617"><a href="#parse_reactions-617"><span class="linenos">617</span></a>        <span class="n">A_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compounds</span><span class="p">))</span>  <span class="c1"># noqa: N806</span>
</span><span id="parse_reactions-618"><a href="#parse_reactions-618"><span class="linenos">618</span></a>        <span class="k">for</span> <span class="n">coefficient</span><span class="p">,</span> <span class="n">reactant</span> <span class="ow">in</span> <span class="n">reactants</span><span class="p">:</span>
</span><span id="parse_reactions-619"><a href="#parse_reactions-619"><span class="linenos">619</span></a>            <span class="n">A_vector</span><span class="p">[</span><span class="n">compounds</span><span class="p">[</span><span class="n">reactant</span><span class="p">]]</span> <span class="o">=</span> <span class="o">-</span><span class="n">coefficient</span>
</span><span id="parse_reactions-620"><a href="#parse_reactions-620"><span class="linenos">620</span></a>        <span class="n">B_vector</span> <span class="o">=</span> <span class="n">A_vector</span>  <span class="c1"># noqa: N806</span>
</span><span id="parse_reactions-621"><a href="#parse_reactions-621"><span class="linenos">621</span></a>
</span><span id="parse_reactions-622"><a href="#parse_reactions-622"><span class="linenos">622</span></a>        <span class="k">if</span> <span class="n">transition</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="parse_reactions-623"><a href="#parse_reactions-623"><span class="linenos">623</span></a>            <span class="n">B_vector</span> <span class="o">=</span> <span class="n">A_vector</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># noqa: N806</span>
</span><span id="parse_reactions-624"><a href="#parse_reactions-624"><span class="linenos">624</span></a>
</span><span id="parse_reactions-625"><a href="#parse_reactions-625"><span class="linenos">625</span></a>            <span class="c1"># it&#39;s assumed that</span>
</span><span id="parse_reactions-626"><a href="#parse_reactions-626"><span class="linenos">626</span></a>            <span class="c1">#   1. there&#39;s a singe transition compound, and</span>
</span><span id="parse_reactions-627"><a href="#parse_reactions-627"><span class="linenos">627</span></a>            <span class="c1">#   2. its coefficient equals one</span>
</span><span id="parse_reactions-628"><a href="#parse_reactions-628"><span class="linenos">628</span></a>            <span class="n">B_vector</span><span class="p">[</span><span class="n">compounds</span><span class="p">[</span><span class="n">transition</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]]]</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="parse_reactions-629"><a href="#parse_reactions-629"><span class="linenos">629</span></a>
</span><span id="parse_reactions-630"><a href="#parse_reactions-630"><span class="linenos">630</span></a>        <span class="k">for</span> <span class="n">coefficient</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">products</span><span class="p">:</span>
</span><span id="parse_reactions-631"><a href="#parse_reactions-631"><span class="linenos">631</span></a>            <span class="n">A_vector</span><span class="p">[</span><span class="n">compounds</span><span class="p">[</span><span class="n">product</span><span class="p">]]</span> <span class="o">+=</span> <span class="n">coefficient</span>
</span><span id="parse_reactions-632"><a href="#parse_reactions-632"><span class="linenos">632</span></a>
</span><span id="parse_reactions-633"><a href="#parse_reactions-633"><span class="linenos">633</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="parse_reactions-634"><a href="#parse_reactions-634"><span class="linenos">634</span></a>            <span class="n">is_half_equilibrium</span>
</span><span id="parse_reactions-635"><a href="#parse_reactions-635"><span class="linenos">635</span></a>            <span class="ow">and</span> <span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="n">reactants</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="n">transition</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reactions</span>
</span><span id="parse_reactions-636"><a href="#parse_reactions-636"><span class="linenos">636</span></a>        <span class="p">):</span>
</span><span id="parse_reactions-637"><a href="#parse_reactions-637"><span class="linenos">637</span></a>            <span class="n">B_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compounds</span><span class="p">))</span>  <span class="c1"># noqa: N806</span>
</span><span id="parse_reactions-638"><a href="#parse_reactions-638"><span class="linenos">638</span></a>
</span><span id="parse_reactions-639"><a href="#parse_reactions-639"><span class="linenos">639</span></a>        <span class="n">A</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A_vector</span><span class="p">)</span>
</span><span id="parse_reactions-640"><a href="#parse_reactions-640"><span class="linenos">640</span></a>        <span class="n">B</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">B_vector</span><span class="p">)</span>
</span><span id="parse_reactions-641"><a href="#parse_reactions-641"><span class="linenos">641</span></a>
</span><span id="parse_reactions-642"><a href="#parse_reactions-642"><span class="linenos">642</span></a>    <span class="n">after_transitions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_reactions-643"><a href="#parse_reactions-643"><span class="linenos">643</span></a>    <span class="n">before_transitions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="o">...</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="parse_reactions-644"><a href="#parse_reactions-644"><span class="linenos">644</span></a>
</span><span id="parse_reactions-645"><a href="#parse_reactions-645"><span class="linenos">645</span></a>    <span class="k">for</span> <span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span> <span class="ow">in</span> <span class="n">_parse_reactions</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
</span><span id="parse_reactions-646"><a href="#parse_reactions-646"><span class="linenos">646</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">in</span> <span class="n">reactions</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="parse_reactions-647"><a href="#parse_reactions-647"><span class="linenos">647</span></a>            <span class="n">reactants</span><span class="p">,</span>
</span><span id="parse_reactions-648"><a href="#parse_reactions-648"><span class="linenos">648</span></a>            <span class="n">products</span><span class="p">,</span>
</span><span id="parse_reactions-649"><a href="#parse_reactions-649"><span class="linenos">649</span></a>            <span class="kc">True</span><span class="p">,</span>
</span><span id="parse_reactions-650"><a href="#parse_reactions-650"><span class="linenos">650</span></a>            <span class="kc">None</span><span class="p">,</span>
</span><span id="parse_reactions-651"><a href="#parse_reactions-651"><span class="linenos">651</span></a>        <span class="p">)</span> <span class="ow">in</span> <span class="n">reactions</span><span class="p">:</span>
</span><span id="parse_reactions-652"><a href="#parse_reactions-652"><span class="linenos">652</span></a>            <span class="k">continue</span>
</span><span id="parse_reactions-653"><a href="#parse_reactions-653"><span class="linenos">653</span></a>
</span><span id="parse_reactions-654"><a href="#parse_reactions-654"><span class="linenos">654</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">compound</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">):</span>
</span><span id="parse_reactions-655"><a href="#parse_reactions-655"><span class="linenos">655</span></a>            <span class="k">if</span> <span class="n">compound</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">compounds</span><span class="p">:</span>
</span><span id="parse_reactions-656"><a href="#parse_reactions-656"><span class="linenos">656</span></a>                <span class="c1"># found new compound</span>
</span><span id="parse_reactions-657"><a href="#parse_reactions-657"><span class="linenos">657</span></a>                <span class="n">compounds</span><span class="p">[</span><span class="n">compound</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span>
</span><span id="parse_reactions-658"><a href="#parse_reactions-658"><span class="linenos">658</span></a>
</span><span id="parse_reactions-659"><a href="#parse_reactions-659"><span class="linenos">659</span></a>        <span class="c1"># TODO(schneiderfelipe): what if a transition state is used in an</span>
</span><span id="parse_reactions-660"><a href="#parse_reactions-660"><span class="linenos">660</span></a>        <span class="c1"># equilibrium?</span>
</span><span id="parse_reactions-661"><a href="#parse_reactions-661"><span class="linenos">661</span></a>
</span><span id="parse_reactions-662"><a href="#parse_reactions-662"><span class="linenos">662</span></a>        <span class="c1"># it&#39;s assumed that if a transition shows up,</span>
</span><span id="parse_reactions-663"><a href="#parse_reactions-663"><span class="linenos">663</span></a>        <span class="c1">#   1. it&#39;s the only compound in its side of the reaction, and</span>
</span><span id="parse_reactions-664"><a href="#parse_reactions-664"><span class="linenos">664</span></a>        <span class="c1">#   2. its coefficient equals one</span>
</span><span id="parse_reactions-665"><a href="#parse_reactions-665"><span class="linenos">665</span></a>        <span class="k">if</span> <span class="n">is_transition_state</span><span class="p">(</span><span class="n">reactants</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># noqa: RET507</span>
</span><span id="parse_reactions-666"><a href="#parse_reactions-666"><span class="linenos">666</span></a>            <span class="k">for</span> <span class="n">before_reactants</span> <span class="ow">in</span> <span class="n">before_transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="parse_reactions-667"><a href="#parse_reactions-667"><span class="linenos">667</span></a>                <span class="n">_add_reaction</span><span class="p">(</span>
</span><span id="parse_reactions-668"><a href="#parse_reactions-668"><span class="linenos">668</span></a>                    <span class="n">before_reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="n">reactants</span>
</span><span id="parse_reactions-669"><a href="#parse_reactions-669"><span class="linenos">669</span></a>                <span class="p">)</span>
</span><span id="parse_reactions-670"><a href="#parse_reactions-670"><span class="linenos">670</span></a>
</span><span id="parse_reactions-671"><a href="#parse_reactions-671"><span class="linenos">671</span></a>            <span class="k">if</span> <span class="n">reactants</span> <span class="ow">in</span> <span class="n">after_transitions</span><span class="p">:</span>
</span><span id="parse_reactions-672"><a href="#parse_reactions-672"><span class="linenos">672</span></a>                <span class="n">after_transitions</span><span class="p">[</span><span class="n">reactants</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">products</span><span class="p">)</span>
</span><span id="parse_reactions-673"><a href="#parse_reactions-673"><span class="linenos">673</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="parse_reactions-674"><a href="#parse_reactions-674"><span class="linenos">674</span></a>                <span class="n">after_transitions</span><span class="p">[</span><span class="n">reactants</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">products</span><span class="p">]</span>
</span><span id="parse_reactions-675"><a href="#parse_reactions-675"><span class="linenos">675</span></a>            <span class="k">continue</span>
</span><span id="parse_reactions-676"><a href="#parse_reactions-676"><span class="linenos">676</span></a>        <span class="k">elif</span> <span class="n">is_transition_state</span><span class="p">(</span><span class="n">products</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="parse_reactions-677"><a href="#parse_reactions-677"><span class="linenos">677</span></a>            <span class="k">for</span> <span class="n">after_products</span> <span class="ow">in</span> <span class="n">after_transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">products</span><span class="p">,</span> <span class="p">[]):</span>
</span><span id="parse_reactions-678"><a href="#parse_reactions-678"><span class="linenos">678</span></a>                <span class="n">_add_reaction</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">after_products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="n">products</span><span class="p">)</span>
</span><span id="parse_reactions-679"><a href="#parse_reactions-679"><span class="linenos">679</span></a>
</span><span id="parse_reactions-680"><a href="#parse_reactions-680"><span class="linenos">680</span></a>            <span class="k">if</span> <span class="n">products</span> <span class="ow">in</span> <span class="n">before_transitions</span><span class="p">:</span>
</span><span id="parse_reactions-681"><a href="#parse_reactions-681"><span class="linenos">681</span></a>                <span class="n">before_transitions</span><span class="p">[</span><span class="n">products</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reactants</span><span class="p">)</span>
</span><span id="parse_reactions-682"><a href="#parse_reactions-682"><span class="linenos">682</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="parse_reactions-683"><a href="#parse_reactions-683"><span class="linenos">683</span></a>                <span class="n">before_transitions</span><span class="p">[</span><span class="n">products</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">reactants</span><span class="p">]</span>
</span><span id="parse_reactions-684"><a href="#parse_reactions-684"><span class="linenos">684</span></a>            <span class="k">continue</span>
</span><span id="parse_reactions-685"><a href="#parse_reactions-685"><span class="linenos">685</span></a>
</span><span id="parse_reactions-686"><a href="#parse_reactions-686"><span class="linenos">686</span></a>        <span class="n">_add_reaction</span><span class="p">(</span><span class="n">reactants</span><span class="p">,</span> <span class="n">products</span><span class="p">,</span> <span class="n">is_half_equilibrium</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="parse_reactions-687"><a href="#parse_reactions-687"><span class="linenos">687</span></a>
</span><span id="parse_reactions-688"><a href="#parse_reactions-688"><span class="linenos">688</span></a>    <span class="k">return</span> <span class="n">Scheme</span><span class="p">(</span>
</span><span id="parse_reactions-689"><a href="#parse_reactions-689"><span class="linenos">689</span></a>        <span class="n">compounds</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">compounds</span><span class="p">),</span>
</span><span id="parse_reactions-690"><a href="#parse_reactions-690"><span class="linenos">690</span></a>        <span class="n">reactions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">_unparse_reactions</span><span class="p">(</span><span class="n">reactions</span><span class="p">)),</span>
</span><span id="parse_reactions-691"><a href="#parse_reactions-691"><span class="linenos">691</span></a>        <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="n">rx</span><span class="o">.</span><span class="n">_misc</span><span class="o">.</span><span class="n">totuple</span><span class="p">([</span><span class="n">reaction</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">reaction</span> <span class="ow">in</span> <span class="n">reactions</span><span class="p">]),</span>
</span><span id="parse_reactions-692"><a href="#parse_reactions-692"><span class="linenos">692</span></a>        <span class="n">A</span><span class="o">=</span><span class="n">rx</span><span class="o">.</span><span class="n">_misc</span><span class="o">.</span><span class="n">totuple</span><span class="p">(</span>
</span><span id="parse_reactions-693"><a href="#parse_reactions-693"><span class="linenos">693</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">(</span>
</span><span id="parse_reactions-694"><a href="#parse_reactions-694"><span class="linenos">694</span></a>                <span class="p">[[</span><span class="n">vector</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">))]</span> <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">A</span><span class="p">]</span>
</span><span id="parse_reactions-695"><a href="#parse_reactions-695"><span class="linenos">695</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="parse_reactions-696"><a href="#parse_reactions-696"><span class="linenos">696</span></a>        <span class="p">),</span>
</span><span id="parse_reactions-697"><a href="#parse_reactions-697"><span class="linenos">697</span></a>        <span class="n">B</span><span class="o">=</span><span class="n">rx</span><span class="o">.</span><span class="n">_misc</span><span class="o">.</span><span class="n">totuple</span><span class="p">(</span>
</span><span id="parse_reactions-698"><a href="#parse_reactions-698"><span class="linenos">698</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">(</span>
</span><span id="parse_reactions-699"><a href="#parse_reactions-699"><span class="linenos">699</span></a>                <span class="p">[[</span><span class="n">vector</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">compounds</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">vector</span><span class="p">))]</span> <span class="k">for</span> <span class="n">vector</span> <span class="ow">in</span> <span class="n">B</span><span class="p">]</span>
</span><span id="parse_reactions-700"><a href="#parse_reactions-700"><span class="linenos">700</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="parse_reactions-701"><a href="#parse_reactions-701"><span class="linenos">701</span></a>        <span class="p">),</span>
</span><span id="parse_reactions-702"><a href="#parse_reactions-702"><span class="linenos">702</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parse a kinetic model as a chemical reaction scheme.</p>

<p>This is an essential part of the parsing process.
See <code><a href="#parse_model">overreact.parse_model</a></code> other details.</p>

<h2 id="parameters">Parameters</h2>

<p>text : str or sequence of str
    Model description or sequence of lines of it.</p>

<h2 id="returns">Returns</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.</p>

<h2 id="notes">Notes</h2>

<p>The model description should comply with the mini-language for systems of
reactions. A semi-formal definition of the grammar in
<a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form">Backus-Naur form</a>
is given below:</p>

<pre><code>     equation ::= equation_side arrow equation_side
equation_side ::= coefficient compound ['+' coefficient compound]*
  coefficient ::= [integers] (defaults to 1)
     compound ::= mix of printable characters
        arrow ::= '-&gt;' | '&lt;=&gt;' | '&lt;-'
</code></pre>

<p>Blank lines and comments (starting with <code>//</code>) are ignored. Repeated
reactions are ignored. Furthermore, reactions can be chained one after
another and, if a single compound (with either a <code>‚Ä°</code> or a <code>#</code> at the end)
appears alone on one side of a reaction, it's considered a transition
state. Transition states have zero lifetime during the simulation.</p>

<h2 id="examples">Examples</h2>

<p>What follows is a rather long tour over the parsing process and its
output in general. You can skip it if you are not interested in the
details.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span> <span class="o">=</span> <span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A -&gt; B  // a direct reaction&quot;</span><span class="p">)</span>
</code></pre>
</div>

<p>The reaction above is a direct one (observe that comments are ignored). The
returned object has the following attributes:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="o">.</span><span class="n">compounds</span>
<span class="go">(&#39;A&#39;, &#39;B&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="o">.</span><span class="n">reactions</span>
<span class="go">(&#39;A -&gt; B&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span>
<span class="go">(False,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="o">.</span><span class="n">A</span>
<span class="go">((-1.,), (1.,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scheme</span><span class="o">.</span><span class="n">B</span>
<span class="go">((-1.,), (1.,))</span>
</code></pre>
</div>

<p>The same reaction can be specified in reverse order:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;B &lt;- A  // reverse reaction of the above&quot;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((-1.,), (1.,)),</span>
<span class="go">       B=((-1.,), (1.,)))</span>
</code></pre>
</div>

<p>Equilibria produce twice as many direct reactions, while the $B$ matrix
defines an energy relationship for only one of each pair:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A &lt;=&gt; B  // an equilibrium&quot;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;, &#39;B -&gt; A&#39;),</span>
<span class="go">       is_half_equilibrium=(True, True),</span>
<span class="go">       A=((-1.,  1.),</span>
<span class="go">          (1., -1.)),</span>
<span class="go">       B=((-1.,  0.),</span>
<span class="go">          (1.,  0.)))</span>
</code></pre>
</div>

<p>Adding twice the same reaction results in a single reaction being added.
This of course also works with equilibria (extra whitespaces are ignored):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    A &lt;=&gt; B  -&gt; A</span>
<span class="gp">... </span><span class="s1">    A  -&gt; B &lt;=&gt; A</span>
<span class="gp">... </span><span class="s1">    A  -&gt; B &lt;-  A</span>
<span class="gp">... </span><span class="s1">    B &lt;-  A  -&gt; B</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;, &#39;B -&gt; A&#39;),</span>
<span class="go">       is_half_equilibrium=(True, True),</span>
<span class="go">       A=((-1.,  1.),</span>
<span class="go">          (1., -1.)),</span>
<span class="go">       B=((-1.,  0.),</span>
<span class="go">          (1.,  0.)))</span>
</code></pre>
</div>

<p>Transition states are specified with a special symbol at the end (either
<code>‚Ä°</code> or <code>#</code>). They are shown among compounds, but the matrix $A$ ensures
they'll never have a non-zero rate of formation/consumption. On the other
hand, they are needed in the $B$ matrix:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A -&gt; A‚Ä° -&gt; B&quot;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((-1.,), (0.,), (1.,)),</span>
<span class="go">       B=((-1.,), (1.,), (0.,)))</span>
</code></pre>
</div>

<p>This gives the same result as above:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A -&gt; A‚Ä° -&gt; B &lt;- A‚Ä° &lt;- A&quot;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((-1.,), (0.,), (1.,)),</span>
<span class="go">       B=((-1.,), (1.,), (0.,)))</span>
</code></pre>
</div>

<p>It is possible to define a reaction whose product is the same as the
reactant. This is found in isomerization processes (e.g., ammonia
inversion or the methyl rotation in ethane):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;S -&gt; E‚Ä° -&gt; S&quot;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
<span class="go">       reactions=(&#39;S -&gt; S&#39;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((0.,), (0.,)),</span>
<span class="go">       B=((-1.,), (1.,)))</span>
</code></pre>
</div>

<p>As such, a column full of zeros in the $A$ matrix corresponds to a reaction
with zero net change. As can be seen, overreact allows for very general
models. An interesting feature is that a single transition state can link
many different compounds (whether it is useful is a matter of debate):</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    B  -&gt; B‚Ä°  -&gt; C  // chained reactions and transition states</span>
<span class="gp">... </span><span class="s1">    B‚Ä° -&gt; D         // this is a bifurcation</span>
<span class="gp">... </span><span class="s1">    B  -&gt; B&#39;‚Ä° -&gt; E  // this is a classical competitive reaction</span>
<span class="gp">... </span><span class="s1">    A  -&gt; B‚Ä°</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;B&#39;, &#39;B‚Ä°&#39;, &#39;C&#39;, &#39;D&#39;, &quot;B&#39;‚Ä°&quot;, &#39;E&#39;, &#39;A&#39;),</span>
<span class="go">       reactions=(&#39;B -&gt; C&#39;, &#39;B -&gt; D&#39;, &#39;B -&gt; E&#39;, &#39;A -&gt; C&#39;, &#39;A -&gt; D&#39;),</span>
<span class="go">       is_half_equilibrium=(False, False, False, False, False),</span>
<span class="go">       A=((-1., -1., -1.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  0.,  0.,  0.),</span>
<span class="go">          (1.,  0.,  0.,  1.,  0.),</span>
<span class="go">          (0.,  1.,  0.,  0.,  1.),</span>
<span class="go">          (0.,  0.,  0.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  1.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  0., -1., -1.)),</span>
<span class="go">       B=((-1., -1., -1.,  0.,  0.),</span>
<span class="go">          (1.,  1.,  0.,  1.,  1.),</span>
<span class="go">          (0.,  0.,  0.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  0.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  1.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  0.,  0.,  0.),</span>
<span class="go">          (0.,  0.,  0., -1., -1.)))</span>
</code></pre>
</div>

<p>The following is a borderline case but both reactions should be considered
different since they define different processes:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="gp">... </span><span class="s1">    A -&gt; A‚Ä° -&gt; B</span>
<span class="gp">... </span><span class="s1">    A -&gt; B</span>
<span class="gp">... </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
<span class="go">       reactions=(&#39;A -&gt; B&#39;, &#39;A -&gt; B&#39;),</span>
<span class="go">       is_half_equilibrium=(False, False),</span>
<span class="go">       A=((-1., -1.),</span>
<span class="go">          (0.,  0.),</span>
<span class="go">          (1.,  1.)),</span>
<span class="go">       B=((-1., -1.),</span>
<span class="go">          (1.,  0.),</span>
<span class="go">          (0.,  1.)))</span>
</code></pre>
</div>

<p>The following is correct behavior. In fact, the reactions are badly
defined: if more than one transition state are chained, the following
happens, which is correct since it's the most physically plausible model
that can be extracted. It can be seen as a feature that the product B is
ignored and not the reactant A, since the user would easily see the mistake
in graphs of concentration over time (the alternative would be no
reaction happening at all, which is rather cryptic to debug).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">parse_reactions</span><span class="p">(</span><span class="s2">&quot;A -&gt; A‚Ä° -&gt; A&#39;‚Ä° -&gt; B&quot;</span><span class="p">)</span>
<span class="go">Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &quot;A&#39;‚Ä°&quot;, &#39;B&#39;),</span>
<span class="go">       reactions=(&quot;A -&gt; A&#39;‚Ä°&quot;,),</span>
<span class="go">       is_half_equilibrium=(False,),</span>
<span class="go">       A=((-1.,), (0.,), (1.,), (0.,)),</span>
<span class="go">       B=((-1.,), (1.,), (0.,), (0.,)))</span>
</code></pre>
</div>

<p>In any case, it's not clear how a reaction barrier be defined in such a
case. If you have a use case, don't hesitate to
<a href="https://github.com/geem-lab/overreact/issues/">open an issue</a>, we'll be
happy to hear from you.</p>
</div>


                </section>
                <section id="unparse_reactions">
                            <input id="unparse_reactions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unparse_reactions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">scheme</span><span class="p">:</span> <span class="n"><a href="#Scheme">overreact.Scheme</a></span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="unparse_reactions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#unparse_reactions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="unparse_reactions-147"><a href="#unparse_reactions-147"><span class="linenos">147</span></a><span class="k">def</span> <span class="nf">unparse_reactions</span><span class="p">(</span><span class="n">scheme</span><span class="p">:</span> <span class="n">Scheme</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="unparse_reactions-148"><a href="#unparse_reactions-148"><span class="linenos">148</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Unparse a kinetic model.</span>
</span><span id="unparse_reactions-149"><a href="#unparse_reactions-149"><span class="linenos">149</span></a>
</span><span id="unparse_reactions-150"><a href="#unparse_reactions-150"><span class="linenos">150</span></a><span class="sd">    Parameters</span>
</span><span id="unparse_reactions-151"><a href="#unparse_reactions-151"><span class="linenos">151</span></a><span class="sd">    ----------</span>
</span><span id="unparse_reactions-152"><a href="#unparse_reactions-152"><span class="linenos">152</span></a><span class="sd">    scheme : Scheme</span>
</span><span id="unparse_reactions-153"><a href="#unparse_reactions-153"><span class="linenos">153</span></a><span class="sd">        A descriptor of the reaction scheme.</span>
</span><span id="unparse_reactions-154"><a href="#unparse_reactions-154"><span class="linenos">154</span></a><span class="sd">        Mostly likely, this comes from a parsed input file.</span>
</span><span id="unparse_reactions-155"><a href="#unparse_reactions-155"><span class="linenos">155</span></a><span class="sd">        See `overreact.io.parse_model`.</span>
</span><span id="unparse_reactions-156"><a href="#unparse_reactions-156"><span class="linenos">156</span></a>
</span><span id="unparse_reactions-157"><a href="#unparse_reactions-157"><span class="linenos">157</span></a><span class="sd">    Returns</span>
</span><span id="unparse_reactions-158"><a href="#unparse_reactions-158"><span class="linenos">158</span></a><span class="sd">    -------</span>
</span><span id="unparse_reactions-159"><a href="#unparse_reactions-159"><span class="linenos">159</span></a><span class="sd">    text : str</span>
</span><span id="unparse_reactions-160"><a href="#unparse_reactions-160"><span class="linenos">160</span></a>
</span><span id="unparse_reactions-161"><a href="#unparse_reactions-161"><span class="linenos">161</span></a><span class="sd">    Notes</span>
</span><span id="unparse_reactions-162"><a href="#unparse_reactions-162"><span class="linenos">162</span></a><span class="sd">    -----</span>
</span><span id="unparse_reactions-163"><a href="#unparse_reactions-163"><span class="linenos">163</span></a><span class="sd">    This function assumes complimentary half equilibria are located one after</span>
</span><span id="unparse_reactions-164"><a href="#unparse_reactions-164"><span class="linenos">164</span></a><span class="sd">    the other in ``scheme.reactions``, which is to be expected from</span>
</span><span id="unparse_reactions-165"><a href="#unparse_reactions-165"><span class="linenos">165</span></a><span class="sd">    `parse_reactions`.</span>
</span><span id="unparse_reactions-166"><a href="#unparse_reactions-166"><span class="linenos">166</span></a>
</span><span id="unparse_reactions-167"><a href="#unparse_reactions-167"><span class="linenos">167</span></a><span class="sd">    Examples</span>
</span><span id="unparse_reactions-168"><a href="#unparse_reactions-168"><span class="linenos">168</span></a><span class="sd">    --------</span>
</span><span id="unparse_reactions-169"><a href="#unparse_reactions-169"><span class="linenos">169</span></a><span class="sd">    &gt;&gt;&gt; unparse_reactions(Scheme(compounds=(&#39;A&#39;, &#39;B&#39;), reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="unparse_reactions-170"><a href="#unparse_reactions-170"><span class="linenos">170</span></a><span class="sd">    ...                   is_half_equilibrium=(False,),</span>
</span><span id="unparse_reactions-171"><a href="#unparse_reactions-171"><span class="linenos">171</span></a><span class="sd">    ...                   A=((-1.,),</span>
</span><span id="unparse_reactions-172"><a href="#unparse_reactions-172"><span class="linenos">172</span></a><span class="sd">    ...                      ( 1.,)),</span>
</span><span id="unparse_reactions-173"><a href="#unparse_reactions-173"><span class="linenos">173</span></a><span class="sd">    ...                   B=((-1.,),</span>
</span><span id="unparse_reactions-174"><a href="#unparse_reactions-174"><span class="linenos">174</span></a><span class="sd">    ...                      ( 1.,))))</span>
</span><span id="unparse_reactions-175"><a href="#unparse_reactions-175"><span class="linenos">175</span></a><span class="sd">    &#39;A -&gt; B&#39;</span>
</span><span id="unparse_reactions-176"><a href="#unparse_reactions-176"><span class="linenos">176</span></a><span class="sd">    &gt;&gt;&gt; unparse_reactions(Scheme(compounds=(&#39;A&#39;, &#39;B&#39;),</span>
</span><span id="unparse_reactions-177"><a href="#unparse_reactions-177"><span class="linenos">177</span></a><span class="sd">    ...                   reactions=(&#39;A -&gt; B&#39;, &#39;B -&gt; A&#39;),</span>
</span><span id="unparse_reactions-178"><a href="#unparse_reactions-178"><span class="linenos">178</span></a><span class="sd">    ...                   is_half_equilibrium=(True, True),</span>
</span><span id="unparse_reactions-179"><a href="#unparse_reactions-179"><span class="linenos">179</span></a><span class="sd">    ...                   A=((-1.,  1.),</span>
</span><span id="unparse_reactions-180"><a href="#unparse_reactions-180"><span class="linenos">180</span></a><span class="sd">    ...                      ( 1., -1.)),</span>
</span><span id="unparse_reactions-181"><a href="#unparse_reactions-181"><span class="linenos">181</span></a><span class="sd">    ...                   B=((-1.,  0.),</span>
</span><span id="unparse_reactions-182"><a href="#unparse_reactions-182"><span class="linenos">182</span></a><span class="sd">    ...                      ( 1.,  0.))))</span>
</span><span id="unparse_reactions-183"><a href="#unparse_reactions-183"><span class="linenos">183</span></a><span class="sd">    &#39;A &lt;=&gt; B&#39;</span>
</span><span id="unparse_reactions-184"><a href="#unparse_reactions-184"><span class="linenos">184</span></a><span class="sd">    &gt;&gt;&gt; unparse_reactions(Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
</span><span id="unparse_reactions-185"><a href="#unparse_reactions-185"><span class="linenos">185</span></a><span class="sd">    ...                   reactions=(&#39;A -&gt; B&#39;,),</span>
</span><span id="unparse_reactions-186"><a href="#unparse_reactions-186"><span class="linenos">186</span></a><span class="sd">    ...                   is_half_equilibrium=(False,),</span>
</span><span id="unparse_reactions-187"><a href="#unparse_reactions-187"><span class="linenos">187</span></a><span class="sd">    ...                   A=((-1.,),</span>
</span><span id="unparse_reactions-188"><a href="#unparse_reactions-188"><span class="linenos">188</span></a><span class="sd">    ...                      ( 0.,),</span>
</span><span id="unparse_reactions-189"><a href="#unparse_reactions-189"><span class="linenos">189</span></a><span class="sd">    ...                      ( 1.,)),</span>
</span><span id="unparse_reactions-190"><a href="#unparse_reactions-190"><span class="linenos">190</span></a><span class="sd">    ...                   B=((-1.,),</span>
</span><span id="unparse_reactions-191"><a href="#unparse_reactions-191"><span class="linenos">191</span></a><span class="sd">    ...                      ( 1.,),</span>
</span><span id="unparse_reactions-192"><a href="#unparse_reactions-192"><span class="linenos">192</span></a><span class="sd">    ...                      ( 0.,))))</span>
</span><span id="unparse_reactions-193"><a href="#unparse_reactions-193"><span class="linenos">193</span></a><span class="sd">    &#39;A -&gt; A‚Ä° -&gt; B&#39;</span>
</span><span id="unparse_reactions-194"><a href="#unparse_reactions-194"><span class="linenos">194</span></a><span class="sd">    &gt;&gt;&gt; print(unparse_reactions(Scheme(compounds=(&#39;B&#39;, &#39;B‚Ä°&#39;, &#39;C&#39;, &#39;D&#39;, &quot;B&#39;‚Ä°&quot;,</span>
</span><span id="unparse_reactions-195"><a href="#unparse_reactions-195"><span class="linenos">195</span></a><span class="sd">    ...                                           &#39;E&#39;, &#39;A&#39;),</span>
</span><span id="unparse_reactions-196"><a href="#unparse_reactions-196"><span class="linenos">196</span></a><span class="sd">    ...                         reactions=(&#39;B -&gt; C&#39;, &#39;B -&gt; D&#39;, &#39;B -&gt; E&#39;,</span>
</span><span id="unparse_reactions-197"><a href="#unparse_reactions-197"><span class="linenos">197</span></a><span class="sd">    ...                                    &#39;A -&gt; C&#39;, &#39;A -&gt; D&#39;),</span>
</span><span id="unparse_reactions-198"><a href="#unparse_reactions-198"><span class="linenos">198</span></a><span class="sd">    ...                         is_half_equilibrium=(False, False, False,</span>
</span><span id="unparse_reactions-199"><a href="#unparse_reactions-199"><span class="linenos">199</span></a><span class="sd">    ...                                              False, False),</span>
</span><span id="unparse_reactions-200"><a href="#unparse_reactions-200"><span class="linenos">200</span></a><span class="sd">    ...                         A=((-1., -1., -1.,  0.,  0.),</span>
</span><span id="unparse_reactions-201"><a href="#unparse_reactions-201"><span class="linenos">201</span></a><span class="sd">    ...                            ( 0.,  0.,  0.,  0.,  0.),</span>
</span><span id="unparse_reactions-202"><a href="#unparse_reactions-202"><span class="linenos">202</span></a><span class="sd">    ...                            ( 1.,  0.,  0.,  1.,  0.),</span>
</span><span id="unparse_reactions-203"><a href="#unparse_reactions-203"><span class="linenos">203</span></a><span class="sd">    ...                            ( 0.,  1.,  0.,  0.,  1.),</span>
</span><span id="unparse_reactions-204"><a href="#unparse_reactions-204"><span class="linenos">204</span></a><span class="sd">    ...                            ( 0.,  0.,  0.,  0.,  0.),</span>
</span><span id="unparse_reactions-205"><a href="#unparse_reactions-205"><span class="linenos">205</span></a><span class="sd">    ...                            ( 0.,  0.,  1.,  0.,  0.),</span>
</span><span id="unparse_reactions-206"><a href="#unparse_reactions-206"><span class="linenos">206</span></a><span class="sd">    ...                            ( 0.,  0.,  0., -1., -1.)),</span>
</span><span id="unparse_reactions-207"><a href="#unparse_reactions-207"><span class="linenos">207</span></a><span class="sd">    ...                         B=((-1., -1., -1.,  0.,  0.),</span>
</span><span id="unparse_reactions-208"><a href="#unparse_reactions-208"><span class="linenos">208</span></a><span class="sd">    ...                            ( 1.,  1.,  0.,  1.,  1.),</span>
</span><span id="unparse_reactions-209"><a href="#unparse_reactions-209"><span class="linenos">209</span></a><span class="sd">    ...                            ( 0.,  0.,  0.,  0.,  0.),</span>
</span><span id="unparse_reactions-210"><a href="#unparse_reactions-210"><span class="linenos">210</span></a><span class="sd">    ...                            ( 0.,  0.,  0.,  0.,  0.),</span>
</span><span id="unparse_reactions-211"><a href="#unparse_reactions-211"><span class="linenos">211</span></a><span class="sd">    ...                            ( 0.,  0.,  1.,  0.,  0.),</span>
</span><span id="unparse_reactions-212"><a href="#unparse_reactions-212"><span class="linenos">212</span></a><span class="sd">    ...                            ( 0.,  0.,  0.,  0.,  0.),</span>
</span><span id="unparse_reactions-213"><a href="#unparse_reactions-213"><span class="linenos">213</span></a><span class="sd">    ...                            ( 0.,  0.,  0., -1., -1.)))))</span>
</span><span id="unparse_reactions-214"><a href="#unparse_reactions-214"><span class="linenos">214</span></a><span class="sd">    B -&gt; B‚Ä° -&gt; C</span>
</span><span id="unparse_reactions-215"><a href="#unparse_reactions-215"><span class="linenos">215</span></a><span class="sd">    B -&gt; B‚Ä° -&gt; D</span>
</span><span id="unparse_reactions-216"><a href="#unparse_reactions-216"><span class="linenos">216</span></a><span class="sd">    B -&gt; B&#39;‚Ä° -&gt; E</span>
</span><span id="unparse_reactions-217"><a href="#unparse_reactions-217"><span class="linenos">217</span></a><span class="sd">    A -&gt; B‚Ä° -&gt; C</span>
</span><span id="unparse_reactions-218"><a href="#unparse_reactions-218"><span class="linenos">218</span></a><span class="sd">    A -&gt; B‚Ä° -&gt; D</span>
</span><span id="unparse_reactions-219"><a href="#unparse_reactions-219"><span class="linenos">219</span></a><span class="sd">    &gt;&gt;&gt; print(unparse_reactions(Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &#39;B&#39;),</span>
</span><span id="unparse_reactions-220"><a href="#unparse_reactions-220"><span class="linenos">220</span></a><span class="sd">    ...                         reactions=(&#39;A -&gt; B&#39;, &#39;A -&gt; B&#39;),</span>
</span><span id="unparse_reactions-221"><a href="#unparse_reactions-221"><span class="linenos">221</span></a><span class="sd">    ...                         is_half_equilibrium=(False, False),</span>
</span><span id="unparse_reactions-222"><a href="#unparse_reactions-222"><span class="linenos">222</span></a><span class="sd">    ...                         A=((-1., -1.),</span>
</span><span id="unparse_reactions-223"><a href="#unparse_reactions-223"><span class="linenos">223</span></a><span class="sd">    ...                            ( 0.,  0.),</span>
</span><span id="unparse_reactions-224"><a href="#unparse_reactions-224"><span class="linenos">224</span></a><span class="sd">    ...                            ( 1.,  1.)),</span>
</span><span id="unparse_reactions-225"><a href="#unparse_reactions-225"><span class="linenos">225</span></a><span class="sd">    ...                         B=((-1., -1.),</span>
</span><span id="unparse_reactions-226"><a href="#unparse_reactions-226"><span class="linenos">226</span></a><span class="sd">    ...                            ( 1.,  0.),</span>
</span><span id="unparse_reactions-227"><a href="#unparse_reactions-227"><span class="linenos">227</span></a><span class="sd">    ...                            ( 0.,  1.)))))</span>
</span><span id="unparse_reactions-228"><a href="#unparse_reactions-228"><span class="linenos">228</span></a><span class="sd">    A -&gt; A‚Ä° -&gt; B</span>
</span><span id="unparse_reactions-229"><a href="#unparse_reactions-229"><span class="linenos">229</span></a><span class="sd">    A -&gt; B</span>
</span><span id="unparse_reactions-230"><a href="#unparse_reactions-230"><span class="linenos">230</span></a><span class="sd">    &gt;&gt;&gt; unparse_reactions(Scheme(compounds=(&#39;A&#39;, &#39;A‚Ä°&#39;, &quot;A&#39;‚Ä°&quot;, &#39;B&#39;),</span>
</span><span id="unparse_reactions-231"><a href="#unparse_reactions-231"><span class="linenos">231</span></a><span class="sd">    ...                   reactions=(&quot;A -&gt; A&#39;‚Ä°&quot;,),</span>
</span><span id="unparse_reactions-232"><a href="#unparse_reactions-232"><span class="linenos">232</span></a><span class="sd">    ...                   is_half_equilibrium=(False,),</span>
</span><span id="unparse_reactions-233"><a href="#unparse_reactions-233"><span class="linenos">233</span></a><span class="sd">    ...                   A=((-1.,),</span>
</span><span id="unparse_reactions-234"><a href="#unparse_reactions-234"><span class="linenos">234</span></a><span class="sd">    ...                      ( 0.,),</span>
</span><span id="unparse_reactions-235"><a href="#unparse_reactions-235"><span class="linenos">235</span></a><span class="sd">    ...                      ( 1.,),</span>
</span><span id="unparse_reactions-236"><a href="#unparse_reactions-236"><span class="linenos">236</span></a><span class="sd">    ...                      ( 0.,)),</span>
</span><span id="unparse_reactions-237"><a href="#unparse_reactions-237"><span class="linenos">237</span></a><span class="sd">    ...                   B=((-1.,),</span>
</span><span id="unparse_reactions-238"><a href="#unparse_reactions-238"><span class="linenos">238</span></a><span class="sd">    ...                      ( 1.,),</span>
</span><span id="unparse_reactions-239"><a href="#unparse_reactions-239"><span class="linenos">239</span></a><span class="sd">    ...                      ( 0.,),</span>
</span><span id="unparse_reactions-240"><a href="#unparse_reactions-240"><span class="linenos">240</span></a><span class="sd">    ...                      ( 0.,))))</span>
</span><span id="unparse_reactions-241"><a href="#unparse_reactions-241"><span class="linenos">241</span></a><span class="sd">    &quot;A -&gt; A‚Ä° -&gt; A&#39;‚Ä°&quot;</span>
</span><span id="unparse_reactions-242"><a href="#unparse_reactions-242"><span class="linenos">242</span></a><span class="sd">    &gt;&gt;&gt; unparse_reactions(Scheme(compounds=(&#39;S&#39;, &#39;E‚Ä°&#39;),</span>
</span><span id="unparse_reactions-243"><a href="#unparse_reactions-243"><span class="linenos">243</span></a><span class="sd">    ...                   reactions=(&#39;S -&gt; S&#39;,),</span>
</span><span id="unparse_reactions-244"><a href="#unparse_reactions-244"><span class="linenos">244</span></a><span class="sd">    ...                   is_half_equilibrium=(False,),</span>
</span><span id="unparse_reactions-245"><a href="#unparse_reactions-245"><span class="linenos">245</span></a><span class="sd">    ...                   A=((0.0,),</span>
</span><span id="unparse_reactions-246"><a href="#unparse_reactions-246"><span class="linenos">246</span></a><span class="sd">    ...                      (0.0,)),</span>
</span><span id="unparse_reactions-247"><a href="#unparse_reactions-247"><span class="linenos">247</span></a><span class="sd">    ...                   B=((-1.0,),</span>
</span><span id="unparse_reactions-248"><a href="#unparse_reactions-248"><span class="linenos">248</span></a><span class="sd">    ...                      (1.0,))))</span>
</span><span id="unparse_reactions-249"><a href="#unparse_reactions-249"><span class="linenos">249</span></a><span class="sd">    &#39;S -&gt; E‚Ä° -&gt; S&#39;</span>
</span><span id="unparse_reactions-250"><a href="#unparse_reactions-250"><span class="linenos">250</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="unparse_reactions-251"><a href="#unparse_reactions-251"><span class="linenos">251</span></a>    <span class="n">scheme</span> <span class="o">=</span> <span class="n">_check_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span>
</span><span id="unparse_reactions-252"><a href="#unparse_reactions-252"><span class="linenos">252</span></a>    <span class="n">transition_states</span> <span class="o">=</span> <span class="n">get_transition_states</span><span class="p">(</span>
</span><span id="unparse_reactions-253"><a href="#unparse_reactions-253"><span class="linenos">253</span></a>        <span class="n">scheme</span><span class="o">.</span><span class="n">A</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span>
</span><span id="unparse_reactions-254"><a href="#unparse_reactions-254"><span class="linenos">254</span></a>    <span class="p">)</span>
</span><span id="unparse_reactions-255"><a href="#unparse_reactions-255"><span class="linenos">255</span></a>    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="unparse_reactions-256"><a href="#unparse_reactions-256"><span class="linenos">256</span></a>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="unparse_reactions-257"><a href="#unparse_reactions-257"><span class="linenos">257</span></a>    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">reactions</span><span class="p">):</span>
</span><span id="unparse_reactions-258"><a href="#unparse_reactions-258"><span class="linenos">258</span></a>        <span class="k">if</span> <span class="n">transition_states</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="unparse_reactions-259"><a href="#unparse_reactions-259"><span class="linenos">259</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="unparse_reactions-260"><a href="#unparse_reactions-260"><span class="linenos">260</span></a>                <span class="n">scheme</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
</span><span id="unparse_reactions-261"><a href="#unparse_reactions-261"><span class="linenos">261</span></a>                    <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;-&gt; </span><span class="si">{</span><span class="n">scheme</span><span class="o">.</span><span class="n">compounds</span><span class="p">[</span><span class="n">transition_states</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s2"> -&gt;&quot;</span>
</span><span id="unparse_reactions-262"><a href="#unparse_reactions-262"><span class="linenos">262</span></a>                <span class="p">)</span>
</span><span id="unparse_reactions-263"><a href="#unparse_reactions-263"><span class="linenos">263</span></a>            <span class="p">)</span>
</span><span id="unparse_reactions-264"><a href="#unparse_reactions-264"><span class="linenos">264</span></a>        <span class="k">elif</span> <span class="n">scheme</span><span class="o">.</span><span class="n">is_half_equilibrium</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
</span><span id="unparse_reactions-265"><a href="#unparse_reactions-265"><span class="linenos">265</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;=&gt;&quot;</span><span class="p">))</span>
</span><span id="unparse_reactions-266"><a href="#unparse_reactions-266"><span class="linenos">266</span></a>            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># avoid backward reaction, which comes next</span>
</span><span id="unparse_reactions-267"><a href="#unparse_reactions-267"><span class="linenos">267</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="unparse_reactions-268"><a href="#unparse_reactions-268"><span class="linenos">268</span></a>            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">reactions</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="unparse_reactions-269"><a href="#unparse_reactions-269"><span class="linenos">269</span></a>        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="unparse_reactions-270"><a href="#unparse_reactions-270"><span class="linenos">270</span></a>    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Unparse a kinetic model.</p>

<h2 id="parameters">Parameters</h2>

<p>scheme : Scheme
    A descriptor of the reaction scheme.
    Mostly likely, this comes from a parsed input file.
    See <code><a href="#parse_model">overreact.parse_model</a></code>.</p>

<h2 id="returns">Returns</h2>

<p>text : str</p>

<h2 id="notes">Notes</h2>

<p>This function assumes complimentary half equilibria are located one after
the other in <code>scheme.reactions</code>, which is to be expected from
<code><a href="#parse_reactions">parse_reactions</a></code>.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A -&gt; B&#39;</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,)),</span>
<span class="gp">... </span>                  <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,))))</span>
<span class="go">&#39;A -&gt; B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A -&gt; B&#39;</span><span class="p">,</span> <span class="s1">&#39;B -&gt; A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">)),</span>
<span class="gp">... </span>                  <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">))))</span>
<span class="go">&#39;A &lt;=&gt; B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A‚Ä°&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A -&gt; B&#39;</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">0.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,)),</span>
<span class="gp">... </span>                  <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">0.</span><span class="p">,))))</span>
<span class="go">&#39;A -&gt; A‚Ä° -&gt; B&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;B‚Ä°&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s2">&quot;B&#39;‚Ä°&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                          <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;B -&gt; C&#39;</span><span class="p">,</span> <span class="s1">&#39;B -&gt; D&#39;</span><span class="p">,</span> <span class="s1">&#39;B -&gt; E&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="s1">&#39;A -&gt; C&#39;</span><span class="p">,</span> <span class="s1">&#39;A -&gt; D&#39;</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                                             <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">)),</span>
<span class="gp">... </span>                        <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">)))))</span>
<span class="go">B -&gt; B‚Ä° -&gt; C</span>
<span class="go">B -&gt; B‚Ä° -&gt; D</span>
<span class="go">B -&gt; B&#39;‚Ä° -&gt; E</span>
<span class="go">A -&gt; B‚Ä° -&gt; C</span>
<span class="go">A -&gt; B‚Ä° -&gt; D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A‚Ä°&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A -&gt; B&#39;</span><span class="p">,</span> <span class="s1">&#39;A -&gt; B&#39;</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="gp">... </span>                        <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">)),</span>
<span class="gp">... </span>                        <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">),</span>
<span class="gp">... </span>                           <span class="p">(</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">)))))</span>
<span class="go">A -&gt; A‚Ä° -&gt; B</span>
<span class="go">A -&gt; B</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;A‚Ä°&#39;</span><span class="p">,</span> <span class="s2">&quot;A&#39;‚Ä°&quot;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;A -&gt; A&#39;‚Ä°&quot;</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">0.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">0.</span><span class="p">,)),</span>
<span class="gp">... </span>                  <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">1.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">0.</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span> <span class="mf">0.</span><span class="p">,))))</span>
<span class="go">&quot;A -&gt; A‚Ä° -&gt; A&#39;‚Ä°&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unparse_reactions</span><span class="p">(</span><span class="n">Scheme</span><span class="p">(</span><span class="n">compounds</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;E‚Ä°&#39;</span><span class="p">),</span>
<span class="gp">... </span>                  <span class="n">reactions</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;S -&gt; S&#39;</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">is_half_equilibrium</span><span class="o">=</span><span class="p">(</span><span class="kc">False</span><span class="p">,),</span>
<span class="gp">... </span>                  <span class="n">A</span><span class="o">=</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span><span class="mf">0.0</span><span class="p">,)),</span>
<span class="gp">... </span>                  <span class="n">B</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,),</span>
<span class="gp">... </span>                     <span class="p">(</span><span class="mf">1.0</span><span class="p">,))))</span>
<span class="go">&#39;S -&gt; E‚Ä° -&gt; S&#39;</span>
</code></pre>
</div>
</div>


                </section>
    </main>
</body>
</html>